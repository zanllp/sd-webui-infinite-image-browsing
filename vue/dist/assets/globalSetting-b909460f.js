import{d as E,r as D,$ as G,v as de,aD as X,o as h,k as y,c as t,y as s,z as e,ae as l,x as U,p as x,l as g,n as M,Y as P,at as re,t as p,av as H,m as k,H as N,S as A,aE as j,aF as ce,ag as z,W as B,R as pe,V as Z,q as ee,as as me,aG as ge,aH as _e,aI as he,aJ as fe,aK as ve,L as be,C as ke,Q as ye,B as J,I as Ce,aL as we,aM as Se,aN as Te,aO as $e,aA as Ie}from"./index-7f89456f.js";import{_ as te,F as xe}from"./index-ce5e0917.js";import"./index-d0211b26.js";import"./index-08e1e48f.js";/* empty css              */import{_ as O,g as Re,C as Q,a as Ue}from"./shortcut-7f420da3.js";import{_ as ae}from"./index-ec397928.js";import"./index-639969f6.js";import"./isArrayLikeObject-0d61aa94.js";import"./index-8dbe984d.js";const Y="/infinite_image_browsing/fe-static/assets/sample-55dcafc6.webp",Me=["width","height","src"],Pe=E({__name:"ImageSetting",setup(K){function o(R,_){return new Promise(v=>{const b=new Image;b.onload=()=>{const m=document.createElement("canvas");m.width=b.width*_,m.height=b.height*_,m.getContext("2d").drawImage(b,0,0,m.width,m.height),v(m.toDataURL())},b.src=R})}const i=D(),T=G("");return de(()=>[i.enableThumbnail,i.gridThumbnailResolution],X(async()=>{i.enableThumbnail&&(T.value=await o(Y,i.gridThumbnailResolution/1024))},300),{immediate:!0,deep:!0}),(R,_)=>{const v=te,b=ae;return h(),y(M,null,[t(v,{label:e(l)("defaultGridCellWidth")},{default:s(()=>[t(O,{min:64,max:1024,step:16,modelValue:e(i).defaultGridCellWidth,"onUpdate:modelValue":_[0]||(_[0]=m=>e(i).defaultGridCellWidth=m)},null,8,["modelValue"])]),_:1},8,["label"]),t(v,{label:e(l)("useThumbnailPreview")},{default:s(()=>[t(b,{checked:e(i).enableThumbnail,"onUpdate:checked":_[1]||(_[1]=m=>e(i).enableThumbnail=m)},null,8,["checked"])]),_:1},8,["label"]),e(i).enableThumbnail?(h(),U(v,{key:0,label:e(l)("thumbnailResolution")},{default:s(()=>[t(O,{modelValue:e(i).gridThumbnailResolution,"onUpdate:modelValue":_[2]||(_[2]=m=>e(i).gridThumbnailResolution=m),min:256,max:1024,step:64},null,8,["modelValue"])]),_:1},8,["label"])):x("",!0),t(v,{label:e(l)("livePreview")},{default:s(()=>[g("div",null,[g("img",{width:e(i).defaultGridCellWidth,height:e(i).defaultGridCellWidth,src:e(i).enableThumbnail?T.value:e(Y)},null,8,Me)])]),_:1},8,["label"]),t(v,{label:e(l)("defaultShowChangeIndicators")},{default:s(()=>[t(b,{checked:e(i).defaultChangeIndchecked,"onUpdate:checked":_[3]||(_[3]=m=>e(i).defaultChangeIndchecked=m)},null,8,["checked"])]),_:1},8,["label"]),e(i).defaultChangeIndchecked?(h(),U(v,{key:1,label:e(l)("defaultSeedAsChange")},{default:s(()=>[t(b,{checked:e(i).defaultSeedChangeChecked,"onUpdate:checked":_[4]||(_[4]=m=>e(i).defaultSeedChangeChecked=m)},null,8,["checked"])]),_:1},8,["label"])):x("",!0),t(v,{label:e(l)("previewMaskBackgroundOpacity")},{default:s(()=>[t(O,{min:0,max:1,step:.05,modelValue:e(i).previewBgOpacity,"onUpdate:modelValue":_[5]||(_[5]=m=>e(i).previewBgOpacity=m)},null,8,["modelValue"])]),_:1},8,["label"])],64)}}}),Fe={class:"auto-tag-settings"},Ve={class:"header"},We={class:"description"},Ae={class:"actions"},Oe={class:"rules-list"},Ne={class:"rule-header"},Le={class:"filters-list"},ze={key:0,class:"empty-tip"},Be=E({__name:"AutoTagSettings",setup(K){const o=G([]),i=D(),T=P(()=>{var r,C;return((C=(r=i.conf)==null?void 0:r.all_custom_tags)==null?void 0:C.filter(f=>f.type==="custom"))||[]}),R={value:r=>r.name,text:r=>r.display_name?`${r.display_name} : ${r.name}`:r.name};re(()=>{var C,f;const r=(f=(C=i.conf)==null?void 0:C.app_fe_setting)==null?void 0:f.auto_tag_rules;r&&(o.value=r)});const _=()=>{o.value.push({tag:"",filters:[]})},v=r=>{o.value.splice(r,1)},b=r=>{r.filters.push({field:"pos_prompt",operator:"contains",value:""})},m=(r,C)=>{r.filters.splice(C,1)},F=async()=>{try{await ce("auto_tag_rules",o.value),z.success(l("autoTag.saveSuccess")),i.conf&&i.conf.app_fe_setting&&(i.conf.app_fe_setting.auto_tag_rules=o.value)}catch(r){z.error(l("autoTag.saveFail")+": "+r)}},L=P(()=>[{label:l("autoTag.fields.posPrompt"),value:"pos_prompt"},{label:l("autoTag.fields.negPrompt"),value:"neg_prompt"},{label:l("autoTag.fields.model"),value:"Model"},{label:l("autoTag.fields.sampler"),value:"Sampler"},{label:l("autoTag.fields.size"),value:"Size"},{label:l("autoTag.fields.cfgScale"),value:"CFG scale"},{label:l("autoTag.fields.steps"),value:"Steps"},{label:l("autoTag.fields.seed"),value:"Seed"}]),V=P(()=>[{label:l("autoTag.operators.contains"),value:"contains"},{label:l("autoTag.operators.equals"),value:"equals"},{label:l("autoTag.operators.regex"),value:"regex"}]);return(r,C)=>{const f=B,n=pe,a=Z;return h(),y("div",Fe,[g("div",Ve,[g("div",We,p(e(l)("autoTag.description")),1),g("div",Ae,[t(f,{type:"primary",onClick:_},{icon:s(()=>[t(e(H))]),default:s(()=>[k(" "+p(e(l)("autoTag.addRule")),1)]),_:1}),t(f,{type:"primary",onClick:F,style:{"margin-left":"16px"}},{default:s(()=>[k(p(e(l)("autoTag.saveConfig")),1)]),_:1})])]),g("div",Oe,[(h(!0),y(M,null,N(o.value,(c,S)=>(h(),y("div",{key:S,class:"rule-card"},[g("div",Ne,[t(e(A),{conv:R,style:{width:"240px"},options:T.value,value:c.tag,"onUpdate:value":d=>c.tag=d,disabled:!T.value.length,placeholder:e(l)("autoTag.inputTagName")},null,8,["options","value","onUpdate:value","disabled","placeholder"]),t(f,{type:"text",danger:"",onClick:d=>v(S)},{icon:s(()=>[t(e(j))]),_:2},1032,["onClick"])]),g("div",Le,[(h(!0),y(M,null,N(c.filters,(d,w)=>(h(),y("div",{key:w,class:"filter-row"},[t(n,{value:d.field,"onUpdate:value":$=>d.field=$,style:{width:"240px"},options:L.value},null,8,["value","onUpdate:value","options"]),t(n,{value:d.operator,"onUpdate:value":$=>d.operator=$,style:{width:"160px"},options:V.value},null,8,["value","onUpdate:value","options"]),t(a,{value:d.value,"onUpdate:value":$=>d.value=$,placeholder:e(l)("autoTag.value"),style:{flex:"1"}},null,8,["value","onUpdate:value","placeholder"]),t(f,{type:"text",danger:"",onClick:$=>m(c,w)},{icon:s(()=>[t(e(j))]),_:2},1032,["onClick"])]))),128)),t(f,{type:"dashed",block:"",onClick:d=>b(c),style:{"margin-top":"8px"}},{icon:s(()=>[t(e(H))]),default:s(()=>[k(" "+p(e(l)("autoTag.addFilter")),1)]),_:2},1032,["onClick"])])]))),128))]),o.value.length===0?(h(),y("div",ze,p(e(l)("autoTag.noRules")),1)):x("",!0)])}}});const Ee=ee(Be,[["__scopeId","data-v-5bd94ce6"]]),De={class:"panel"},Ge={class:"lang-select-wrap"},Ke={style:{"margin-top":"64px"}},qe={style:{"margin-top":"64px"}},He={style:{"margin-left":"8px",color:"#666"}},je={style:{"margin-top":"0"}},Je={style:{"padding-left":"8px",color:"#666"}},Qe={class:"col"},Ye=E({__name:"globalSetting",setup(K){const o=D(),i=me(),T=G(!1),R=async()=>{window.location.reload()},_=[{value:"en",text:"English"},{value:"zhHans",text:"简体中文"},{value:"zhHant",text:"繁體中文"},{value:"de",text:"Deutsch"}],v=X(n=>{const a=o.shortcut[n];["ctrl","shift"].includes(a.toLowerCase())&&(o.shortcut[n]="")},700),b=ge(()=>{z.warn(l("notAllowSingleCtrlOrShiftAsShortcut"))},3e3),m=(n,a)=>{const c=Re(n);["ctrl","shift"].includes(c.toLowerCase())&&(b(),v(a)),c&&(o.shortcut[a]=c)},F=async()=>{await we("shutdown_api_server_command"),await Se.removeFile(Te),await $e()},L=P(()=>[{value:"empty",text:l("emptyStartPage")},{value:"last-workspace-state",text:l("restoreLastWorkspaceState")},...i.snapshots.map(a=>({value:`workspace_snapshot_${a.id}`,text:l("restoreWorkspaceSnapshot",[a.name])}))]),V=P(()=>{const n=o.shortcut,a={};return Object.values(n).forEach(c=>{var S;a[S=c+""]??(a[S]=0),a[c+""]++}),a}),r=P(()=>{var a;const n=[{key:"download",label:l("download")},{key:"delete",label:l("deleteSelected")}];return(a=o.conf)==null||a.all_custom_tags.forEach(c=>{n.push({key:`toggle_tag_${c.name}`,label:l("toggleTagSelection",{tag:c.name})})}),o.quickMovePaths.forEach(c=>{n.push({key:`copy_to_${c.dir}`,label:l("copyTo")+" "+c.zh})}),o.quickMovePaths.forEach(c=>{n.push({key:`move_to_${c.dir}`,label:l("moveTo")+" "+c.zh})}),n}),C=n=>n&&n in V.value&&V.value[n]>1,f=_e(he+"disable_maximize",!1);return(n,a)=>{var q;const c=Ie,S=B,d=te,w=ae,$=B,le=O,W=Q,oe=Ue,ne=Q,se=Z,ue=xe;return h(),y("div",De,[(q=e(o).conf)!=null&&q.is_readonly?(h(),U(c,{key:0,message:n.$t("readonlyModeSettingPageDesc"),type:"warning"},null,8,["message"])):x("",!0),x("",!0),t(ue,null,{default:s(()=>[t(d,{label:n.$t("lang")},{default:s(()=>[g("div",Ge,[t(e(A),{options:_,value:e(o).lang,"onUpdate:value":a[0]||(a[0]=u=>e(o).lang=u),onChange:a[1]||(a[1]=u=>T.value=!0)},null,8,["value"])]),T.value?(h(),U(S,{key:0,type:"primary",onClick:R,ghost:""},{default:s(()=>[k(p(e(l)("langChangeReload")),1)]),_:1})):x("",!0)]),_:1},8,["label"]),g("h2",Ke,p(e(l)("ImageBrowsingSettings")),1),t(Pe),g("h2",qe,p(e(l)("autoTag.name")),1),t(Ee),g("h2",null,"TikTok "+p(e(l)("view")),1),t(d,{label:n.$t("showTiktokNavigator")},{default:s(()=>[t(w,{checked:e(o).showTiktokNavigator,"onUpdate:checked":a[2]||(a[2]=u=>e(o).showTiktokNavigator=u)},null,8,["checked"]),g("span",He,p(e(l)("showTiktokNavigatorDesc")),1)]),_:1},8,["label"]),g("h2",null,p(e(l)("imgSearch")),1),t(d,{label:n.$t("rebuildImageIndex")},{default:s(()=>[t($,{onClick:e(fe)},{default:s(()=>[k(p(n.$t("start")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),g("h2",null,p(e(l)("autoRefresh")),1),t(d,{label:n.$t("autoRefreshWalkMode")},{default:s(()=>[t(w,{checked:e(o).autoRefreshWalkMode,"onUpdate:checked":a[3]||(a[3]=u=>e(o).autoRefreshWalkMode=u)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:n.$t("autoRefreshNormalFixedMode")},{default:s(()=>[t(w,{checked:e(o).autoRefreshNormalFixedMode,"onUpdate:checked":a[4]||(a[4]=u=>e(o).autoRefreshNormalFixedMode=u)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:e(l)("autoRefreshWalkModePosLimit")},{default:s(()=>[t(le,{min:0,max:1024,step:16,modelValue:e(o).autoRefreshWalkModePosLimit,"onUpdate:modelValue":a[5]||(a[5]=u=>e(o).autoRefreshWalkModePosLimit=u)},null,8,["modelValue"])]),_:1},8,["label"]),g("h2",je,p(e(l)("other")),1),t(d,{label:n.$t("fileTypeFilter")},{default:s(()=>[t(oe,{value:e(o).fileTypeFilter,"onUpdate:value":a[6]||(a[6]=u=>e(o).fileTypeFilter=u)},{default:s(()=>[t(W,{value:"all"},{default:s(()=>[k(p(n.$t("allFiles")),1)]),_:1}),t(W,{value:"image"},{default:s(()=>[k(p(n.$t("image")),1)]),_:1}),t(W,{value:"video"},{default:s(()=>[k(p(n.$t("video")),1)]),_:1}),t(W,{value:"audio"},{default:s(()=>[k(p(n.$t("audio")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),t(d,{label:n.$t("showCommaInGenInfoPanel")},{default:s(()=>[t(w,{checked:e(o).showCommaInInfoPanel,"onUpdate:checked":a[7]||(a[7]=u=>e(o).showCommaInInfoPanel=u)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:n.$t("showRandomImageInStartup")},{default:s(()=>[t(w,{checked:e(o).showRandomImageInStartup,"onUpdate:checked":a[8]||(a[8]=u=>e(o).showRandomImageInStartup=u)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:n.$t("defaultSortingMethod")},{default:s(()=>[t(e(A),{value:e(o).defaultSortingMethod,"onUpdate:value":a[9]||(a[9]=u=>e(o).defaultSortingMethod=u),conv:e(ve),options:e(be)},null,8,["value","conv","options"])]),_:1},8,["label"]),t(d,{label:n.$t("longPressOpenContextMenu")},{default:s(()=>[t(w,{checked:e(o).longPressOpenContextMenu,"onUpdate:checked":a[10]||(a[10]=u=>e(o).longPressOpenContextMenu=u)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:n.$t("openOnAppStart")},{default:s(()=>[t(e(A),{value:e(o).defaultInitinalPage,"onUpdate:value":a[11]||(a[11]=u=>e(o).defaultInitinalPage=u),options:L.value},null,8,["value","options"])]),_:1},8,["label"]),(h(!0),y(M,null,N(e(o).ignoredConfirmActions,(u,I)=>(h(),U(d,{label:n.$t(I+"SkipConfirm"),key:I},{default:s(()=>[t(ne,{checked:e(o).ignoredConfirmActions[I],"onUpdate:checked":ie=>e(o).ignoredConfirmActions[I]=ie},null,8,["checked","onUpdate:checked"])]),_:2},1032,["label"]))),128)),t(d,{label:n.$t("disableMaximize")},{default:s(()=>[t(w,{checked:e(f),"onUpdate:checked":a[12]||(a[12]=u=>ke(f)?f.value=u:null)},null,8,["checked"]),g("sub",Je,p(n.$t("takeEffectAfterReloadPage")),1)]),_:1},8,["label"]),g("h2",null,p(e(l)("shortcutKey")),1),(h(!0),y(M,null,N(r.value,u=>(h(),U(d,{label:u.label,key:u.key},{default:s(()=>[g("div",{class:ye(["col",{conflict:C(e(o).shortcut[u.key]+"")}]),onKeydown:a[13]||(a[13]=J(()=>{},["stop","prevent"]))},[t(se,{value:e(o).shortcut[u.key],onKeydown:J(I=>m(I,u.key),["stop","prevent"]),placeholder:n.$t("shortcutKeyDescription")},null,8,["value","onKeydown","placeholder"]),t(S,{onClick:I=>e(o).shortcut[u.key]="",class:"clear-btn"},{default:s(()=>[k(p(n.$t("clear")),1)]),_:2},1032,["onClick"])],34)]),_:2},1032,["label"]))),128)),e(Ce)?(h(),y(M,{key:0},[g("h2",null,p(e(l)("clientSpecificSettings")),1),t(d,null,{default:s(()=>[g("div",Qe,[t(S,{onClick:F,class:"clear-btn"},{default:s(()=>[k(p(n.$t("initiateSoftwareStartupConfig")),1)]),_:1})])]),_:1})],64)):x("",!0)]),_:1})])}}});const it=ee(Ye,[["__scopeId","data-v-2522743a"]]);export{it as default};
