import{d as pe,Z as ue,bw as fe,v as ge,ad as me,r as he,o as m,k as I,c as n,z as e,y as o,C as U,l as d,E as ke,t as c,m as v,x as J,O as ve,Q as L,p as N,T as we,U as _e,W as Ce,aB as Se,aC as Ie,q as xe}from"./index-199f8388.js";import{S as be}from"./index-7e51dac4.js";import{L as ye,R as Me,f as Ae,M as Ve}from"./MultiSelectKeep-634cf4db.js";import{s as Fe,F as ze}from"./FileItem-cdbc027c.js";import{u as De}from"./hook-0813f5c7.js";import{g as Te,o as O}from"./index-ea810700.js";/* empty css              */import"./index-35375b6a.js";import"./index-3f517ea8.js";import"./index-6905bc51.js";import"./index-15b4c137.js";import"./index-23736bbf.js";import"./shortcut-61d236ef.js";import"./_isIterateeCall-bed55584.js";const x=r=>(Se("data-v-aea581a5"),r=r(),Ie(),r),Ge={class:"hint"},$e={class:"action-bar"},Be={class:"title line-clamp-1"},Re=x(()=>d("div",{"flex-placeholder":""},null,-1)),Ee=x(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Ue={key:1,class:"no-res-hint"},Je=x(()=>d("p",{class:"hint"},"æš‚æ— ç»“æžœ",-1)),Le=[Je],Ne={key:2,class:"preview-switch"},Oe=pe({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},id:{},title:{},paths:{}},setup(r){const h=r,t=ue({res:[],load:!1,loading:!1,async next(){var s;if(!(t.loading||t.load)){t.loading=!0;try{const u=t.res.length,f=(h.paths??[]).slice(u,u+200);if(!f.length){t.load=!0;return}const C=await fe(f),g=f.map(S=>C[S]).filter(Boolean);t.res.push(...g),u+200>=(((s=h.paths)==null?void 0:s.length)??0)&&(t.load=!0)}finally{t.loading=!1}}},async reset(){t.res=[],t.load=!1,await t.next()}}),{queue:P,images:l,onContextMenuClickU:b,stackViewEl:W,previewIdx:p,previewing:y,onPreviewVisibleChange:q,previewImgMove:M,canPreview:A,itemSize:V,gridItems:K,showGenInfo:k,imageGenInfo:F,q:Q,multiSelectedIdxs:w,onFileItemClick:Z,scroller:z,showMenuIdx:_,onFileDragStart:j,onFileDragEnd:H,cellWidth:X,onScroll:D,saveAllFileAsJson:Y,saveLoadedFileAsJson:ee,changeIndchecked:te,seedChangeChecked:le,getGenDiff:ie,getGenDiffWatchDep:se}=De(t);ge(()=>h.paths,async()=>{var s;await t.reset({refetch:!0}),await me(),(s=z.value)==null||s.scrollToItem(0),D()},{immediate:!0});const ne=he(),{onClearAllSelected:oe,onSelectAll:ae,onReverseSelect:de}=Te(),ce=()=>{l.value.length!==0&&O(l.value,0)};return(s,i)=>{const u=Ve,f=we,C=_e,g=Ce,S=be;return m(),I("div",{class:"container",ref_key:"stackViewEl",ref:W},[n(u,{show:!!e(w).length||e(ne).keepMultiSelect,onClearAllSelected:e(oe),onSelectAll:e(ae),onReverseSelect:e(de)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),n(S,{size:"large",spinning:!e(P).isIdle||t.loading},{default:o(()=>{var T,G,$,B;return[n(C,{visible:e(k),"onUpdate:visible":i[1]||(i[1]=a=>U(k)?k.value=a:null),width:"70vw","mask-closable":"",onOk:i[2]||(i[2]=a=>k.value=!1)},{cancelText:o(()=>[]),default:o(()=>[n(f,{active:"",loading:!e(Q).isIdle},{default:o(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:i[0]||(i[0]=a=>e(ke)(e(F)))},[d("div",Ge,c(s.$t("doubleClickToCopy")),1),v(" "+c(e(F)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",$e,[d("div",Be,"ðŸ§© "+c(h.title),1),Re,n(g,{onClick:ce,disabled:!((T=e(l))!=null&&T.length)},{default:o(()=>[v(c(s.$t("tiktokView")),1)]),_:1},8,["disabled"]),n(g,{onClick:e(ee),disabled:!((G=e(l))!=null&&G.length)},{default:o(()=>[v(c(s.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick","disabled"]),n(g,{onClick:e(Y),disabled:!(($=e(l))!=null&&$.length)},{default:o(()=>[v(c(s.$t("saveAllAsJson")),1)]),_:1},8,["onClick","disabled"])]),(B=e(l))!=null&&B.length?(m(),J(e(Fe),{key:0,ref_key:"scroller",ref:z,class:"file-list",items:e(l),"item-size":e(V).first,"key-field":"fullpath","item-secondary-size":e(V).second,gridItems:e(K),onScroll:e(D)},{after:o(()=>[Ee]),default:o(({item:a,index:R})=>[n(ze,{idx:R,file:a,"cell-width":e(X),"show-menu-idx":e(_),"onUpdate:showMenuIdx":i[3]||(i[3]=E=>U(_)?_.value=E:null),onDragstart:e(j),onDragend:e(H),onFileItemClick:e(Z),onTiktokView:(E,re)=>e(O)(e(l),re),"full-screen-preview-image-url":e(l)[e(p)]?e(ve)(e(l)[e(p)]):"",selected:e(w).includes(R),onContextMenuClick:e(b),onPreviewVisibleChange:e(q),"is-selected-mutil-files":e(w).length>1,"enable-change-indicator":e(te),"seed-change-checked":e(le),"get-gen-diff":e(ie),"get-gen-diff-watch-dep":e(se)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):(m(),I("div",Ue,Le)),e(y)?(m(),I("div",Ne,[n(e(ye),{onClick:i[4]||(i[4]=a=>e(M)("prev")),class:L({disable:!e(A)("prev")})},null,8,["class"]),n(e(Me),{onClick:i[5]||(i[5]=a=>e(M)("next")),class:L({disable:!e(A)("next")})},null,8,["class"])])):N("",!0)]}),_:1},8,["spinning"]),e(y)&&e(l)&&e(l)[e(p)]?(m(),J(Ae,{key:0,file:e(l)[e(p)],idx:e(p),onContextMenuClick:e(b)},null,8,["file","idx","onContextMenuClick"])):N("",!0)],512)}}});const st=xe(Oe,[["__scopeId","data-v-aea581a5"]]);export{st as default};
