import{d as Z,r as ee,$ as R,aH as te,aI as le,at as ie,cQ as se,o as v,k as F,c as i,z as e,l as g,y as n,m as k,t as u,B as N,E as oe,C as ae,O as ne,Q as $,p as A,x as re,ag as w,ae as ce,cR as de,W as ue,T as me,U as fe,q as pe}from"./index-7f89456f.js";import{F as ve,s as ge}from"./FileItem-71fdd7ed.js";import{u as ke,g as we,c as he,b as Ce,d as Se,e as _e,o as z}from"./index-d3fa759a.js";import{M as Ie,L as ye,R as xe,f as be}from"./MultiSelectKeep-259a7683.js";import"./index-7ba6e156.js";import"./index-31a27e12.js";import"./index-08e1e48f.js";import"./shortcut-7f420da3.js";import"./index-8dbe984d.js";import"./_isIterateeCall-eac05144.js";import"./index-ec397928.js";const Me={class:"refresh-button"},Te={class:"hint"},Ve={key:0,class:"preview-switch"},Re=Z({__name:"randomImage",props:{tabIdx:{},paneIdx:{},id:{},paneKey:{}},setup(Fe){const B=ee(),m=R(!1),l=R([]),r=l,h=te(`${le}randomImageSettingNotificationShown`,!1),P=()=>{h.value||(w.info({content:ce("randomImageSettingNotification"),duration:6,key:"randomImageSetting"}),h.value=!0)},f=async()=>{try{m.value=!0;const s=await de();s.length===0&&w.warn("No data, please generate index in image search page first"),l.value=s}finally{m.value=!1,_()}},C=()=>{if(l.value.length===0){w.warn("没有图片可以浏览");return}z(l.value,a.value||0)};ie(()=>{f(),setTimeout(()=>{P()},2e3)});const{stackViewEl:E,multiSelectedIdxs:p,stack:O,scroller:U}=ke({images:l}).toRefs(),{onClearAllSelected:D,onSelectAll:G,onReverseSelect:K}=we();he();const{itemSize:S,gridItems:L,cellWidth:Q,onScroll:_}=Ce(),{showGenInfo:c,imageGenInfo:I,q:W,onContextMenuClick:q,onFileItemClick:H}=Se({openNext:se}),{previewIdx:a,previewing:y,onPreviewVisibleChange:j,previewImgMove:x,canPreview:b}=_e(),M=async(s,t,d)=>{O.value=[{curr:"",files:l.value}],await q(s,t,d)};return(s,t)=>{var T;const d=ue,J=me,X=fe;return v(),F("div",{class:"container",ref_key:"stackViewEl",ref:E},[i(Ie,{show:!!e(p).length||e(B).keepMultiSelect,onClearAllSelected:e(D),onSelectAll:e(G),onReverseSelect:e(K)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),g("div",Me,[i(d,{onClick:f,onTouchstart:N(f,["prevent"]),type:"primary",loading:m.value,shape:"round"},{default:n(()=>[k(u(s.$t("shuffle")),1)]),_:1},8,["onTouchstart","loading"]),i(d,{onClick:C,onTouchstart:N(C,["prevent"]),type:"default",disabled:!((T=l.value)!=null&&T.length),shape:"round"},{default:n(()=>[k(u(s.$t("tiktokView")),1)]),_:1},8,["onTouchstart","disabled"])]),i(X,{visible:e(c),"onUpdate:visible":t[1]||(t[1]=o=>ae(c)?c.value=o:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=o=>c.value=!1)},{cancelText:n(()=>[]),default:n(()=>[i(J,{active:"",loading:!e(W).isIdle},{default:n(()=>[g("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:t[0]||(t[0]=o=>e(oe)(e(I)))},[g("div",Te,u(s.$t("doubleClickToCopy")),1),k(" "+u(e(I)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),i(e(ge),{ref_key:"scroller",ref:U,class:"file-list",items:l.value.slice(),"item-size":e(S).first,"key-field":"fullpath","item-secondary-size":e(S).second,gridItems:e(L),onScroll:e(_)},{default:n(({item:o,index:V})=>[i(ve,{idx:V,file:o,"cell-width":e(Q),"full-screen-preview-image-url":e(r)[e(a)]?e(ne)(e(r)[e(a)]):"",onContextMenuClick:M,onPreviewVisibleChange:e(j),"is-selected-mutil-files":e(p).length>1,selected:e(p).includes(V),onFileItemClick:e(H),onTiktokView:(Ne,Y)=>e(z)(l.value,Y)},null,8,["idx","file","cell-width","full-screen-preview-image-url","onPreviewVisibleChange","is-selected-mutil-files","selected","onFileItemClick","onTiktokView"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"]),e(y)?(v(),F("div",Ve,[i(e(ye),{onClick:t[3]||(t[3]=o=>e(x)("prev")),class:$({disable:!e(b)("prev")})},null,8,["class"]),i(e(xe),{onClick:t[4]||(t[4]=o=>e(x)("next")),class:$({disable:!e(b)("next")})},null,8,["class"])])):A("",!0),e(y)&&e(r)&&e(r)[e(a)]?(v(),re(be,{key:1,file:e(r)[e(a)],idx:e(a),onContextMenuClick:M},null,8,["file","idx"])):A("",!0)],512)}}});const Le=pe(Re,[["__scopeId","data-v-e1531e89"]]);export{Le as default};
