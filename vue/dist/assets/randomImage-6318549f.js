import{d as Z,a1 as ee,r as F,J as te,K as le,o as ie,U as v,V as R,c as i,a4 as e,W as g,a3 as n,X as k,Y as u,a5 as $,L as ae,a6 as se,af as oe,ag as A,$ as z,a2 as ne,z as w,B as re,cJ as ce,cK as de,ak as ue,ai as me,T as fe,a0 as pe}from"./index-4c34d886.js";import{u as ve,c as ge,a as ke,F as we,d as he}from"./FileItem-b79fa0a8.js";import{a as Ce,b as Se,c as _e,M as Ie,o as B,L as ye,R as be,f as xe}from"./MultiSelectKeep-9fc086fd.js";import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-1da329eb.js";/* empty css              */import"./_isIterateeCall-01eb9d10.js";import"./index-801ff9bd.js";import"./shortcut-c3286a1a.js";import"./Checkbox-818febf1.js";import"./index-1e9959a9.js";const Ve={class:"refresh-button"},Me={class:"hint"},Te={key:0,class:"preview-switch"},Ne=Z({__name:"randomImage",props:{tabIdx:{},paneIdx:{},id:{},paneKey:{}},setup(Fe){const h=ee(),m=F(!1),l=F([]),r=l,C=te(`${le}randomImageSettingNotificationShown`,!1),K=()=>{C.value||(w.info({content:re("randomImageSettingNotification"),duration:6,key:"randomImageSetting"}),C.value=!0)},f=async()=>{try{m.value=!0;const a=await ce();a.length===0&&w.warn("No data, please generate index in image search page first"),l.value=a}finally{m.value=!1,I()}},S=()=>{if(l.value.length===0){w.warn("没有图片可以浏览");return}B(l.value,o.value||0)};ie(()=>{f(),setTimeout(()=>{K()},2e3)});const{stackViewEl:P,multiSelectedIdxs:p,stack:L,scroller:U}=ve({images:l}).toRefs(),{onClearAllSelected:D,onSelectAll:E,onReverseSelect:G}=ge();Ce();const{itemSize:_,gridItems:O,cellWidth:W,onScroll:I}=ke(),{showGenInfo:c,imageGenInfo:y,q:J,onContextMenuClick:q,onFileItemClick:H}=Se({openNext:de}),{previewIdx:o,previewing:b,onPreviewVisibleChange:Q,previewImgMove:x,canPreview:V}=_e(),M=async(a,t,d)=>{L.value=[{curr:"",files:l.value}],await q(a,t,d)};return(a,t)=>{var T;const d=ue,X=me,Y=fe;return v(),R("div",{class:"container",ref_key:"stackViewEl",ref:P},[i(Ie,{show:!!e(p).length||e(h).keepMultiSelect,onClearAllSelected:e(D),onSelectAll:e(E),onReverseSelect:e(G)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),g("div",Ve,[i(d,{onClick:f,onTouchstart:$(f,["prevent"]),type:"primary",loading:m.value,shape:"round"},{default:n(()=>[k(u(a.$t("shuffle")),1)]),_:1},8,["onTouchstart","loading"]),i(d,{onClick:S,onTouchstart:$(S,["prevent"]),type:"default",disabled:!((T=l.value)!=null&&T.length),shape:"round"},{default:n(()=>[k(u(a.$t("tiktokView")),1)]),_:1},8,["onTouchstart","disabled"])]),i(Y,{visible:e(c),"onUpdate:visible":t[1]||(t[1]=s=>se(c)?c.value=s:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=s=>c.value=!1)},{cancelText:n(()=>[]),default:n(()=>[i(X,{active:"",loading:!e(J).isIdle},{default:n(()=>[g("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:t[0]||(t[0]=s=>e(ae)(e(y)))},[g("div",Me,u(a.$t("doubleClickToCopy")),1),k(" "+u(e(y)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),i(e(he),{ref_key:"scroller",ref:U,class:"file-list",items:l.value.slice(),"item-size":e(_).first,"key-field":"fullpath","item-secondary-size":e(_).second,gridItems:e(O),onScroll:e(I)},{default:n(({item:s,index:N})=>[i(we,{idx:N,file:s,"cell-width":e(W),"full-screen-preview-image-url":e(r)[e(o)]?e(oe)(e(r)[e(o)]):"",onContextMenuClick:M,onPreviewVisibleChange:e(Q),"is-selected-mutil-files":e(p).length>1,selected:e(p).includes(N),onFileItemClick:e(H),onTiktokView:(Re,j)=>e(B)(l.value,j)},null,8,["idx","file","cell-width","full-screen-preview-image-url","onPreviewVisibleChange","is-selected-mutil-files","selected","onFileItemClick","onTiktokView"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"]),e(b)&&!e(h).hideImageNavigationButtons?(v(),R("div",Te,[i(e(ye),{onClick:t[3]||(t[3]=s=>e(x)("prev")),class:A({disable:!e(V)("prev")})},null,8,["class"]),i(e(be),{onClick:t[4]||(t[4]=s=>e(x)("next")),class:A({disable:!e(V)("next")})},null,8,["class"])])):z("",!0),e(b)&&e(r)&&e(r)[e(o)]?(v(),ne(xe,{key:1,file:e(r)[e(o)],idx:e(o),onContextMenuClick:M},null,8,["file","idx"])):z("",!0)],512)}}});const Ge=pe(Ne,[["__scopeId","data-v-847b1e00"]]);export{Ge as default};
