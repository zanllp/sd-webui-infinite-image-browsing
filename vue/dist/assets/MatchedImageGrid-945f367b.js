import{d as pe,am as ue,bF as fe,m as me,az as ge,a1 as he,U as g,V as I,c as s,a4 as e,a3 as a,a6 as P,W as d,L as ke,Y as c,X as v,a2 as U,af as ve,ag as E,$ as J,ai as we,T as _e,ak as Ce,aP as Se,aQ as Ie,a0 as xe}from"./index-b3c7c5d6.js";import{S as be}from"./index-d37fe390.js";import{o as N,L as ye,R as Me,f as Ae,M as Ve}from"./MultiSelectKeep-fbcbd608.js";import{c as Fe,d as ze,F as De}from"./FileItem-8294157e.js";import{u as Te}from"./hook-7de88dba.js";import"./shortcut-c042a1e5.js";import"./Checkbox-d74eca7d.js";/* empty css              */import"./index-d1b0491d.js";import"./index-4e3e0272.js";import"./index-597c4dca.js";import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-f5b35687.js";import"./_isIterateeCall-71e640b8.js";import"./index-d8c2af9d.js";import"./useGenInfoDiff-650394c2.js";const x=r=>(Se("data-v-aea581a5"),r=r(),Ie(),r),$e={class:"hint"},Ge={class:"action-bar"},Re={class:"title line-clamp-1"},Be=x(()=>d("div",{"flex-placeholder":""},null,-1)),Le=x(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Pe={key:1,class:"no-res-hint"},Ue=x(()=>d("p",{class:"hint"},"æš‚æ— ç»“æžœ",-1)),Ee=[Ue],Je={key:2,class:"preview-switch"},Ne=pe({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},id:{},title:{},paths:{}},setup(r){const h=r,t=ue({res:[],load:!1,loading:!1,async next(){var n;if(!(t.loading||t.load)){t.loading=!0;try{const u=t.res.length,f=(h.paths??[]).slice(u,u+200);if(!f.length){t.load=!0;return}const C=await fe(f),m=f.map(S=>C[S]).filter(Boolean);t.res.push(...m),u+200>=(((n=h.paths)==null?void 0:n.length)??0)&&(t.load=!0)}finally{t.loading=!1}}},async reset(){t.res=[],t.load=!1,await t.next()}}),{queue:W,images:l,onContextMenuClickU:b,stackViewEl:K,previewIdx:p,previewing:y,onPreviewVisibleChange:O,previewImgMove:M,canPreview:A,itemSize:V,gridItems:q,showGenInfo:k,imageGenInfo:F,q:Q,multiSelectedIdxs:w,onFileItemClick:X,scroller:z,showMenuIdx:_,onFileDragStart:Y,onFileDragEnd:j,cellWidth:H,onScroll:D,saveAllFileAsJson:Z,saveLoadedFileAsJson:ee,changeIndchecked:te,seedChangeChecked:le,getGenDiff:ie,getGenDiffWatchDep:ne}=Te(t);me(()=>h.paths,async()=>{var n;await t.reset({refetch:!0}),await ge(),(n=z.value)==null||n.scrollToItem(0),D()},{immediate:!0});const se=he(),{onClearAllSelected:ae,onSelectAll:oe,onReverseSelect:de}=Fe(),ce=()=>{l.value.length!==0&&N(l.value,0)};return(n,i)=>{const u=Ve,f=we,C=_e,m=Ce,S=be;return g(),I("div",{class:"container",ref_key:"stackViewEl",ref:K},[s(u,{show:!!e(w).length||e(se).keepMultiSelect,onClearAllSelected:e(ae),onSelectAll:e(oe),onReverseSelect:e(de)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),s(S,{size:"large",spinning:!e(W).isIdle||t.loading},{default:a(()=>{var T,$,G,R;return[s(C,{visible:e(k),"onUpdate:visible":i[1]||(i[1]=o=>P(k)?k.value=o:null),width:"70vw","mask-closable":"",onOk:i[2]||(i[2]=o=>k.value=!1)},{cancelText:a(()=>[]),default:a(()=>[s(f,{active:"",loading:!e(Q).isIdle},{default:a(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:i[0]||(i[0]=o=>e(ke)(e(F)))},[d("div",$e,c(n.$t("doubleClickToCopy")),1),v(" "+c(e(F)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Ge,[d("div",Re,"ðŸ§© "+c(h.title),1),Be,s(m,{onClick:ce,disabled:!((T=e(l))!=null&&T.length)},{default:a(()=>[v(c(n.$t("tiktokView")),1)]),_:1},8,["disabled"]),s(m,{onClick:e(ee),disabled:!(($=e(l))!=null&&$.length)},{default:a(()=>[v(c(n.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick","disabled"]),s(m,{onClick:e(Z),disabled:!((G=e(l))!=null&&G.length)},{default:a(()=>[v(c(n.$t("saveAllAsJson")),1)]),_:1},8,["onClick","disabled"])]),(R=e(l))!=null&&R.length?(g(),U(e(ze),{key:0,ref_key:"scroller",ref:z,class:"file-list",items:e(l),"item-size":e(V).first,"key-field":"fullpath","item-secondary-size":e(V).second,gridItems:e(q),onScroll:e(D)},{after:a(()=>[Le]),default:a(({item:o,index:B})=>[s(De,{idx:B,file:o,"cell-width":e(H),"show-menu-idx":e(_),"onUpdate:showMenuIdx":i[3]||(i[3]=L=>P(_)?_.value=L:null),onDragstart:e(Y),onDragend:e(j),onFileItemClick:e(X),onTiktokView:(L,re)=>e(N)(e(l),re),"full-screen-preview-image-url":e(l)[e(p)]?e(ve)(e(l)[e(p)]):"",selected:e(w).includes(B),onContextMenuClick:e(b),onPreviewVisibleChange:e(O),"is-selected-mutil-files":e(w).length>1,"enable-change-indicator":e(te),"seed-change-checked":e(le),"get-gen-diff":e(ie),"get-gen-diff-watch-dep":e(ne)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):(g(),I("div",Pe,Ee)),e(y)?(g(),I("div",Je,[s(e(ye),{onClick:i[4]||(i[4]=o=>e(M)("prev")),class:E({disable:!e(A)("prev")})},null,8,["class"]),s(e(Me),{onClick:i[5]||(i[5]=o=>e(M)("next")),class:E({disable:!e(A)("next")})},null,8,["class"])])):J("",!0)]}),_:1},8,["spinning"]),e(y)&&e(l)&&e(l)[e(p)]?(g(),U(Ae,{key:0,file:e(l)[e(p)],idx:e(p),onContextMenuClick:e(b)},null,8,["file","idx","onContextMenuClick"])):J("",!0)],512)}}});const st=xe(Ne,[["__scopeId","data-v-aea581a5"]]);export{st as default};
