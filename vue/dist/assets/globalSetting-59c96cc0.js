import{c as t,A as ce,d as E,a1 as G,r as K,m as pe,n as ee,U as _,V as S,a3 as s,a4 as e,B as o,a2 as M,$ as U,W as g,Z as O,G as P,o as me,Y as p,aM as q,X as C,a8 as D,ac as W,aR as ge,z as B,ak as L,ah as he,aj as te,a0 as ae,aK as _e,aS as fe,J as ve,K as be,aT as ke,aU as ye,ad as we,a6 as Ce,ag as Se,a5 as X,a9 as Te,aV as $e,aW as Ie,aX as xe,aY as Re,aO as Ue}from"./index-64cbe4df.js";import{_ as z,a as le,F as Me}from"./numInput-a328defa.js";import"./index-d2c56e4b.js";/* empty css              *//* empty css              */import{_ as oe}from"./index-f0ba7b9c.js";import"./index-56137fc5.js";import{g as Oe,C as Y,_ as Pe}from"./shortcut-86575428.js";import"./isArrayLikeObject-31019b5f.js";import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-4748a0d9.js";import"./index-53055c61.js";import"./Checkbox-65a2741e.js";var Fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};const Ve=Fe;function J(y){for(var a=1;a<arguments.length;a++){var u=arguments[a]!=null?Object(arguments[a]):{},f=Object.keys(u);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(u).filter(function(w){return Object.getOwnPropertyDescriptor(u,w).enumerable}))),f.forEach(function(w){Ae(y,w,u[w])})}return y}function Ae(y,a,u){return a in y?Object.defineProperty(y,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):y[a]=u,y}var j=function(a,u){var f=J({},a,u.attrs);return t(ce,J({},f,{icon:Ve}),null)};j.displayName="DeleteOutlined";j.inheritAttrs=!1;const Z=j;const Q="/infinite_image_browsing/fe-static/assets/sample-55dcafc6.webp",We=["width","height","src"],ze=E({__name:"ImageSetting",setup(y){function a(w,h){return new Promise(b=>{const k=new Image;k.onload=()=>{const m=document.createElement("canvas");m.width=k.width*h,m.height=k.height*h,m.getContext("2d").drawImage(k,0,0,m.width,m.height),b(m.toDataURL())},k.src=w})}const u=G(),f=K("");return pe(()=>[u.enableThumbnail,u.gridThumbnailResolution],ee(async()=>{u.enableThumbnail&&(f.value=await a(Q,u.gridThumbnailResolution/1024))},300),{immediate:!0,deep:!0}),(w,h)=>{const b=le,k=oe;return _(),S(O,null,[t(b,{label:e(o)("defaultGridCellWidth")},{default:s(()=>[t(z,{min:64,max:1024,step:16,modelValue:e(u).defaultGridCellWidth,"onUpdate:modelValue":h[0]||(h[0]=m=>e(u).defaultGridCellWidth=m)},null,8,["modelValue"])]),_:1},8,["label"]),t(b,{label:e(o)("useThumbnailPreview")},{default:s(()=>[t(k,{checked:e(u).enableThumbnail,"onUpdate:checked":h[1]||(h[1]=m=>e(u).enableThumbnail=m)},null,8,["checked"])]),_:1},8,["label"]),e(u).enableThumbnail?(_(),M(b,{key:0,label:e(o)("thumbnailResolution")},{default:s(()=>[t(z,{modelValue:e(u).gridThumbnailResolution,"onUpdate:modelValue":h[2]||(h[2]=m=>e(u).gridThumbnailResolution=m),min:256,max:1024,step:64},null,8,["modelValue"])]),_:1},8,["label"])):U("",!0),t(b,{label:e(o)("livePreview")},{default:s(()=>[g("div",null,[g("img",{width:e(u).defaultGridCellWidth,height:e(u).defaultGridCellWidth,src:e(u).enableThumbnail?f.value:e(Q)},null,8,We)])]),_:1},8,["label"]),t(b,{label:e(o)("defaultShowChangeIndicators")},{default:s(()=>[t(k,{checked:e(u).defaultChangeIndchecked,"onUpdate:checked":h[3]||(h[3]=m=>e(u).defaultChangeIndchecked=m)},null,8,["checked"])]),_:1},8,["label"]),e(u).defaultChangeIndchecked?(_(),M(b,{key:1,label:e(o)("defaultSeedAsChange")},{default:s(()=>[t(k,{checked:e(u).defaultSeedChangeChecked,"onUpdate:checked":h[4]||(h[4]=m=>e(u).defaultSeedChangeChecked=m)},null,8,["checked"])]),_:1},8,["label"])):U("",!0),t(b,{label:e(o)("previewMaskBackgroundOpacity")},{default:s(()=>[t(z,{min:0,max:1,step:.05,modelValue:e(u).previewBgOpacity,"onUpdate:modelValue":h[5]||(h[5]=m=>e(u).previewBgOpacity=m)},null,8,["modelValue"])]),_:1},8,["label"])],64)}}}),De={class:"auto-tag-settings"},Ne={class:"header"},Be={class:"description"},Le={class:"actions"},Ee={class:"rules-list"},Ge={class:"rule-header"},Ke={class:"filters-list"},je={key:0,class:"empty-tip"},He=E({__name:"AutoTagSettings",setup(y){const a=K([]),u=G(),f=P(()=>{var r,T;return((T=(r=u.conf)==null?void 0:r.all_custom_tags)==null?void 0:T.filter(v=>v.type==="custom"))||[]}),w={value:r=>r.name,text:r=>r.display_name?`${r.display_name} : ${r.name}`:r.name};me(()=>{var T,v;const r=(v=(T=u.conf)==null?void 0:T.app_fe_setting)==null?void 0:v.auto_tag_rules;r&&(a.value=r)});const h=()=>{a.value.push({tag:"",filters:[]})},b=r=>{a.value.splice(r,1)},k=r=>{r.filters.push({field:"pos_prompt",operator:"contains",value:""})},m=(r,T)=>{r.filters.splice(T,1)},F=async()=>{try{await ge("auto_tag_rules",a.value),B.success(o("autoTag.saveSuccess")),u.conf&&u.conf.app_fe_setting&&(u.conf.app_fe_setting.auto_tag_rules=a.value)}catch(r){B.error(o("autoTag.saveFail")+": "+r)}},N=P(()=>[{label:o("autoTag.fields.posPrompt"),value:"pos_prompt"},{label:o("autoTag.fields.negPrompt"),value:"neg_prompt"},{label:o("autoTag.fields.model"),value:"Model"},{label:o("autoTag.fields.sampler"),value:"Sampler"},{label:o("autoTag.fields.size"),value:"Size"},{label:o("autoTag.fields.cfgScale"),value:"CFG scale"},{label:o("autoTag.fields.steps"),value:"Steps"},{label:o("autoTag.fields.seed"),value:"Seed"}]),V=P(()=>[{label:o("autoTag.operators.contains"),value:"contains"},{label:o("autoTag.operators.equals"),value:"equals"},{label:o("autoTag.operators.regex"),value:"regex"}]);return(r,T)=>{const v=L,n=he,l=te;return _(),S("div",De,[g("div",Ne,[g("div",Be,p(e(o)("autoTag.description")),1),g("div",Le,[t(v,{type:"primary",onClick:h},{icon:s(()=>[t(e(q))]),default:s(()=>[C(" "+p(e(o)("autoTag.addRule")),1)]),_:1}),t(v,{type:"primary",onClick:F,style:{"margin-left":"16px"}},{default:s(()=>[C(p(e(o)("autoTag.saveConfig")),1)]),_:1})])]),g("div",Ee,[(_(!0),S(O,null,D(a.value,(c,I)=>(_(),S("div",{key:I,class:"rule-card"},[g("div",Ge,[t(e(W),{conv:w,style:{width:"240px"},options:f.value,value:c.tag,"onUpdate:value":d=>c.tag=d,disabled:!f.value.length,placeholder:e(o)("autoTag.inputTagName")},null,8,["options","value","onUpdate:value","disabled","placeholder"]),t(v,{type:"text",danger:"",onClick:d=>b(I)},{icon:s(()=>[t(e(Z))]),_:2},1032,["onClick"])]),g("div",Ke,[(_(!0),S(O,null,D(c.filters,(d,$)=>(_(),S("div",{key:$,class:"filter-row"},[t(n,{value:d.field,"onUpdate:value":x=>d.field=x,style:{width:"240px"},options:N.value},null,8,["value","onUpdate:value","options"]),t(n,{value:d.operator,"onUpdate:value":x=>d.operator=x,style:{width:"160px"},options:V.value},null,8,["value","onUpdate:value","options"]),t(l,{value:d.value,"onUpdate:value":x=>d.value=x,placeholder:e(o)("autoTag.value"),style:{flex:"1"}},null,8,["value","onUpdate:value","placeholder"]),t(v,{type:"text",danger:"",onClick:x=>m(c,$)},{icon:s(()=>[t(e(Z))]),_:2},1032,["onClick"])]))),128)),t(v,{type:"dashed",block:"",onClick:d=>k(c),style:{"margin-top":"8px"}},{icon:s(()=>[t(e(q))]),default:s(()=>[C(" "+p(e(o)("autoTag.addFilter")),1)]),_:2},1032,["onClick"])])]))),128))]),a.value.length===0?(_(),S("div",je,p(e(o)("autoTag.noRules")),1)):U("",!0)])}}});const qe=ae(He,[["__scopeId","data-v-a56a2d27"]]),Xe={class:"panel"},Ye={class:"lang-select-wrap"},Je={style:{"margin-top":"64px"}},Ze={style:{"margin-top":"64px"}},Qe={style:{"margin-left":"8px",color:"#666"}},et={style:{"margin-top":"0"}},tt={style:{"padding-left":"8px",color:"#666"}},at={class:"col"},lt=E({__name:"globalSetting",setup(y){const a=G(),u=_e(),f=K(!1),w=async()=>{window.location.reload()},h=[{value:"en",text:"English"},{value:"zhHans",text:"简体中文"},{value:"zhHant",text:"繁體中文"},{value:"de",text:"Deutsch"}],b=ee(n=>{const l=a.shortcut[n];["ctrl","shift"].includes(l.toLowerCase())&&(a.shortcut[n]="")},700),k=fe(()=>{B.warn(o("notAllowSingleCtrlOrShiftAsShortcut"))},3e3),m=(n,l)=>{const c=Oe(n);["ctrl","shift"].includes(c.toLowerCase())&&(k(),b(l)),c&&(a.shortcut[l]=c)},F=async()=>{await $e("shutdown_api_server_command"),await Ie.removeFile(xe),await Re()},N=P(()=>[{value:"empty",text:o("emptyStartPage")},{value:"last-workspace-state",text:o("restoreLastWorkspaceState")},...u.snapshots.map(l=>({value:`workspace_snapshot_${l.id}`,text:o("restoreWorkspaceSnapshot",[l.name])}))]),V=P(()=>{const n=a.shortcut,l={};return Object.values(n).forEach(c=>{var I;l[I=c+""]??(l[I]=0),l[c+""]++}),l}),r=P(()=>{var l;const n=[{key:"download",label:o("download")},{key:"delete",label:o("deleteSelected")}];return(l=a.conf)==null||l.all_custom_tags.forEach(c=>{n.push({key:`toggle_tag_${c.name}`,label:o("toggleTagSelection",{tag:c.name})})}),a.quickMovePaths.forEach(c=>{n.push({key:`copy_to_${c.dir}`,label:o("copyTo")+" "+c.zh})}),a.quickMovePaths.forEach(c=>{n.push({key:`move_to_${c.dir}`,label:o("moveTo")+" "+c.zh})}),n}),T=n=>n&&n in V.value&&V.value[n]>1,v=ve(be+"disable_maximize",!1);return(n,l)=>{var H;const c=Ue,I=L,d=le,$=oe,x=L,ne=z,A=Y,se=Pe,ue=Y,ie=te,de=Me;return _(),S("div",Xe,[(H=e(a).conf)!=null&&H.is_readonly?(_(),M(c,{key:0,message:n.$t("readonlyModeSettingPageDesc"),type:"warning"},null,8,["message"])):U("",!0),U("",!0),t(de,null,{default:s(()=>[t(d,{label:n.$t("lang")},{default:s(()=>[g("div",Ye,[t(e(W),{options:h,value:e(a).lang,"onUpdate:value":l[0]||(l[0]=i=>e(a).lang=i),onChange:l[1]||(l[1]=i=>f.value=!0)},null,8,["value"])]),f.value?(_(),M(I,{key:0,type:"primary",onClick:w,ghost:""},{default:s(()=>[C(p(e(o)("langChangeReload")),1)]),_:1})):U("",!0)]),_:1},8,["label"]),g("h2",Je,p(e(o)("ImageBrowsingSettings")),1),t(ze),g("h2",Ze,p(e(o)("autoTag.name")),1),t(qe),g("h2",null,"TikTok "+p(e(o)("view")),1),t(d,{label:n.$t("showTiktokNavigator")},{default:s(()=>[t($,{checked:e(a).showTiktokNavigator,"onUpdate:checked":l[2]||(l[2]=i=>e(a).showTiktokNavigator=i)},null,8,["checked"]),g("span",Qe,p(e(o)("showTiktokNavigatorDesc")),1)]),_:1},8,["label"]),g("h2",null,p(e(o)("imgSearch")),1),t(d,{label:n.$t("rebuildImageIndex")},{default:s(()=>[t(x,{onClick:e(ke)},{default:s(()=>[C(p(n.$t("start")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),g("h2",null,p(e(o)("autoRefresh")),1),t(d,{label:n.$t("autoRefreshWalkMode")},{default:s(()=>[t($,{checked:e(a).autoRefreshWalkMode,"onUpdate:checked":l[3]||(l[3]=i=>e(a).autoRefreshWalkMode=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:n.$t("autoRefreshNormalFixedMode")},{default:s(()=>[t($,{checked:e(a).autoRefreshNormalFixedMode,"onUpdate:checked":l[4]||(l[4]=i=>e(a).autoRefreshNormalFixedMode=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:e(o)("autoRefreshWalkModePosLimit")},{default:s(()=>[t(ne,{min:0,max:1024,step:16,modelValue:e(a).autoRefreshWalkModePosLimit,"onUpdate:modelValue":l[5]||(l[5]=i=>e(a).autoRefreshWalkModePosLimit=i)},null,8,["modelValue"])]),_:1},8,["label"]),g("h2",et,p(e(o)("other")),1),t(d,{label:n.$t("fileTypeFilter")},{default:s(()=>[t(se,{value:e(a).fileTypeFilter,"onUpdate:value":l[6]||(l[6]=i=>e(a).fileTypeFilter=i)},{default:s(()=>[t(A,{value:"all"},{default:s(()=>[C(p(n.$t("allFiles")),1)]),_:1}),t(A,{value:"image"},{default:s(()=>[C(p(n.$t("image")),1)]),_:1}),t(A,{value:"video"},{default:s(()=>[C(p(n.$t("video")),1)]),_:1}),t(A,{value:"audio"},{default:s(()=>[C(p(n.$t("audio")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),t(d,{label:n.$t("showCommaInGenInfoPanel")},{default:s(()=>[t($,{checked:e(a).showCommaInInfoPanel,"onUpdate:checked":l[7]||(l[7]=i=>e(a).showCommaInInfoPanel=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:n.$t("showRandomImageInStartup")},{default:s(()=>[t($,{checked:e(a).showRandomImageInStartup,"onUpdate:checked":l[8]||(l[8]=i=>e(a).showRandomImageInStartup=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:n.$t("defaultSortingMethod")},{default:s(()=>[t(e(W),{value:e(a).defaultSortingMethod,"onUpdate:value":l[9]||(l[9]=i=>e(a).defaultSortingMethod=i),conv:e(ye),options:e(we)},null,8,["value","conv","options"])]),_:1},8,["label"]),t(d,{label:n.$t("longPressOpenContextMenu")},{default:s(()=>[t($,{checked:e(a).longPressOpenContextMenu,"onUpdate:checked":l[10]||(l[10]=i=>e(a).longPressOpenContextMenu=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:n.$t("openOnAppStart")},{default:s(()=>[t(e(W),{value:e(a).defaultInitinalPage,"onUpdate:value":l[11]||(l[11]=i=>e(a).defaultInitinalPage=i),options:N.value},null,8,["value","options"])]),_:1},8,["label"]),(_(!0),S(O,null,D(e(a).ignoredConfirmActions,(i,R)=>(_(),M(d,{label:n.$t(R+"SkipConfirm"),key:R},{default:s(()=>[t(ue,{checked:e(a).ignoredConfirmActions[R],"onUpdate:checked":re=>e(a).ignoredConfirmActions[R]=re},null,8,["checked","onUpdate:checked"])]),_:2},1032,["label"]))),128)),t(d,{label:n.$t("disableMaximize")},{default:s(()=>[t($,{checked:e(v),"onUpdate:checked":l[12]||(l[12]=i=>Ce(v)?v.value=i:null)},null,8,["checked"]),g("sub",tt,p(n.$t("takeEffectAfterReloadPage")),1)]),_:1},8,["label"]),g("h2",null,p(e(o)("shortcutKey")),1),(_(!0),S(O,null,D(r.value,i=>(_(),M(d,{label:i.label,key:i.key},{default:s(()=>[g("div",{class:Se(["col",{conflict:T(e(a).shortcut[i.key]+"")}]),onKeydown:l[13]||(l[13]=X(()=>{},["stop","prevent"]))},[t(ie,{value:e(a).shortcut[i.key],onKeydown:X(R=>m(R,i.key),["stop","prevent"]),placeholder:n.$t("shortcutKeyDescription")},null,8,["value","onKeydown","placeholder"]),t(I,{onClick:R=>e(a).shortcut[i.key]="",class:"clear-btn"},{default:s(()=>[C(p(n.$t("clear")),1)]),_:2},1032,["onClick"])],34)]),_:2},1032,["label"]))),128)),e(Te)?(_(),S(O,{key:0},[g("h2",null,p(e(o)("clientSpecificSettings")),1),t(d,null,{default:s(()=>[g("div",at,[t(I,{onClick:F,class:"clear-btn"},{default:s(()=>[C(p(n.$t("initiateSoftwareStartupConfig")),1)]),_:1})])]),_:1})],64)):U("",!0)]),_:1})])}}});const _t=ae(lt,[["__scopeId","data-v-e8b4762d"]]);export{_t as default};
