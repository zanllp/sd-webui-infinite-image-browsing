var ht=Object.defineProperty;var gt=(i,n,e)=>n in i?ht(i,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[n]=e;var ee=(i,n,e)=>(gt(i,typeof n!="symbol"?n+"":n,e),e);import{d as Z,u as Je,G as x,an as We,h as W,c as b,aq as pt,dj as vt,r as j,bg as mt,Z as V,dh as yt,P as De,c9 as bt,A as X,dk as de,O as ge,am as ke,bj as At,d4 as St,b_ as kt,dl as _t,cG as It,dm as Ne,dn as Ct,p as wt,dp as Ke,bA as Tt,dq as ae,dr as Et,aH as Pt,ds as Ot,C as Dt,dt as Nt,n as pe,m as re,aT as zt,t as Ge,a1 as _e,c7 as Ye,aJ as Qt,du as qe,dv as Mt,Q as $t,x as Bt,aP as Ze,aQ as Xe,az as et,U as a,a2 as R,dw as Ft,dx as Rt,dy as Lt,c3 as jt,dz as Vt,at as xt,V as f,aG as te,$ as A,a3 as S,a8 as J,c4 as ze,c5 as Ht,dA as Ut,a7 as tt,ag as K,X as k,Y as p,a4 as F,al as nt,dc as Jt,db as Wt,M as it,W as u,a0 as st,d6 as Kt,dB as Qe,af as Gt,dC as Yt,d9 as qt,dD as Zt,dE as Xt,cr as Me,cR as en,dF as ce,cL as tn,dG as nn,dH as sn}from"./index-4c34d886.js";import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-1da329eb.js";import{i as rn}from"./_isIterateeCall-01eb9d10.js";import{D as Y,a as ve}from"./index-801ff9bd.js";/* empty css              */var on=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},ln=Z({compatConfig:{MODE:3},name:"ACheckableTag",props:on(),setup:function(n,e){var t=e.slots,r=e.emit,o=Je("tag",n),h=o.prefixCls,c=function(E){var C=n.checked;r("update:checked",!C),r("change",!C),r("click",E)},g=x(function(){var m;return We(h.value,(m={},W(m,"".concat(h.value,"-checkable"),!0),W(m,"".concat(h.value,"-checkable-checked"),n.checked),m))});return function(){var m;return b("span",{class:g.value,onClick:c},[(m=t.default)===null||m===void 0?void 0:m.call(t)])}}});const me=ln;var an=new RegExp("^(".concat(pt.join("|"),")(-inverse)?$")),un=new RegExp("^(".concat(vt.join("|"),")$")),dn=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:De.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:De.any}},q=Z({compatConfig:{MODE:3},name:"ATag",props:dn(),slots:["closeIcon","icon"],setup:function(n,e){var t=e.slots,r=e.emit,o=e.attrs,h=Je("tag",n),c=h.prefixCls,g=h.direction,m=j(!0);mt(function(){n.visible!==void 0&&(m.value=n.visible)});var E=function(l){l.stopPropagation(),r("update:visible",!1),r("close",l),!l.defaultPrevented&&n.visible===void 0&&(m.value=!1)},C=x(function(){var Q=n.color;return Q?an.test(Q)||un.test(Q):!1}),P=x(function(){var Q;return We(c.value,(Q={},W(Q,"".concat(c.value,"-").concat(n.color),C.value),W(Q,"".concat(c.value,"-has-color"),n.color&&!C.value),W(Q,"".concat(c.value,"-hidden"),!m.value),W(Q,"".concat(c.value,"-rtl"),g.value==="rtl"),Q))});return function(){var Q,l,s,d=n.icon,w=d===void 0?(Q=t.icon)===null||Q===void 0?void 0:Q.call(t):d,O=n.color,M=n.closeIcon,v=M===void 0?(l=t.closeIcon)===null||l===void 0?void 0:l.call(t):M,I=n.closable,T=I===void 0?!1:I,y=function(){return T?v?b("span",{class:"".concat(c.value,"-close-icon"),onClick:E},[v]):b(bt,{class:"".concat(c.value,"-close-icon"),onClick:E},null):null},N={backgroundColor:O&&!C.value?O:void 0},B=w||null,_=(s=t.default)===null||s===void 0?void 0:s.call(t),L=B?b(V,null,[B,b("span",null,[_])]):_,D="onClick"in o,$=b("span",{class:P.value,style:N},[L,y()]);return D?b(yt,null,{default:function(){return[$]}}):$}}});q.CheckableTag=me;q.install=function(i){return i.component(q.name,q),i.component(me.name,me),i};const cn=q;Y.Button=ve;Y.install=function(i){return i.component(Y.name,Y),i.component(ve.name,ve),i};var fn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const hn=fn;function $e(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.forEach(function(r){gn(i,r,e[r])})}return i}function gn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Ie=function(n,e){var t=$e({},n,e.attrs);return b(X,$e({},t,{icon:hn}),null)};Ie.displayName="StarFilled";Ie.inheritAttrs=!1;const rt=Ie;var pn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const vn=pn;function Be(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.forEach(function(r){mn(i,r,e[r])})}return i}function mn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Ce=function(n,e){var t=Be({},n,e.attrs);return b(X,Be({},t,{icon:vn}),null)};Ce.displayName="FileOutlined";Ce.inheritAttrs=!1;const yn=Ce;var bn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const An=bn;function Fe(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.forEach(function(r){Sn(i,r,e[r])})}return i}function Sn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var we=function(n,e){var t=Fe({},n,e.attrs);return b(X,Fe({},t,{icon:An}),null)};we.displayName="FolderOpenOutlined";we.inheritAttrs=!1;const kn=we;function _n(i){return i&&i.length?i[0]:void 0}var In=Math.ceil,Cn=Math.max;function wn(i,n,e,t){for(var r=-1,o=Cn(In((n-i)/(e||1)),0),h=Array(o);o--;)h[t?o:++r]=i,i+=e;return h}function Tn(i){return function(n,e,t){return t&&typeof t!="number"&&rn(n,e,t)&&(e=t=void 0),n=de(n),e===void 0?(e=n,n=0):e=de(e),t=t===void 0?n<e?1:-1:de(t),wn(n,e,t,i)}}var En=Tn();const Pn=En,On="data:image/png;base64,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",ne=new WeakMap;function Dn(i,n){return{useHookShareState:t=>{const r=kt();ge(r),ne.has(r)||(ne.set(r,ke(i(r,t??(n==null?void 0:n())))),At(()=>{ne.delete(r)}));const o=ne.get(r);return ge(o),{state:o,toRefs(){return St(o)}}}}}var Nn={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const zn=Nn;function Re(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.forEach(function(r){Qn(i,r,e[r])})}return i}function Qn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Te=function(n,e){var t=Re({},n,e.attrs);return b(X,Re({},t,{icon:zn}),null)};Te.displayName="CaretRightOutlined";Te.inheritAttrs=!1;const Le=Te;var Mn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const $n=Mn;function je(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.forEach(function(r){Bn(i,r,e[r])})}return i}function Bn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Ee=function(n,e){var t=je({},n,e.attrs);return b(X,je({},t,{icon:$n}),null)};Ee.displayName="StarOutlined";Ee.inheritAttrs=!1;const ot=Ee,Fn="/infinite_image_browsing/fe-static/assets/play-68f5544d.svg",Rn=_t("useBatchDownloadStore",()=>{const i=j([]);return{selectdFiles:i,addFiles:e=>{i.value=It([...i.value,...e])}}});class oe{constructor(n,e=Ct.CREATED_TIME_DESC){ee(this,"root");ee(this,"execQueue",[]);ee(this,"walkerInitPromsie");this.entryPath=n,this.sortMethod=e,this.root={children:[],info:{name:this.entryPath,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:this.entryPath}},this.walkerInitPromsie=new Promise(t=>{Ne([this.entryPath]).then(async r=>{this.root.info=r[this.entryPath],await this.fetchChildren(this.root),t()})})}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const n=e=>e.children.map(t=>{if(t.info.type==="dir")return n(t);if(ae(t.info.name))return t.info}).filter(t=>t).flat(1);return n(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(n){const{files:e}=await wt(n.info.fullpath);return n.children=Ke(e,this.sortMethod).map(t=>({info:t,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...n.children.filter(t=>t.info.type==="dir").map(t=>({fn:()=>this.fetchChildren(t),...t}))),n}async next(){await this.walkerInitPromsie;const n=_n(this.execQueue);if(!n)return null;const e=await n.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},e}async isExpired(){const n=[this.root.info],e=r=>{for(const o of r.children)o.info.type==="dir"&&(n.push(o.info),e(o))};e(this.root);const t=await Ne(n.map(r=>r.fullpath));for(const r of n)if(!Tt(r,t[r.fullpath]))return!0;return!1}async seamlessRefresh(n,e=j(!1)){const t=performance.now(),r=new oe(this.entryPath,this.sortMethod);for(await r.walkerInitPromsie;!r.isCompleted&&r.images.length<n;){if(e.value)throw new Error("canceled");await r.next()}const o=performance.now();return console.log("seamlessRefresh currPos:",n,"Time taken:",(o-t).toFixed(0),"ms"),r}}var lt={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(i,n){(function(e,t){i.exports=t})(Et,function(){var e={};e.version="0.3.5";var t=e.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};e.configure=function(l){var s,d;for(s in l)d=l[s],d!==void 0&&l.hasOwnProperty(s)&&(t[s]=d);return this},e.status=null,e.set=function(l){var s=e.isStarted();l=r(l,t.minimum,1),e.status=l===1?null:l;var d=e.render(!s),w=d.querySelector(t.barSelector),O=t.speed,M=t.easing;return d.offsetWidth,c(function(v){t.positionUsing===""&&(t.positionUsing=e.getPositioningCSS()),g(w,h(l,O,M)),l===1?(g(d,{transition:"none",opacity:1}),d.offsetWidth,setTimeout(function(){g(d,{transition:"all "+O+"ms linear",opacity:0}),setTimeout(function(){e.remove(),v()},O)},O)):setTimeout(v,O)}),this},e.isStarted=function(){return typeof e.status=="number"},e.start=function(){e.status||e.set(0);var l=function(){setTimeout(function(){e.status&&(e.trickle(),l())},t.trickleSpeed)};return t.trickle&&l(),this},e.done=function(l){return!l&&!e.status?this:e.inc(.3+.5*Math.random()).set(1)},e.inc=function(l){var s=e.status;return s?s>1?void 0:(typeof l!="number"&&(s>=0&&s<.2?l=.1:s>=.2&&s<.5?l=.04:s>=.5&&s<.8?l=.02:s>=.8&&s<.99?l=.005:l=0),s=r(s+l,0,.994),e.set(s)):e.start()},e.trickle=function(){return e.inc()},function(){var l=0,s=0;e.promise=function(d){return!d||d.state()==="resolved"?this:(s===0&&e.start(),l++,s++,d.always(function(){s--,s===0?(l=0,e.done()):e.set((l-s)/l)}),this)}}(),e.getElement=function(){var l=e.getParent();if(l){var s=Array.prototype.slice.call(l.querySelectorAll(".nprogress")).filter(function(d){return d.parentElement===l});if(s.length>0)return s[0]}return null},e.getParent=function(){if(t.parent instanceof HTMLElement)return t.parent;if(typeof t.parent=="string")return document.querySelector(t.parent)},e.render=function(l){if(e.isRendered())return e.getElement();E(document.documentElement,"nprogress-busy");var s=document.createElement("div");s.id="nprogress",s.className="nprogress",s.innerHTML=t.template;var d=s.querySelector(t.barSelector),w=l?"-100":o(e.status||0),O=e.getParent(),M;return g(d,{transition:"all 0 linear",transform:"translate3d("+w+"%,0,0)"}),t.showSpinner||(M=s.querySelector(t.spinnerSelector),M&&Q(M)),O!=document.body&&E(O,"nprogress-custom-parent"),O.appendChild(s),s},e.remove=function(){e.status=null,C(document.documentElement,"nprogress-busy"),C(e.getParent(),"nprogress-custom-parent");var l=e.getElement();l&&Q(l)},e.isRendered=function(){return!!e.getElement()},e.getPositioningCSS=function(){var l=document.body.style,s="WebkitTransform"in l?"Webkit":"MozTransform"in l?"Moz":"msTransform"in l?"ms":"OTransform"in l?"O":"";return s+"Perspective"in l?"translate3d":s+"Transform"in l?"translate":"margin"};function r(l,s,d){return l<s?s:l>d?d:l}function o(l){return(-1+l)*100}function h(l,s,d){var w;return t.positionUsing==="translate3d"?w={transform:"translate3d("+o(l)+"%,0,0)"}:t.positionUsing==="translate"?w={transform:"translate("+o(l)+"%,0)"}:w={"margin-left":o(l)+"%"},w.transition="all "+s+"ms "+d,w}var c=function(){var l=[];function s(){var d=l.shift();d&&d(s)}return function(d){l.push(d),l.length==1&&s()}}(),g=function(){var l=["Webkit","O","Moz","ms"],s={};function d(v){return v.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(I,T){return T.toUpperCase()})}function w(v){var I=document.body.style;if(v in I)return v;for(var T=l.length,y=v.charAt(0).toUpperCase()+v.slice(1),N;T--;)if(N=l[T]+y,N in I)return N;return v}function O(v){return v=d(v),s[v]||(s[v]=w(v))}function M(v,I,T){I=O(I),v.style[I]=T}return function(v,I){var T=arguments,y,N;if(T.length==2)for(y in I)N=I[y],N!==void 0&&I.hasOwnProperty(y)&&M(v,y,N);else M(v,T[1],T[2])}}();function m(l,s){var d=typeof l=="string"?l:P(l);return d.indexOf(" "+s+" ")>=0}function E(l,s){var d=P(l),w=d+s;m(d,s)||(l.className=w.substring(1))}function C(l,s){var d=P(l),w;m(l,s)&&(w=d.replace(" "+s+" "," "),l.className=w.substring(1,w.length-1))}function P(l){return(" "+(l&&l.className||"")+" ").replace(/\s+/gi," ")}function Q(l){l&&l.parentNode&&l.parentNode.removeChild(l)}return e})})(lt);var Ln=lt.exports;const rr=Pt(Ln);function or({fetchNext:i}={}){const{scroller:n,sortedFiles:e,sortMethod:t,currLocation:r,stackViewEl:o,canLoadNext:h,previewIdx:c,props:g,walker:m,getViewableAreaFiles:E}=le().toRefs(),{state:C}=le(),P=j(!1),Q=j(G.defaultGridCellWidth),l=x(()=>Q.value+16),s=44,{width:d}=Ot(o),w=x(()=>~~(d.value/l.value)),O=ke(new Map),M=x(()=>{const B=l.value;return{first:B+(Q.value<=160?0:s),second:B}}),v=j(!1),I=async()=>{var B;if(!(v.value||g.value.mode!=="walk"||!h.value))try{v.value=!0,await((B=m.value)==null?void 0:B.next())}finally{v.value=!1}},T=async(B=!1)=>{const _=n.value,L=()=>B?c.value:(_==null?void 0:_.$_endIndex)??0,D=()=>{const $=e.value.length,H=50;return $?i?L()>$-H:L()>$-H&&h.value:!0};for(;D();){await Ge(30);const $=await(i??I)();if(typeof $=="boolean"&&!$)return}};C.useEventListen("loadNextDir",Dt(async(B=!1)=>{await T(B),g.value.mode==="walk"&&y()})),C.useEventListen("viewableAreaFilesChange",()=>{const B=E.value(),_=B.filter(D=>D.is_under_scanned_path&&ae(D.name)).map(D=>D.fullpath);jn.fetchImageTags(_);const L=B.filter(D=>D.is_under_scanned_path&&D.type==="dir"&&!O.has(D.fullpath)).map(D=>D.fullpath);L.length&&Nt(L).then(D=>{for(const $ in D)if(Object.prototype.hasOwnProperty.call(D,$)){const H=D[$];O.set($,H)}})}),C.useEventListen("refresh",async()=>{C.eventEmitter.emit("viewableAreaFilesChange")});const y=pe(()=>C.eventEmitter.emit("viewableAreaFilesChange"),300);re(r,y);const N=pe(async()=>{await T(),y()},150);return{gridItems:w,sortedFiles:e,sortMethodConv:zt,moreActionsDropdownShow:P,gridSize:l,sortMethod:t,onScroll:N,loadNextDir:I,loadNextDirLoading:v,canLoadNext:h,itemSize:M,cellWidth:Q,dirCoverCache:O}}const lr=new Map,G=_e(),ar=Rn(),jn=Ye(),ur=Qt(),dr=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:cr,useEventListen:fr}=qe(),{useHookShareState:le}=Dn((i,{images:n})=>{const e=j({tabIdx:-1,paneIdx:-1}),t=x(()=>$t(r.value)),r=j([]),o=x(()=>{var I;return r.value.map(T=>T.curr).slice((I=G.conf)!=null&&I.is_win&&e.value.mode!=="scanned-fixed"?1:0)}),h=x(()=>Bt(...o.value)),c=x(()=>{var I,T;return e.value.mode==="scanned-fixed"?((T=(I=r.value)==null?void 0:I[0])==null?void 0:T.curr)??"":e.value.mode==="walk"?e.value.path??"":r.value.length===1?"/":h.value}),g=j(G.defaultSortingMethod),m=j(e.value.mode=="walk"?new oe(e.value.path,g.value):void 0);re([()=>e.value.mode,()=>e.value.path,g],async([I,T,y])=>{var N;I==="walk"?(m.value=new oe(T,y),r.value=[{files:[],curr:T}],await Ge(),await((N=m.value)==null?void 0:N.reset()),M.eventEmitter.emit("loadNextDir")):m.value=void 0});const E=ke(new Set);re(t,()=>E.clear());const C=x(()=>{var N;if(n.value)return n.value;if(m.value)return m.value.images.filter(B=>!E.has(B.fullpath));if(!t.value)return[];const I=((N=t.value)==null?void 0:N.files)??[],T=g.value;return Ke((B=>G.onlyFoldersAndImages?B.filter(_=>_.type==="dir"||ae(_.name)):B)(I),T).filter(B=>!E.has(B.fullpath))}),P=j([]),Q=j(-1),l=x(()=>m.value?!m.value.isCompleted:!1),s=j(!1),d=j(!1),w=j(),O=()=>{var I,T,y;return(y=(T=(I=G.tabList)==null?void 0:I[e.value.tabIdx])==null?void 0:T.panes)==null?void 0:y[e.value.paneIdx]},M=qe();M.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${C.value.length}`),P.value=Pn(0,C.value.length)});const v=()=>{const I=w.value;if(I){const T=Math.max(I.$_startIndex-10,0);return C.value.slice(T,I.$_endIndex+10)}return[]};return{previewing:d,spinning:s,canLoadNext:l,multiSelectedIdxs:P,previewIdx:Q,basePath:o,currLocation:c,currPage:t,stack:r,sortMethod:g,sortedFiles:C,scroller:w,stackViewEl:j(),props:e,getPane:O,walker:m,deletedFiles:E,getViewableAreaFiles:v,...M}},()=>({images:j()}));function hr(){const{eventEmitter:i,multiSelectedIdxs:n,sortedFiles:e}=le().toRefs();return{onSelectAll:()=>i.value.emit("selectAll"),onReverseSelect:()=>{n.value=e.value.map((h,c)=>c).filter(h=>!n.value.includes(h))},onClearAllSelected:()=>{n.value=[]}}}const gr=()=>{const{stackViewEl:i}=le().toRefs(),n=j(-1);return Mt(i,e=>{var r;let t=e.target;for(;t.parentElement;)if(t=t.parentElement,t.tagName.toLowerCase()==="li"&&t.classList.contains("file-item-trigger")){const o=(r=t.dataset)==null?void 0:r.idx;o&&Number.isSafeInteger(+o)&&(n.value=+o);return}}),{showMenuIdx:n}};function Vn(){var i=window.navigator.userAgent,n=i.indexOf("MSIE ");if(n>0)return parseInt(i.substring(n+5,i.indexOf(".",n)),10);var e=i.indexOf("Trident/");if(e>0){var t=i.indexOf("rv:");return parseInt(i.substring(t+3,i.indexOf(".",t)),10)}var r=i.indexOf("Edge/");return r>0?parseInt(i.substring(r+5,i.indexOf(".",r)),10):-1}let ie;function ye(){ye.init||(ye.init=!0,ie=Vn()!==-1)}var ue={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){ye(),et(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const i=document.createElement("object");this._resizeObject=i,i.setAttribute("aria-hidden","true"),i.setAttribute("tabindex",-1),i.onload=this.addResizeHandlers,i.type="text/html",ie&&this.$el.appendChild(i),i.data="about:blank",ie||this.$el.appendChild(i)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!ie&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const xn=Ft();Ze("data-v-b329ee4c");const Hn={class:"resize-observer",tabindex:"-1"};Xe();const Un=xn((i,n,e,t,r,o)=>(a(),R("div",Hn)));ue.render=Un;ue.__scopeId="data-v-b329ee4c";ue.__file="src/components/ResizeObserver.vue";function se(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?se=function(n){return typeof n}:se=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},se(i)}function Jn(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function Ve(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}function Wn(i,n,e){return n&&Ve(i.prototype,n),e&&Ve(i,e),i}function xe(i){return Kn(i)||Gn(i)||Yn(i)||qn()}function Kn(i){if(Array.isArray(i))return be(i)}function Gn(i){if(typeof Symbol<"u"&&Symbol.iterator in Object(i))return Array.from(i)}function Yn(i,n){if(i){if(typeof i=="string")return be(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return be(i,n)}}function be(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function qn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zn(i){var n;return typeof i=="function"?n={callback:i}:n=i,n}function Xn(i,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t,r,o,h=function(g){for(var m=arguments.length,E=new Array(m>1?m-1:0),C=1;C<m;C++)E[C-1]=arguments[C];if(o=E,!(t&&g===r)){var P=e.leading;typeof P=="function"&&(P=P(g,r)),(!t||g!==r)&&P&&i.apply(void 0,[g].concat(xe(o))),r=g,clearTimeout(t),t=setTimeout(function(){i.apply(void 0,[g].concat(xe(o))),t=0},n)}};return h._clear=function(){clearTimeout(t),t=null},h}function at(i,n){if(i===n)return!0;if(se(i)==="object"){for(var e in i)if(!at(i[e],n[e]))return!1;return!0}return!1}var ei=function(){function i(n,e,t){Jn(this,i),this.el=n,this.observer=null,this.frozen=!1,this.createObserver(e,t)}return Wn(i,[{key:"createObserver",value:function(e,t){var r=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Zn(e),this.callback=function(c,g){r.options.callback(c,g),c&&r.options.once&&(r.frozen=!0,r.destroyObserver())},this.callback&&this.options.throttle){var o=this.options.throttleOptions||{},h=o.leading;this.callback=Xn(this.callback,this.options.throttle,{leading:function(g){return h==="both"||h==="visible"&&g||h==="hidden"&&!g}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(c){var g=c[0];if(c.length>1){var m=c.find(function(C){return C.isIntersecting});m&&(g=m)}if(r.callback){var E=g.isIntersecting&&g.intersectionRatio>=r.threshold;if(E===r.oldResult)return;r.oldResult=E,r.callback(E,g)}},this.options.intersection),et(function(){r.observer&&r.observer.observe(r.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),i}();function ut(i,n,e){var t=n.value;if(t)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var r=new ei(i,t,e);i._vue_visibilityState=r}}function ti(i,n,e){var t=n.value,r=n.oldValue;if(!at(t,r)){var o=i._vue_visibilityState;if(!t){dt(i);return}o?o.createObserver(t,e):ut(i,{value:t},e)}}function dt(i){var n=i._vue_visibilityState;n&&(n.destroyObserver(),delete i._vue_visibilityState)}var ni={beforeMount:ut,updated:ti,unmounted:dt},ii={itemsLimit:1e3},si=/(auto|scroll)/;function ct(i,n){return i.parentNode===null?n:ct(i.parentNode,n.concat([i]))}var fe=function(n,e){return getComputedStyle(n,null).getPropertyValue(e)},ri=function(n){return fe(n,"overflow")+fe(n,"overflow-y")+fe(n,"overflow-x")},oi=function(n){return si.test(ri(n))};function He(i){if(i instanceof HTMLElement||i instanceof SVGElement){for(var n=ct(i.parentNode,[]),e=0;e<n.length;e+=1)if(oi(n[e]))return n[e];return document.scrollingElement||document.documentElement}}function Ae(i){"@babel/helpers - typeof";return Ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ae(i)}var li={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(n){return["vertical","horizontal"].includes(n)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function ai(){return this.items.length&&Ae(this.items[0])!=="object"}var Se=!1;if(typeof window<"u"){Se=!1;try{var ui=Object.defineProperty({},"passive",{get:function(){Se=!0}});window.addEventListener("test",null,ui)}catch{}}let di=0;var ft={name:"RecycleScroller",components:{ResizeObserver:ue},directives:{ObserveVisibility:ni},props:{...li,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const i={"-1":{accumulator:0}},n=this.items,e=this.sizeField,t=this.minItemSize;let r=1e4,o=0,h;for(let c=0,g=n.length;c<g;c++)h=n[c][e]||t,h<r&&(r=h),o+=h,i[c]={accumulator:o,size:h};return this.$_computedMinItemSize=r,i}return[]},simpleArray:ai,itemIndexByKey(){const{keyField:i,items:n}=this,e={};for(let t=0,r=n.length;t<r;t++)e[n[t][i]]=t;return e}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const i=this.$_lastUpdateScrollPosition;typeof i=="number"&&this.$nextTick(()=>{this.scrollToPosition(i)})},beforeUnmount(){this.removeListeners()},methods:{addView(i,n,e,t,r){const o=Rt({id:di++,index:n,used:!0,key:t,type:r}),h=Lt({item:e,position:0,nr:o});return i.push(h),h},unuseView(i,n=!1){const e=this.$_unusedViews,t=i.nr.type;let r=e.get(t);r||(r=[],e.set(t,r)),r.push(i),n||(i.nr.used=!1,i.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(i){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const n=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:e}=this.updateVisibleItems(!1,!0);e||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});n(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&n()},this.updateInterval))}},handleVisibilityChange(i,n){this.ready&&(i||n.boundingClientRect.width!==0||n.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(i,n=!1){const e=this.itemSize,t=this.gridItems||1,r=this.itemSecondarySize||e,o=this.$_computedMinItemSize,h=this.typeField,c=this.simpleArray?null:this.keyField,g=this.items,m=g.length,E=this.sizes,C=this.$_views,P=this.$_unusedViews,Q=this.pool,l=this.itemIndexByKey;let s,d,w,O,M;if(!m)s=d=O=M=w=0;else if(this.$_prerender)s=O=0,d=M=Math.min(this.prerender,g.length),w=null;else{const _=this.getScroll();if(n){let $=_.start-this.$_lastUpdateScrollPosition;if($<0&&($=-$),e===null&&$<o||$<e)return{continuous:!0}}this.$_lastUpdateScrollPosition=_.start;const L=this.buffer;_.start-=L,_.end+=L;let D=0;if(this.$refs.before&&(D=this.$refs.before.scrollHeight,_.start-=D),this.$refs.after){const $=this.$refs.after.scrollHeight;_.end+=$}if(e===null){let $,H=0,Pe=m-1,U=~~(m/2),Oe;do Oe=U,$=E[U].accumulator,$<_.start?H=U:U<m-1&&E[U+1].accumulator>_.start&&(Pe=U),U=~~((H+Pe)/2);while(U!==Oe);for(U<0&&(U=0),s=U,w=E[m-1].accumulator,d=U;d<m&&E[d].accumulator<_.end;d++);for(d===-1?d=g.length-1:(d++,d>m&&(d=m)),O=s;O<m&&D+E[O].accumulator<_.start;O++);for(M=O;M<m&&D+E[M].accumulator<_.end;M++);}else{s=~~(_.start/e*t);const $=s%t;s-=$,d=Math.ceil(_.end/e*t),O=Math.max(0,Math.floor((_.start-D)/e*t)),M=Math.floor((_.end-D)/e*t),s<0&&(s=0),d>m&&(d=m),O<0&&(O=0),M>m&&(M=m),w=Math.ceil(m/t)*e}}d-s>ii.itemsLimit&&this.itemsLimitError(),this.totalSize=w;let v;const I=s<=this.$_endIndex&&d>=this.$_startIndex;if(I)for(let _=0,L=Q.length;_<L;_++)v=Q[_],v.nr.used&&(i&&(v.nr.index=l[v.item[c]]),(v.nr.index==null||v.nr.index<s||v.nr.index>=d)&&this.unuseView(v));const T=I?null:new Map;let y,N,B;for(let _=s;_<d;_++){y=g[_];const L=c?y[c]:y;if(L==null)throw new Error(`Key is ${L} on item (keyField is '${c}')`);if(v=C.get(L),!e&&!E[_].size){v&&this.unuseView(v);continue}N=y[h];let D=P.get(N),$=!1;if(!v)I?D&&D.length?v=D.pop():v=this.addView(Q,_,y,L,N):(B=T.get(N)||0,(!D||B>=D.length)&&(v=this.addView(Q,_,y,L,N),this.unuseView(v,!0),D=P.get(N)),v=D[B],T.set(N,B+1)),C.delete(v.nr.key),v.nr.used=!0,v.nr.index=_,v.nr.key=L,v.nr.type=N,C.set(L,v),$=!0;else if(!v.nr.used&&(v.nr.used=!0,v.nr.index=_,$=!0,D)){const H=D.indexOf(v);H!==-1&&D.splice(H,1)}v.item=y,$&&(_===g.length-1&&this.$emit("scroll-end"),_===0&&this.$emit("scroll-start")),e===null?(v.position=E[_-1].accumulator,v.offset=0):(v.position=Math.floor(_/t)*e,v.offset=_%t*r)}return this.$_startIndex=s,this.$_endIndex=d,this.emitUpdate&&this.$emit("update",s,d,O,M),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:I}},getListenerTarget(){let i=He(this.$el);return window.document&&(i===window.document.documentElement||i===window.document.body)&&(i=window),i},getScroll(){const{$el:i,direction:n}=this,e=n==="vertical";let t;if(this.pageMode){const r=i.getBoundingClientRect(),o=e?r.height:r.width;let h=-(e?r.top:r.left),c=e?window.innerHeight:window.innerWidth;h<0&&(c+=h,h=0),h+c>o&&(c=o-h),t={start:h,end:h+c}}else e?t={start:i.scrollTop,end:i.scrollTop+i.clientHeight}:t={start:i.scrollLeft,end:i.scrollLeft+i.clientWidth};return t},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Se?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(i){let n;const e=this.gridItems||1;this.itemSize===null?n=i>0?this.sizes[i-1].accumulator:0:n=Math.floor(i/e)*this.itemSize,this.scrollToPosition(n)},scrollToPosition(i){const n=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let e,t,r;if(this.pageMode){const o=He(this.$el),h=o.tagName==="HTML"?0:o[n.scroll],c=o.getBoundingClientRect(),m=this.$el.getBoundingClientRect()[n.start]-c[n.start];e=o,t=n.scroll,r=i+h+m}else e=this.$el,t=n.scroll,r=i;e[t]=r},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((i,n)=>i.nr.index-n.nr.index)}}};const ci={key:0,ref:"before",class:"vue-recycle-scroller__slot"},fi={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function hi(i,n,e,t,r,o){const h=jt("ResizeObserver"),c=Vt("observe-visibility");return xt((a(),f("div",{class:K(["vue-recycle-scroller",{ready:r.ready,"page-mode":e.pageMode,[`direction-${i.direction}`]:!0}]),onScrollPassive:n[0]||(n[0]=(...g)=>o.handleScroll&&o.handleScroll(...g))},[i.$slots.before?(a(),f("div",ci,[te(i.$slots,"before")],512)):A("v-if",!0),(a(),R(ze(e.listTag),{ref:"wrapper",style:tt({[i.direction==="vertical"?"minHeight":"minWidth"]:r.totalSize+"px"}),class:K(["vue-recycle-scroller__item-wrapper",e.listClass])},{default:S(()=>[(a(!0),f(V,null,J(r.pool,g=>(a(),R(ze(e.itemTag),Ht({key:g.nr.id,style:r.ready?{transform:`translate${i.direction==="vertical"?"Y":"X"}(${g.position}px) translate${i.direction==="vertical"?"X":"Y"}(${g.offset}px)`,width:e.gridItems?`${i.direction==="vertical"&&e.itemSecondarySize||e.itemSize}px`:void 0,height:e.gridItems?`${i.direction==="horizontal"&&e.itemSecondarySize||e.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[e.itemClass,{hover:!e.skipHover&&r.hoverKey===g.nr.key}]]},Ut(e.skipHover?{}:{mouseenter:()=>{r.hoverKey=g.nr.key},mouseleave:()=>{r.hoverKey=null}})),{default:S(()=>[te(i.$slots,"default",{item:g.item,index:g.nr.index,active:g.nr.used})]),_:2},1040,["style","class"]))),128)),te(i.$slots,"empty")]),_:3},8,["style","class"])),i.$slots.after?(a(),f("div",fi,[te(i.$slots,"after")],512)):A("v-if",!0),b(h,{onNotify:o.handleResize},null,8,["onNotify"])],34)),[[c,o.handleVisibilityChange]])}ft.render=hi;ft.__file="src/components/RecycleScroller.vue";const Ue=Z({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},isSelectedMutilFiles:{type:Boolean}},emits:["contextMenuClick"],setup(i,{emit:n}){const e=i,t=_e(),r=x(()=>{var o;return(((o=t.conf)==null?void 0:o.all_custom_tags)??[]).reduce((h,c)=>[...h,{...c,selected:!!e.selectedTag.find(g=>g.id===c.id)}],[])});return(o,h)=>{const c=nt,g=Jt,m=Wt,E=it;return a(),R(E,{onClick:h[0]||(h[0]=C=>n("contextMenuClick",C,o.file,o.idx))},{default:S(()=>{var C;return[b(c,{key:"deleteFiles"},{default:S(()=>[k(p(o.$t("deleteSelected")),1)]),_:1}),b(c,{key:"openWithDefaultApp"},{default:S(()=>[k(p(o.$t("openWithDefaultApp")),1)]),_:1}),b(c,{key:"saveSelectedAsJson"},{default:S(()=>[k(p(o.$t("saveSelectedAsJson")),1)]),_:1}),o.file.type==="dir"?(a(),f(V,{key:0},[b(c,{key:"openInNewTab"},{default:S(()=>[k(p(o.$t("openInNewTab")),1)]),_:1}),b(c,{key:"openOnTheRight"},{default:S(()=>[k(p(o.$t("openOnTheRight")),1)]),_:1}),b(c,{key:"openWithWalkMode"},{default:S(()=>[k(p(o.$t("openWithWalkMode")),1)]),_:1})],64)):A("",!0),o.file.type==="file"?(a(),f(V,{key:1},[F(ae)(o.file.name)?(a(),f(V,{key:0},[b(c,{key:"viewGenInfo"},{default:S(()=>[k(p(o.$t("viewGenerationInfo")),1)]),_:1}),b(c,{key:"tiktokView"},{default:S(()=>[k(p(o.$t("tiktokView")),1)]),_:1}),b(g),((C=F(t).conf)==null?void 0:C.launch_mode)!=="server"?(a(),f(V,{key:0},[b(c,{key:"send2txt2img"},{default:S(()=>[k(p(o.$t("sendToTxt2img")),1)]),_:1}),b(c,{key:"send2img2img"},{default:S(()=>[k(p(o.$t("sendToImg2img")),1)]),_:1}),b(c,{key:"send2inpaint"},{default:S(()=>[k(p(o.$t("sendToInpaint")),1)]),_:1}),b(c,{key:"send2extras"},{default:S(()=>[k(p(o.$t("sendToExtraFeatures")),1)]),_:1}),b(m,{key:"sendToThirdPartyExtension",title:o.$t("sendToThirdPartyExtension")},{default:S(()=>[b(c,{key:"send2controlnet-txt2img"},{default:S(()=>[k("ControlNet - "+p(o.$t("t2i")),1)]),_:1}),b(c,{key:"send2controlnet-img2img"},{default:S(()=>[k("ControlNet - "+p(o.$t("i2i")),1)]),_:1}),b(c,{key:"send2outpaint"},{default:S(()=>[k("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):A("",!0),b(c,{key:"send2BatchDownload"},{default:S(()=>[k(p(o.$t("sendToBatchDownload")),1)]),_:1}),b(m,{key:"copy2target",title:o.$t("copyTo")},{default:S(()=>[(a(!0),f(V,null,J(F(t).quickMovePaths,P=>(a(),R(c,{key:`copy-to-${P.dir}`},{default:S(()=>[k(p(P.zh),1)]),_:2},1024))),128))]),_:1},8,["title"]),b(m,{key:"move2target",title:o.$t("moveTo")},{default:S(()=>[(a(!0),f(V,null,J(F(t).quickMovePaths,P=>(a(),R(c,{key:`move-to-${P.dir}`},{default:S(()=>[k(p(P.zh),1)]),_:2},1024))),128))]),_:1},8,["title"]),b(g),o.isSelectedMutilFiles?(a(),f(V,{key:1},[b(m,{key:"batch-add-tag",title:o.$t("batchAddTag")},{default:S(()=>[b(c,{key:"add-custom-tag"},{default:S(()=>[k("+ "+p(o.$t("addNewCustomTag")),1)]),_:1}),(a(!0),f(V,null,J(r.value,P=>(a(),R(c,{key:`batch-add-tag-${P.id}`},{default:S(()=>[k(p(P.name),1)]),_:2},1024))),128))]),_:1},8,["title"]),b(m,{key:"batch-remove-tag",title:o.$t("batchRemoveTag")},{default:S(()=>[(a(!0),f(V,null,J(r.value,P=>(a(),R(c,{key:`batch-remove-tag-${P.id}`},{default:S(()=>[k(p(P.name),1)]),_:2},1024))),128))]),_:1},8,["title"])],64)):(a(),R(m,{key:"toggle-tag",title:o.$t("toggleTag")},{default:S(()=>[b(c,{key:"add-custom-tag"},{default:S(()=>[k("+ "+p(o.$t("addNewCustomTag")),1)]),_:1}),(a(!0),f(V,null,J(r.value,P=>(a(),R(c,{key:`toggle-tag-${P.id}`},{default:S(()=>[k(p(P.name)+" ",1),P.selected?(a(),R(F(rt),{key:0})):(a(),R(F(ot),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"])),b(g),b(c,{key:"openFileLocationInNewTab"},{default:S(()=>[k(p(o.$t("openFileLocationInNewTab")),1)]),_:1}),b(c,{key:"openWithLocalFileBrowser"},{default:S(()=>[k(p(o.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):A("",!0),b(g),b(c,{key:"rename"},{default:S(()=>[k(p(o.$t("rename")),1)]),_:1}),b(c,{key:"previewInNewWindow"},{default:S(()=>[k(p(o.$t("previewInNewWindow")),1)]),_:1}),b(c,{key:"download"},{default:S(()=>[k(p(o.$t("download")),1)]),_:1}),b(c,{key:"copyPreviewUrl"},{default:S(()=>[k(p(o.$t("copySourceFilePreviewLink")),1)]),_:1}),b(c,{key:"copyFilePath"},{default:S(()=>[k(p(o.$t("copyFilePath")),1)]),_:1})],64)):A("",!0)]}),_:1})}}}),z=i=>(Ze("data-v-78cd67a3"),i=i(),Xe(),i),gi={class:"changeIndicatorWrapper"},pi={key:0,class:"changeIndicatorsLeft changeIndicators"},vi={key:0,class:"promptChangeIndicator changeIndicator"},mi={key:1,class:"negpromptChangeIndicator changeIndicator"},yi={key:2,class:"seedChangeIndicator changeIndicator"},bi={key:3,class:"stepsChangeIndicator changeIndicator"},Ai={key:4,class:"cfgChangeIndicator changeIndicator"},Si={key:5,class:"sizeChangeIndicator changeIndicator"},ki={key:6,class:"modelChangeIndicator changeIndicator"},_i={key:7,class:"samplerChangeIndicator changeIndicator"},Ii={key:8,class:"otherChangeIndicator changeIndicator"},Ci={class:"hoverOverlay"},wi=z(()=>u("strong",null,"This file",-1)),Ti=z(()=>u("br",null,null,-1)),Ei=z(()=>u("br",null,null,-1)),Pi={key:0},Oi=z(()=>u("td",null,[u("span",{class:"promptChangeIndicator"},"+ Prompt")],-1)),Di={key:1},Ni=z(()=>u("td",null,[u("span",{class:"negpromptChangeIndicator"},"- Prompt")],-1)),zi={key:2},Qi=z(()=>u("td",null,[u("span",{class:"seedChangeIndicator"},"Seed")],-1)),Mi={key:3},$i=z(()=>u("td",null,[u("span",{class:"stepsChangeIndicator"},"Steps")],-1)),Bi={key:4},Fi=z(()=>u("td",null,[u("span",{class:"cfgChangeIndicator"},"Cfg Scale")],-1)),Ri={key:5},Li=z(()=>u("td",null,[u("span",{class:"sizeChangeIndicator"},"Size")],-1)),ji={key:6},Vi=z(()=>u("td",null,[u("span",{class:"modelChangeIndicator"},"Model")],-1)),xi=z(()=>u("br",null,null,-1)),Hi={key:7},Ui=z(()=>u("td",null,[u("span",{class:"samplerChangeIndicator"},"Sampler")],-1)),Ji=z(()=>u("br",null,null,-1)),Wi=z(()=>u("br",null,null,-1)),Ki={key:0},Gi=z(()=>u("span",{class:"otherChangeIndicator"},"Other",-1)),Yi=z(()=>u("br",null,null,-1)),qi=z(()=>u("br",null,null,-1)),Zi={key:1,class:"changeIndicatorsRight changeIndicators"},Xi={key:0,class:"promptChangeIndicator changeIndicator"},es={key:1,class:"negpromptChangeIndicator changeIndicator"},ts={key:2,class:"seedChangeIndicator changeIndicator"},ns={key:3,class:"stepsChangeIndicator changeIndicator"},is={key:4,class:"cfgChangeIndicator changeIndicator"},ss={key:5,class:"sizeChangeIndicator changeIndicator"},rs={key:6,class:"modelChangeIndicator changeIndicator"},os={key:7,class:"samplerChangeIndicator changeIndicator"},ls={key:8,class:"otherChangeIndicator changeIndicator"},as={class:"hoverOverlay"},us=z(()=>u("strong",null,"This file",-1)),ds=z(()=>u("br",null,null,-1)),cs=z(()=>u("br",null,null,-1)),fs={key:0},hs=z(()=>u("td",null,[u("span",{class:"promptChangeIndicator"},"+ Prompt")],-1)),gs={key:1},ps=z(()=>u("td",null,[u("span",{class:"negpromptChangeIndicator"},"- Prompt")],-1)),vs={key:2},ms=z(()=>u("td",null,[u("span",{class:"seedChangeIndicator"},"Seed")],-1)),ys={key:3},bs=z(()=>u("td",null,[u("span",{class:"stepsChangeIndicator"},"Steps")],-1)),As={key:4},Ss=z(()=>u("td",null,[u("span",{class:"cfgChangeIndicator"},"Cfg Scale")],-1)),ks={key:5},_s=z(()=>u("td",null,[u("span",{class:"sizeChangeIndicator"},"Size")],-1)),Is={key:6},Cs=z(()=>u("td",null,[u("span",{class:"modelChangeIndicator"},"Model")],-1)),ws=z(()=>u("br",null,null,-1)),Ts={key:7},Es=z(()=>u("td",null,[u("span",{class:"samplerChangeIndicator"},"Sampler")],-1)),Ps=z(()=>u("br",null,null,-1)),Os=z(()=>u("br",null,null,-1)),Ds={key:0},Ns=z(()=>u("span",{class:"otherChangeIndicator"},"Other",-1)),zs=z(()=>u("br",null,null,-1)),Qs=z(()=>u("br",null,null,-1)),Ms=Z({__name:"ChangeIndicator",props:{genDiffToPrevious:{},genDiffToNext:{},genInfo:{}},setup(i){function n(t){const r=["prompt","negativePrompt","seed","steps","cfgScale","size","Model","others"],o=Object.keys(t).filter(h=>!r.includes(h));return Object.fromEntries(o.map(h=>[h,t[h]]))}function e(t){return Object.keys(n(t)).length>0}return(t,r)=>(a(),f("div",gi,[t.genDiffToPrevious.empty?A("",!0):(a(),f("div",pi,["prompt"in t.genDiffToPrevious.diff?(a(),f("div",vi,"P+")):A("",!0),"negativePrompt"in t.genDiffToPrevious.diff?(a(),f("div",mi,"P-")):A("",!0),"seed"in t.genDiffToPrevious.diff?(a(),f("div",yi,"Se")):A("",!0),"steps"in t.genDiffToPrevious.diff?(a(),f("div",bi,"St")):A("",!0),"cfgScale"in t.genDiffToPrevious.diff?(a(),f("div",Ai,"Cf")):A("",!0),"size"in t.genDiffToPrevious.diff?(a(),f("div",Si,"Si")):A("",!0),"Model"in t.genDiffToPrevious.diff?(a(),f("div",ki,"Mo")):A("",!0),"Sampler"in t.genDiffToPrevious.diff?(a(),f("div",_i,"Sa")):A("",!0),e(t.genDiffToPrevious.diff)?(a(),f("div",Ii,"Ot")):A("",!0)])),u("div",Ci,[u("small",null,[b(F(Le)),wi,k(" vs "+p(t.genDiffToPrevious.otherFile)+" ",1),Ti,Ei,u("table",null,["prompt"in t.genDiffToPrevious.diff?(a(),f("tr",Pi,[Oi,u("td",null,p(t.genDiffToPrevious.diff.prompt)+" tokens changed",1)])):A("",!0),"negativePrompt"in t.genDiffToPrevious.diff?(a(),f("tr",Di,[Ni,u("td",null,p(t.genDiffToPrevious.diff.negativePrompt)+" tokens changed",1)])):A("",!0),"seed"in t.genDiffToPrevious.diff?(a(),f("tr",zi,[Qi,u("td",null,[u("strong",null,p(t.genDiffToPrevious.diff.seed[0]),1),k(" vs "+p(t.genDiffToPrevious.diff.seed[1]),1)])])):A("",!0),"steps"in t.genDiffToPrevious.diff?(a(),f("tr",Mi,[$i,u("td",null,[u("strong",null,p(t.genDiffToPrevious.diff.steps[0]),1),k(" vs "+p(t.genDiffToPrevious.diff.steps[1]),1)])])):A("",!0),"cfgScale"in t.genDiffToPrevious.diff?(a(),f("tr",Bi,[Fi,u("td",null,[u("strong",null,p(t.genDiffToPrevious.diff.cfgScale[0]),1),k(" vs "+p(t.genDiffToPrevious.diff.cfgScale[1]),1)])])):A("",!0),"size"in t.genDiffToPrevious.diff?(a(),f("tr",Ri,[Li,u("td",null,[u("strong",null,p(t.genDiffToPrevious.diff.size[0]),1),k(" vs "+p(t.genDiffToPrevious.diff.size[1]),1)])])):A("",!0),"Model"in t.genDiffToPrevious.diff?(a(),f("tr",ji,[Vi,u("td",null,[u("strong",null,p(t.genDiffToPrevious.diff.Model[0]),1),xi,k(" vs "+p(t.genDiffToPrevious.diff.Model[1]),1)])])):A("",!0),"Sampler"in t.genDiffToPrevious.diff?(a(),f("tr",Hi,[Ui,u("td",null,[u("strong",null,p(t.genDiffToPrevious.diff.Sampler[0]),1),Ji,k(" vs "+p(t.genDiffToPrevious.diff.Sampler[1]),1)])])):A("",!0)]),Wi,e(t.genDiffToPrevious.diff)?(a(),f("div",Ki,[Gi,k(" props that changed:"),Yi,qi,u("ul",null,[(a(!0),f(V,null,J(n(t.genDiffToPrevious.diff),(o,h)=>(a(),f("li",null,p(h),1))),256))])])):A("",!0)])]),t.genDiffToNext.empty?A("",!0):(a(),f("div",Zi,["prompt"in t.genDiffToNext.diff?(a(),f("div",Xi,"P+")):A("",!0),"negativePrompt"in t.genDiffToNext.diff?(a(),f("div",es,"P-")):A("",!0),"seed"in t.genDiffToNext.diff?(a(),f("div",ts,"Se")):A("",!0),"steps"in t.genDiffToNext.diff?(a(),f("div",ns,"St")):A("",!0),"cfgScale"in t.genDiffToNext.diff?(a(),f("div",is,"Cf")):A("",!0),"size"in t.genDiffToNext.diff?(a(),f("div",ss,"Si")):A("",!0),"Model"in t.genDiffToNext.diff?(a(),f("div",rs,"Mo")):A("",!0),"Sampler"in t.genDiffToNext.diff?(a(),f("div",os,"Sa")):A("",!0),e(t.genDiffToNext.diff)?(a(),f("div",ls,"Ot")):A("",!0)])),u("div",as,[u("small",null,[b(F(Le)),us,k(" vs "+p(t.genDiffToNext.otherFile)+" ",1),ds,cs,u("table",null,["prompt"in t.genDiffToNext.diff?(a(),f("tr",fs,[hs,u("td",null,p(t.genDiffToNext.diff.prompt)+" tokens changed",1)])):A("",!0),"negativePrompt"in t.genDiffToNext.diff?(a(),f("tr",gs,[ps,u("td",null,p(t.genDiffToNext.diff.negativePrompt)+" tokens changed",1)])):A("",!0),"seed"in t.genDiffToNext.diff?(a(),f("tr",vs,[ms,u("td",null,[u("strong",null,p(t.genDiffToNext.diff.seed[0]),1),k(" vs "+p(t.genDiffToNext.diff.seed[1]),1)])])):A("",!0),"steps"in t.genDiffToNext.diff?(a(),f("tr",ys,[bs,u("td",null,[u("strong",null,p(t.genDiffToNext.diff.steps[0]),1),k(" vs "+p(t.genDiffToNext.diff.steps[1]),1)])])):A("",!0),"cfgScale"in t.genDiffToNext.diff?(a(),f("tr",As,[Ss,u("td",null,[u("strong",null,p(t.genDiffToNext.diff.cfgScale[0]),1),k(" vs "+p(t.genDiffToNext.diff.cfgScale[1]),1)])])):A("",!0),"size"in t.genDiffToNext.diff?(a(),f("tr",ks,[_s,u("td",null,[u("strong",null,p(t.genDiffToNext.diff.size[0]),1),k(" vs "+p(t.genDiffToNext.diff.size[1]),1)])])):A("",!0),"Model"in t.genDiffToNext.diff?(a(),f("tr",Is,[Cs,u("td",null,[u("strong",null,p(t.genDiffToNext.diff.Model[0]),1),ws,k(" vs "+p(t.genDiffToNext.diff.Model[1]),1)])])):A("",!0),"Sampler"in t.genDiffToNext.diff?(a(),f("tr",Ts,[Es,u("td",null,[u("strong",null,p(t.genDiffToNext.diff.Sampler[0]),1),Ps,k(" vs "+p(t.genDiffToNext.diff.Sampler[1]),1)])])):A("",!0)]),Os,e(t.genDiffToNext.diff)?(a(),f("div",Ds,[Ns,k(" props that changed:"),zs,Qs,u("ul",null,[(a(!0),f(V,null,J(n(t.genDiffToNext.diff),(o,h)=>(a(),f("li",null,p(h),1))),256))])])):A("",!0)])])]))}});const $s=st(Ms,[["__scopeId","data-v-78cd67a3"]]),Bs=["data-idx"],Fs={key:1,class:"more"},Rs={class:"float-btn-wrap"},Ls={key:1,class:"tags-container"},js=["url"],Vs={class:"play-icon"},xs=["src"],Hs={key:0,class:"tags-container"},Us={key:4,class:"preview-icon-wrap"},Js={key:1,class:"dir-cover-container"},Ws=["src"],Ks={key:5,class:"profile"},Gs=["title"],Ys={class:"basic-info"},qs={style:{"margin-right":"4px"}},he=160,Zs=Z({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1},isSelectedMutilFiles:{type:Boolean},genInfo:{},enableChangeIndicator:{type:Boolean},extraTags:{},coverFiles:{},getGenDiff:{},getGenDiffWatchDep:{}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click","tiktokView"],setup(i,{emit:n}){const e=i;Kt(s=>({"4e1457c0":s.$props.cellWidth+"px"}));const t=_e(),r=Ye(),o=j(),h=j(),c=pe(()=>{const{getGenDiff:s,file:d,idx:w}=e;s&&(h.value=s(d.gen_info_obj,w,1,d),o.value=s(d.gen_info_obj,w,-1,d))},200+100*Math.random());re(()=>{var s;return(s=e.getGenDiffWatchDep)==null?void 0:s.call(e,e.idx)},()=>{c()},{immediate:!0,deep:!0});const g=x(()=>r.tagMap.get(e.file.fullpath)??[]),m=x(()=>{const s=t.gridThumbnailResolution;return t.enableThumbnail?Qe(e.file,[s,s].join("x")):Gt(e.file)}),E=x(()=>{var s;return(((s=t.conf)==null?void 0:s.all_custom_tags)??[]).reduce((d,w)=>[...d,{...w,selected:!!g.value.find(O=>O.id===w.id)}],[])}),C=x(()=>E.value.find(s=>s.type==="custom"&&s.name==="like")),P=()=>{ge(C.value),n("contextMenuClick",{key:`toggle-tag-${C.value.id}`},e.file,e.idx)},Q=s=>{t.magicSwitchTiktokView&&e.file.type==="file"&&Me(e.file.name)?(n("tiktokView",e.file,e.idx),setTimeout(()=>{tn()},500)):n("fileItemClick",s,e.file,e.idx)},l=()=>{t.magicSwitchTiktokView?n("tiktokView",e.file,e.idx):nn(e.file,s=>n("contextMenuClick",{key:`toggle-tag-${s}`},e.file,e.idx),()=>n("tiktokView",e.file,e.idx))};return(s,d)=>{const w=Y,O=nt,M=it,v=sn,I=cn;return a(),R(w,{trigger:["contextmenu"],visible:F(t).longPressOpenContextMenu?typeof s.idx=="number"&&s.showMenuIdx===s.idx:void 0,"onUpdate:visible":d[7]||(d[7]=T=>typeof s.idx=="number"&&n("update:showMenuIdx",T?s.idx:-1))},{overlay:S(()=>[s.enableRightClickMenu?(a(),R(Ue,{key:0,file:s.file,idx:s.idx,"selected-tag":g.value,onContextMenuClick:d[6]||(d[6]=(T,y,N)=>n("contextMenuClick",T,y,N)),"is-selected-mutil-files":s.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])):A("",!0)]),default:S(()=>{var T;return[(a(),f("li",{class:K(["file file-item-trigger grid",{clickable:s.file.type==="dir",selected:s.selected}]),"data-idx":s.idx,key:s.file.name,draggable:"true",onDragstart:d[3]||(d[3]=y=>n("dragstart",y,s.idx)),onDragend:d[4]||(d[4]=y=>n("dragend",y,s.idx)),onClickCapture:d[5]||(d[5]=y=>Q(y))},[u("div",null,[s.enableCloseIcon?(a(),f("div",{key:0,class:"close-icon",onClick:d[0]||(d[0]=y=>n("close-icon-click"))},[b(F(Yt))])):A("",!0),s.enableRightClickMenu?(a(),f("div",Fs,[b(w,null,{overlay:S(()=>[b(Ue,{file:s.file,idx:s.idx,"selected-tag":g.value,onContextMenuClick:d[1]||(d[1]=(y,N,B)=>n("contextMenuClick",y,N,B)),"is-selected-mutil-files":s.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])]),default:S(()=>[u("div",Rs,[b(F(qt))])]),_:1}),s.file.type==="file"?(a(),R(w,{key:0},{overlay:S(()=>[E.value.length>1?(a(),R(M,{key:0,onClick:d[2]||(d[2]=y=>n("contextMenuClick",y,s.file,s.idx))},{default:S(()=>[(a(!0),f(V,null,J(E.value,y=>(a(),R(O,{key:`toggle-tag-${y.id}`},{default:S(()=>[k(p(y.name)+" ",1),y.selected?(a(),R(F(rt),{key:0})):(a(),R(F(ot),{key:1}))]),_:2},1024))),128))]),_:1})):A("",!0)]),default:S(()=>{var y,N;return[u("div",{class:K(["float-btn-wrap",{"like-selected":(y=C.value)==null?void 0:y.selected}]),onClick:P},[(N=C.value)!=null&&N.selected?(a(),R(F(Zt),{key:0})):(a(),R(F(Xt),{key:1}))],2)]}),_:1})):A("",!0)])):A("",!0),F(Me)(s.file.name)?(a(),f("div",{key:s.file.fullpath,class:K(`idx-${s.idx} item-content`)},[s.enableChangeIndicator&&h.value&&o.value?(a(),R($s,{key:0,"gen-diff-to-next":h.value,"gen-diff-to-previous":o.value},null,8,["gen-diff-to-next","gen-diff-to-previous"])):A("",!0),b(v,{src:m.value,fallback:F(On),preview:{src:s.fullScreenPreviewImageUrl,onVisibleChange:(y,N)=>n("previewVisibleChange",y,N)}},null,8,["src","fallback","preview"]),g.value&&s.cellWidth>he?(a(),f("div",Ls,[(a(!0),f(V,null,J(s.extraTags??g.value,y=>(a(),R(I,{key:y.id,color:F(r).getColor(y)},{default:S(()=>[k(p(y.name),1)]),_:2},1032,["color"]))),128))])):A("",!0)],2)):F(en)(s.file.name)?(a(),f("div",{key:3,class:K(`idx-${s.idx} item-content video`),url:F(ce)(s.file),style:tt({"background-image":`url('${s.file.cover_url??F(ce)(s.file)}')`}),onClick:l},[u("div",Vs,[u("img",{src:F(Fn),style:{width:"40px",height:"40px"}},null,8,xs)]),g.value&&s.cellWidth>he?(a(),f("div",Hs,[(a(!0),f(V,null,J(g.value,y=>(a(),R(I,{key:y.id,color:F(r).getColor(y)},{default:S(()=>[k(p(y.name),1)]),_:2},1032,["color"]))),128))])):A("",!0)],14,js)):(a(),f("div",Us,[s.file.type==="file"?(a(),R(F(yn),{key:0,class:"icon center"})):(T=s.coverFiles)!=null&&T.length&&s.cellWidth>160?(a(),f("div",Js,[(a(!0),f(V,null,J(s.coverFiles,y=>(a(),f("img",{class:"dir-cover-item",src:y.media_type==="image"?F(Qe)(y):F(ce)(y),key:y.fullpath},null,8,Ws))),128))])):(a(),R(F(kn),{key:2,class:"icon center"}))])),s.cellWidth>he?(a(),f("div",Ks,[u("div",{class:"name line-clamp-1",title:s.file.name},p(s.file.name),9,Gs),u("div",Ys,[u("div",qs,p(s.file.type)+" "+p(s.file.size),1),u("div",null,p(s.file.date),1)])])):A("",!0)])],42,Bs))]}),_:1},8,["visible"])}}});const pr=st(Zs,[["__scopeId","data-v-df1fd2e5"]]);export{pr as F,rr as N,Ue as _,or as a,gr as b,hr as c,ft as d,fr as e,Rn as f,G as g,ur as h,cr as i,ar as j,dr as k,Pn as r,lr as s,jn as t,le as u};
