import{d as me,m as z,az as ge,a1 as fe,U as p,V as I,c as s,a4 as e,a3 as n,a6 as B,W as d,L as ke,Y as o,X as u,a2 as G,af as ve,aS as he,$ as w,ag as N,ai as Ie,T as we,ak as U,aP as Ce,aQ as _e,bD as Se,a0 as be}from"./index-4c34d886.js";import{S as xe}from"./index-c14d66e4.js";import{o as L,L as ye,R as Me,f as Ae,M as Te}from"./MultiSelectKeep-9fc086fd.js";import{c as Ve,d as $e,F as De}from"./FileItem-b79fa0a8.js";import{c as Fe,u as Re}from"./hook-0941e015.js";import"./shortcut-c3286a1a.js";import"./Checkbox-818febf1.js";/* empty css              */import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-1da329eb.js";import"./index-1e9959a9.js";import"./index-801ff9bd.js";import"./_isIterateeCall-01eb9d10.js";import"./useGenInfoDiff-204d130e.js";const ze=r=>(Ce("data-v-4ee34070"),r=r(),_e(),r),Be={class:"hint"},Ge={class:"action-bar"},Ne=ze(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Ue={key:1},Le={class:"no-res-hint"},Pe={class:"hint"},Ee={key:2,class:"preview-switch"},Je=me({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},selectedTagIds:{},id:{}},setup(r){const g=r,f=Fe(t=>Se(g.selectedTagIds,t)),{queue:P,images:i,onContextMenuClickU:C,stackViewEl:E,previewIdx:c,previewing:_,onPreviewVisibleChange:J,previewImgMove:S,canPreview:b,itemSize:x,gridItems:W,showGenInfo:m,imageGenInfo:y,q:K,multiSelectedIdxs:k,onFileItemClick:O,scroller:M,showMenuIdx:v,onFileDragStart:q,onFileDragEnd:Q,cellWidth:X,onScroll:A,saveAllFileAsJson:Y,props:j,saveLoadedFileAsJson:H,changeIndchecked:Z,seedChangeChecked:ee,getGenDiff:te,getGenDiffWatchDep:le}=Re(f);z(()=>g.selectedTagIds,async()=>{var t;await f.reset(),await ge(),(t=M.value)==null||t.scrollToItem(0),A()},{immediate:!0}),z(()=>g,async t=>{j.value=t},{deep:!0,immediate:!0});const T=fe(),{onClearAllSelected:ie,onSelectAll:se,onReverseSelect:ne}=Ve(),ae=()=>{i.value.length!==0&&L(i.value,0)};return(t,l)=>{const oe=Te,de=Ie,re=we,h=U,ce=U,pe=xe;return p(),I("div",{class:"container",ref_key:"stackViewEl",ref:E},[s(oe,{show:!!e(k).length||e(T).keepMultiSelect,onClearAllSelected:e(ie),onSelectAll:e(se),onReverseSelect:e(ne)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),s(pe,{size:"large",spinning:!e(P).isIdle},{default:n(()=>{var V,$,D;return[s(re,{visible:e(m),"onUpdate:visible":l[1]||(l[1]=a=>B(m)?m.value=a:null),width:"70vw","mask-closable":"",onOk:l[2]||(l[2]=a=>m.value=!1)},{cancelText:n(()=>[]),default:n(()=>[s(de,{active:"",loading:!e(K).isIdle},{default:n(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:l[0]||(l[0]=a=>e(ke)(e(y)))},[d("div",Be,o(t.$t("doubleClickToCopy")),1),u(" "+o(e(y)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Ge,[s(h,{onClick:ae,type:"primary",disabled:!((V=e(i))!=null&&V.length)},{default:n(()=>[u(o(t.$t("tiktokView")),1)]),_:1},8,["disabled"]),s(h,{onClick:e(H)},{default:n(()=>[u(o(t.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick"]),s(h,{onClick:e(Y)},{default:n(()=>[u(o(t.$t("saveAllAsJson")),1)]),_:1},8,["onClick"])]),($=e(i))!=null&&$.length?(p(),G(e($e),{key:0,ref_key:"scroller",ref:M,class:"file-list",items:e(i),"item-size":e(x).first,"key-field":"fullpath","item-secondary-size":e(x).second,gridItems:e(W),onScroll:e(A)},{after:n(()=>[Ne]),default:n(({item:a,index:F})=>[s(De,{idx:F,file:a,"cell-width":e(X),"show-menu-idx":e(v),"onUpdate:showMenuIdx":l[3]||(l[3]=R=>B(v)?v.value=R:null),onDragstart:e(q),onDragend:e(Q),onFileItemClick:e(O),onTiktokView:(R,ue)=>e(L)(e(i),ue),"full-screen-preview-image-url":e(i)[e(c)]?e(ve)(e(i)[e(c)]):"",selected:e(k).includes(F),onContextMenuClick:e(C),onPreviewVisibleChange:e(J),"is-selected-mutil-files":e(k).length>1,"enable-change-indicator":e(Z),"seed-change-checked":e(ee),"get-gen-diff":e(te),"get-gen-diff-watch-dep":e(le)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):e(f).load&&t.selectedTagIds.and_tags.length===1&&!((D=t.selectedTagIds.folder_paths_str)!=null&&D.trim())?(p(),I("div",Ue,[d("div",Le,[d("p",Pe,o(t.$t("tagSearchNoResultsMessage")),1),s(ce,{onClick:l[4]||(l[4]=a=>e(he)()),type:"primary"},{default:n(()=>[u(o(t.$t("rebuildImageIndex")),1)]),_:1})])])):w("",!0),e(_)&&!e(T).hideImageNavigationButtons?(p(),I("div",Ee,[s(e(ye),{onClick:l[5]||(l[5]=a=>e(S)("prev")),class:N({disable:!e(b)("prev")})},null,8,["class"]),s(e(Me),{onClick:l[6]||(l[6]=a=>e(S)("next")),class:N({disable:!e(b)("next")})},null,8,["class"])])):w("",!0)]}),_:1},8,["spinning"]),e(_)&&e(i)&&e(i)[e(c)]?(p(),G(Ae,{key:0,file:e(i)[e(c)],idx:e(c),onContextMenuClick:e(C)},null,8,["file","idx","onContextMenuClick"])):w("",!0)],512)}}});const it=be(Je,[["__scopeId","data-v-4ee34070"]]);export{it as default};
