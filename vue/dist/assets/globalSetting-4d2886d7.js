import{c as t,A as ie,d as L,a1 as E,r as G,m as de,n as Z,U as f,V as S,a3 as u,a4 as e,B as o,a2 as M,$ as R,W as m,Z as O,G as P,o as re,Y as g,aM as H,X as U,a8 as z,ac as F,aR as ce,z as N,ak as B,ah as pe,aj as Q,a0 as ee,aK as me,aS as he,J as ge,K as fe,aT as _e,aU as ve,ad as be,a6 as ke,ag as ye,a5 as q,a9 as we,aV as Ce,aW as Se,aX as Te,aY as $e,aO as Ie}from"./index-6c47ee34.js";import{_ as W,a as te,F as xe}from"./numInput-2704f41f.js";import"./index-34432e2f.js";/* empty css              *//* empty css              */import{_ as ae}from"./index-60632a00.js";import{g as Re,C as Ue}from"./shortcut-099a5f5f.js";import"./isArrayLikeObject-d927dae0.js";import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-8b933f81.js";import"./Checkbox-b2e83bba.js";var Me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};const Oe=Me;function X(y){for(var a=1;a<arguments.length;a++){var n=arguments[a]!=null?Object(arguments[a]):{},_=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(_=_.concat(Object.getOwnPropertySymbols(n).filter(function(w){return Object.getOwnPropertyDescriptor(n,w).enumerable}))),_.forEach(function(w){Pe(y,w,n[w])})}return y}function Pe(y,a,n){return a in y?Object.defineProperty(y,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):y[a]=n,y}var K=function(a,n){var _=X({},a,n.attrs);return t(ie,X({},_,{icon:Oe}),null)};K.displayName="DeleteOutlined";K.inheritAttrs=!1;const Y=K;const J="/infinite_image_browsing/fe-static/assets/sample-55dcafc6.webp",Ae=["width","height","src"],Ve=L({__name:"ImageSetting",setup(y){function a(w,h){return new Promise(b=>{const k=new Image;k.onload=()=>{const c=document.createElement("canvas");c.width=k.width*h,c.height=k.height*h,c.getContext("2d").drawImage(k,0,0,c.width,c.height),b(c.toDataURL())},k.src=w})}const n=E(),_=G("");return de(()=>[n.enableThumbnail,n.gridThumbnailResolution],Z(async()=>{n.enableThumbnail&&(_.value=await a(J,n.gridThumbnailResolution/1024))},300),{immediate:!0,deep:!0}),(w,h)=>{const b=te,k=ae;return f(),S(O,null,[t(b,{label:e(o)("defaultGridCellWidth")},{default:u(()=>[t(W,{min:64,max:1024,step:16,modelValue:e(n).defaultGridCellWidth,"onUpdate:modelValue":h[0]||(h[0]=c=>e(n).defaultGridCellWidth=c)},null,8,["modelValue"])]),_:1},8,["label"]),t(b,{label:e(o)("useThumbnailPreview")},{default:u(()=>[t(k,{checked:e(n).enableThumbnail,"onUpdate:checked":h[1]||(h[1]=c=>e(n).enableThumbnail=c)},null,8,["checked"])]),_:1},8,["label"]),e(n).enableThumbnail?(f(),M(b,{key:0,label:e(o)("thumbnailResolution")},{default:u(()=>[t(W,{modelValue:e(n).gridThumbnailResolution,"onUpdate:modelValue":h[2]||(h[2]=c=>e(n).gridThumbnailResolution=c),min:256,max:1024,step:64},null,8,["modelValue"])]),_:1},8,["label"])):R("",!0),t(b,{label:e(o)("livePreview")},{default:u(()=>[m("div",null,[m("img",{width:e(n).defaultGridCellWidth,height:e(n).defaultGridCellWidth,src:e(n).enableThumbnail?_.value:e(J)},null,8,Ae)])]),_:1},8,["label"]),t(b,{label:e(o)("defaultShowChangeIndicators")},{default:u(()=>[t(k,{checked:e(n).defaultChangeIndchecked,"onUpdate:checked":h[3]||(h[3]=c=>e(n).defaultChangeIndchecked=c)},null,8,["checked"])]),_:1},8,["label"]),e(n).defaultChangeIndchecked?(f(),M(b,{key:1,label:e(o)("defaultSeedAsChange")},{default:u(()=>[t(k,{checked:e(n).defaultSeedChangeChecked,"onUpdate:checked":h[4]||(h[4]=c=>e(n).defaultSeedChangeChecked=c)},null,8,["checked"])]),_:1},8,["label"])):R("",!0),t(b,{label:e(o)("previewMaskBackgroundOpacity")},{default:u(()=>[t(W,{min:0,max:1,step:.05,modelValue:e(n).previewBgOpacity,"onUpdate:modelValue":h[5]||(h[5]=c=>e(n).previewBgOpacity=c)},null,8,["modelValue"])]),_:1},8,["label"])],64)}}}),Fe={class:"auto-tag-settings"},We={class:"header"},ze={class:"description"},De={class:"actions"},Ne={class:"rules-list"},Be={class:"rule-header"},Le={class:"filters-list"},Ee={key:0,class:"empty-tip"},Ge=L({__name:"AutoTagSettings",setup(y){const a=G([]),n=E(),_=P(()=>{var r,T;return((T=(r=n.conf)==null?void 0:r.all_custom_tags)==null?void 0:T.filter(v=>v.type==="custom"))||[]}),w={value:r=>r.name,text:r=>r.display_name?`${r.display_name} : ${r.name}`:r.name};re(()=>{var T,v;const r=(v=(T=n.conf)==null?void 0:T.app_fe_setting)==null?void 0:v.auto_tag_rules;r&&(a.value=r)});const h=()=>{a.value.push({tag:"",filters:[]})},b=r=>{a.value.splice(r,1)},k=r=>{r.filters.push({field:"pos_prompt",operator:"contains",value:""})},c=(r,T)=>{r.filters.splice(T,1)},A=async()=>{try{await ce("auto_tag_rules",a.value),N.success(o("autoTag.saveSuccess")),n.conf&&n.conf.app_fe_setting&&(n.conf.app_fe_setting.auto_tag_rules=a.value)}catch(r){N.error(o("autoTag.saveFail")+": "+r)}},D=P(()=>[{label:o("autoTag.fields.posPrompt"),value:"pos_prompt"},{label:o("autoTag.fields.negPrompt"),value:"neg_prompt"},{label:o("autoTag.fields.model"),value:"Model"},{label:o("autoTag.fields.sampler"),value:"Sampler"},{label:o("autoTag.fields.size"),value:"Size"},{label:o("autoTag.fields.cfgScale"),value:"CFG scale"},{label:o("autoTag.fields.steps"),value:"Steps"},{label:o("autoTag.fields.seed"),value:"Seed"}]),V=P(()=>[{label:o("autoTag.operators.contains"),value:"contains"},{label:o("autoTag.operators.equals"),value:"equals"},{label:o("autoTag.operators.regex"),value:"regex"}]);return(r,T)=>{const v=B,s=pe,l=Q;return f(),S("div",Fe,[m("div",We,[m("div",ze,g(e(o)("autoTag.description")),1),m("div",De,[t(v,{type:"primary",onClick:h},{icon:u(()=>[t(e(H))]),default:u(()=>[U(" "+g(e(o)("autoTag.addRule")),1)]),_:1}),t(v,{type:"primary",onClick:A,style:{"margin-left":"16px"}},{default:u(()=>[U(g(e(o)("autoTag.saveConfig")),1)]),_:1})])]),m("div",Ne,[(f(!0),S(O,null,z(a.value,(p,$)=>(f(),S("div",{key:$,class:"rule-card"},[m("div",Be,[t(e(F),{conv:w,style:{width:"240px"},options:_.value,value:p.tag,"onUpdate:value":d=>p.tag=d,disabled:!_.value.length,placeholder:e(o)("autoTag.inputTagName")},null,8,["options","value","onUpdate:value","disabled","placeholder"]),t(v,{type:"text",danger:"",onClick:d=>b($)},{icon:u(()=>[t(e(Y))]),_:2},1032,["onClick"])]),m("div",Le,[(f(!0),S(O,null,z(p.filters,(d,C)=>(f(),S("div",{key:C,class:"filter-row"},[t(s,{value:d.field,"onUpdate:value":I=>d.field=I,style:{width:"240px"},options:D.value},null,8,["value","onUpdate:value","options"]),t(s,{value:d.operator,"onUpdate:value":I=>d.operator=I,style:{width:"160px"},options:V.value},null,8,["value","onUpdate:value","options"]),t(l,{value:d.value,"onUpdate:value":I=>d.value=I,placeholder:e(o)("autoTag.value"),style:{flex:"1"}},null,8,["value","onUpdate:value","placeholder"]),t(v,{type:"text",danger:"",onClick:I=>c(p,C)},{icon:u(()=>[t(e(Y))]),_:2},1032,["onClick"])]))),128)),t(v,{type:"dashed",block:"",onClick:d=>k(p),style:{"margin-top":"8px"}},{icon:u(()=>[t(e(H))]),default:u(()=>[U(" "+g(e(o)("autoTag.addFilter")),1)]),_:2},1032,["onClick"])])]))),128))]),a.value.length===0?(f(),S("div",Ee,g(e(o)("autoTag.noRules")),1)):R("",!0)])}}});const Ke=ee(Ge,[["__scopeId","data-v-a56a2d27"]]),je={class:"panel"},He={class:"lang-select-wrap"},qe={style:{"margin-top":"64px"}},Xe={style:{"margin-top":"64px"}},Ye={style:{"margin-left":"8px",color:"#666"}},Je={style:{"margin-top":"0"}},Ze={style:{"padding-left":"8px",color:"#666"}},Qe={class:"col"},et=L({__name:"globalSetting",setup(y){const a=E(),n=me(),_=G(!1),w=async()=>{window.location.reload()},h=[{value:"en",text:"English"},{value:"zhHans",text:"简体中文"},{value:"zhHant",text:"繁體中文"},{value:"de",text:"Deutsch"}],b=Z(s=>{const l=a.shortcut[s];["ctrl","shift"].includes(l.toLowerCase())&&(a.shortcut[s]="")},700),k=he(()=>{N.warn(o("notAllowSingleCtrlOrShiftAsShortcut"))},3e3),c=(s,l)=>{const p=Re(s);["ctrl","shift"].includes(p.toLowerCase())&&(k(),b(l)),p&&(a.shortcut[l]=p)},A=async()=>{await Ce("shutdown_api_server_command"),await Se.removeFile(Te),await $e()},D=P(()=>[{value:"empty",text:o("emptyStartPage")},{value:"last-workspace-state",text:o("restoreLastWorkspaceState")},...n.snapshots.map(l=>({value:`workspace_snapshot_${l.id}`,text:o("restoreWorkspaceSnapshot",[l.name])}))]),V=P(()=>{const s=a.shortcut,l={};return Object.entries(s).forEach(([p,$])=>{var d;l[d=$+""]??(l[d]=0),l[$+""]++}),l}),r=P(()=>{var l;const s=[{key:"download",label:o("download")},{key:"delete",label:o("deleteSelected")}];return(l=a.conf)==null||l.all_custom_tags.forEach(p=>{s.push({key:`toggle_tag_${p.name}`,label:o("toggleTagSelection",{tag:p.name})})}),a.quickMovePaths.forEach(p=>{s.push({key:`copy_to_${p.dir}`,label:o("copyTo")+" "+p.zh})}),a.quickMovePaths.forEach(p=>{s.push({key:`move_to_${p.dir}`,label:o("moveTo")+" "+p.zh})}),s}),T=s=>s&&s in V.value&&V.value[s]>1,v=ge(fe+"disable_maximize",!1);return(s,l)=>{var j;const p=Ie,$=B,d=te,C=ae,I=B,le=W,oe=Ue,ne=Q,se=xe;return f(),S("div",je,[(j=e(a).conf)!=null&&j.is_readonly?(f(),M(p,{key:0,message:s.$t("readonlyModeSettingPageDesc"),type:"warning"},null,8,["message"])):R("",!0),R("",!0),t(se,null,{default:u(()=>[t(d,{label:s.$t("lang")},{default:u(()=>[m("div",He,[t(e(F),{options:h,value:e(a).lang,"onUpdate:value":l[0]||(l[0]=i=>e(a).lang=i),onChange:l[1]||(l[1]=i=>_.value=!0)},null,8,["value"])]),_.value?(f(),M($,{key:0,type:"primary",onClick:w,ghost:""},{default:u(()=>[U(g(e(o)("langChangeReload")),1)]),_:1})):R("",!0)]),_:1},8,["label"]),m("h2",qe,g(e(o)("ImageBrowsingSettings")),1),t(Ve),m("h2",Xe,g(e(o)("autoTag.name")),1),t(Ke),m("h2",null,"TikTok "+g(e(o)("view")),1),t(d,{label:s.$t("showTiktokNavigator")},{default:u(()=>[t(C,{checked:e(a).showTiktokNavigator,"onUpdate:checked":l[2]||(l[2]=i=>e(a).showTiktokNavigator=i)},null,8,["checked"]),m("span",Ye,g(e(o)("showTiktokNavigatorDesc")),1)]),_:1},8,["label"]),m("h2",null,g(e(o)("imgSearch")),1),t(d,{label:s.$t("rebuildImageIndex")},{default:u(()=>[t(I,{onClick:e(_e)},{default:u(()=>[U(g(s.$t("start")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),m("h2",null,g(e(o)("autoRefresh")),1),t(d,{label:s.$t("autoRefreshWalkMode")},{default:u(()=>[t(C,{checked:e(a).autoRefreshWalkMode,"onUpdate:checked":l[3]||(l[3]=i=>e(a).autoRefreshWalkMode=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:s.$t("autoRefreshNormalFixedMode")},{default:u(()=>[t(C,{checked:e(a).autoRefreshNormalFixedMode,"onUpdate:checked":l[4]||(l[4]=i=>e(a).autoRefreshNormalFixedMode=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:e(o)("autoRefreshWalkModePosLimit")},{default:u(()=>[t(le,{min:0,max:1024,step:16,modelValue:e(a).autoRefreshWalkModePosLimit,"onUpdate:modelValue":l[5]||(l[5]=i=>e(a).autoRefreshWalkModePosLimit=i)},null,8,["modelValue"])]),_:1},8,["label"]),m("h2",Je,g(e(o)("other")),1),t(d,{label:s.$t("onlyFoldersAndImages")},{default:u(()=>[t(C,{checked:e(a).onlyFoldersAndImages,"onUpdate:checked":l[6]||(l[6]=i=>e(a).onlyFoldersAndImages=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:s.$t("showCommaInGenInfoPanel")},{default:u(()=>[t(C,{checked:e(a).showCommaInInfoPanel,"onUpdate:checked":l[7]||(l[7]=i=>e(a).showCommaInInfoPanel=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:s.$t("showRandomImageInStartup")},{default:u(()=>[t(C,{checked:e(a).showRandomImageInStartup,"onUpdate:checked":l[8]||(l[8]=i=>e(a).showRandomImageInStartup=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:s.$t("defaultSortingMethod")},{default:u(()=>[t(e(F),{value:e(a).defaultSortingMethod,"onUpdate:value":l[9]||(l[9]=i=>e(a).defaultSortingMethod=i),conv:e(ve),options:e(be)},null,8,["value","conv","options"])]),_:1},8,["label"]),t(d,{label:s.$t("longPressOpenContextMenu")},{default:u(()=>[t(C,{checked:e(a).longPressOpenContextMenu,"onUpdate:checked":l[10]||(l[10]=i=>e(a).longPressOpenContextMenu=i)},null,8,["checked"])]),_:1},8,["label"]),t(d,{label:s.$t("openOnAppStart")},{default:u(()=>[t(e(F),{value:e(a).defaultInitinalPage,"onUpdate:value":l[11]||(l[11]=i=>e(a).defaultInitinalPage=i),options:D.value},null,8,["value","options"])]),_:1},8,["label"]),(f(!0),S(O,null,z(e(a).ignoredConfirmActions,(i,x)=>(f(),M(d,{label:s.$t(x+"SkipConfirm"),key:x},{default:u(()=>[t(oe,{checked:e(a).ignoredConfirmActions[x],"onUpdate:checked":ue=>e(a).ignoredConfirmActions[x]=ue},null,8,["checked","onUpdate:checked"])]),_:2},1032,["label"]))),128)),t(d,{label:s.$t("disableMaximize")},{default:u(()=>[t(C,{checked:e(v),"onUpdate:checked":l[12]||(l[12]=i=>ke(v)?v.value=i:null)},null,8,["checked"]),m("sub",Ze,g(s.$t("takeEffectAfterReloadPage")),1)]),_:1},8,["label"]),m("h2",null,g(e(o)("shortcutKey")),1),(f(!0),S(O,null,z(r.value,i=>(f(),M(d,{label:i.label,key:i.key},{default:u(()=>[m("div",{class:ye(["col",{conflict:T(e(a).shortcut[i.key]+"")}]),onKeydown:l[13]||(l[13]=q(()=>{},["stop","prevent"]))},[t(ne,{value:e(a).shortcut[i.key],onKeydown:q(x=>c(x,i.key),["stop","prevent"]),placeholder:s.$t("shortcutKeyDescription")},null,8,["value","onKeydown","placeholder"]),t($,{onClick:x=>e(a).shortcut[i.key]="",class:"clear-btn"},{default:u(()=>[U(g(s.$t("clear")),1)]),_:2},1032,["onClick"])],34)]),_:2},1032,["label"]))),128)),e(we)?(f(),S(O,{key:0},[m("h2",null,g(e(o)("clientSpecificSettings")),1),t(d,null,{default:u(()=>[m("div",Qe,[t($,{onClick:A,class:"clear-btn"},{default:u(()=>[U(g(s.$t("initiateSoftwareStartupConfig")),1)]),_:1})])]),_:1})],64)):R("",!0)]),_:1})])}}});const ct=ee(et,[["__scopeId","data-v-806e9539"]]);export{ct as default};
