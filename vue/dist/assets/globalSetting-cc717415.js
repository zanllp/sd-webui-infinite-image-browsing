import{d as E,a1 as G,r as D,m as de,n as J,U as h,V as y,c as a,a4 as s,a5 as e,B as l,a3 as R,$ as x,W as g,Z as M,G as P,o as re,Y as p,aN as H,X as k,a9 as O,ad as A,aS as X,aT as ce,z,al as B,ai as pe,ak as Q,a0 as ee,aL as me,aU as ge,J as _e,K as he,aV as fe,aW as ve,ae as be,a7 as ke,ah as ye,a6 as Y,aa as Ce,aX as we,aY as Se,aZ as Te,a_ as $e,aP as Ie}from"./index-214c37f1.js";import{_ as N,a as ae,F as xe}from"./numInput-6dbdd468.js";import"./index-ed800624.js";/* empty css              *//* empty css              */import{_ as te}from"./index-fbb9b9b7.js";import"./index-89a840f7.js";import{g as Ue,C as Z,_ as Re}from"./shortcut-c70bb424.js";import"./isArrayLikeObject-f708a19c.js";import"./numInput.vue_vue_type_style_index_0_scoped_bd954eda_lang-3d61c006.js";import"./index-3237a2fe.js";import"./Checkbox-f143d30a.js";const j="/infinite_image_browsing/fe-static/assets/sample-55dcafc6.webp",Me=["width","height","src"],Pe=E({__name:"ImageSetting",setup(K){function o(U,_){return new Promise(v=>{const b=new Image;b.onload=()=>{const m=document.createElement("canvas");m.width=b.width*_,m.height=b.height*_,m.getContext("2d").drawImage(b,0,0,m.width,m.height),v(m.toDataURL())},b.src=U})}const i=G(),T=D("");return de(()=>[i.enableThumbnail,i.gridThumbnailResolution],J(async()=>{i.enableThumbnail&&(T.value=await o(j,i.gridThumbnailResolution/1024))},300),{immediate:!0,deep:!0}),(U,_)=>{const v=ae,b=te;return h(),y(M,null,[a(v,{label:e(l)("defaultGridCellWidth")},{default:s(()=>[a(N,{min:64,max:1024,step:16,modelValue:e(i).defaultGridCellWidth,"onUpdate:modelValue":_[0]||(_[0]=m=>e(i).defaultGridCellWidth=m)},null,8,["modelValue"])]),_:1},8,["label"]),a(v,{label:e(l)("useThumbnailPreview")},{default:s(()=>[a(b,{checked:e(i).enableThumbnail,"onUpdate:checked":_[1]||(_[1]=m=>e(i).enableThumbnail=m)},null,8,["checked"])]),_:1},8,["label"]),e(i).enableThumbnail?(h(),R(v,{key:0,label:e(l)("thumbnailResolution")},{default:s(()=>[a(N,{modelValue:e(i).gridThumbnailResolution,"onUpdate:modelValue":_[2]||(_[2]=m=>e(i).gridThumbnailResolution=m),min:256,max:1024,step:64},null,8,["modelValue"])]),_:1},8,["label"])):x("",!0),a(v,{label:e(l)("livePreview")},{default:s(()=>[g("div",null,[g("img",{width:e(i).defaultGridCellWidth,height:e(i).defaultGridCellWidth,src:e(i).enableThumbnail?T.value:e(j)},null,8,Me)])]),_:1},8,["label"]),a(v,{label:e(l)("defaultShowChangeIndicators")},{default:s(()=>[a(b,{checked:e(i).defaultChangeIndchecked,"onUpdate:checked":_[3]||(_[3]=m=>e(i).defaultChangeIndchecked=m)},null,8,["checked"])]),_:1},8,["label"]),e(i).defaultChangeIndchecked?(h(),R(v,{key:1,label:e(l)("defaultSeedAsChange")},{default:s(()=>[a(b,{checked:e(i).defaultSeedChangeChecked,"onUpdate:checked":_[4]||(_[4]=m=>e(i).defaultSeedChangeChecked=m)},null,8,["checked"])]),_:1},8,["label"])):x("",!0),a(v,{label:e(l)("previewMaskBackgroundOpacity")},{default:s(()=>[a(N,{min:0,max:1,step:.05,modelValue:e(i).previewBgOpacity,"onUpdate:modelValue":_[5]||(_[5]=m=>e(i).previewBgOpacity=m)},null,8,["modelValue"])]),_:1},8,["label"])],64)}}}),Fe={class:"auto-tag-settings"},Ve={class:"header"},We={class:"description"},Ae={class:"actions"},Ne={class:"rules-list"},Oe={class:"rule-header"},Le={class:"filters-list"},ze={key:0,class:"empty-tip"},Be=E({__name:"AutoTagSettings",setup(K){const o=D([]),i=G(),T=P(()=>{var r,C;return((C=(r=i.conf)==null?void 0:r.all_custom_tags)==null?void 0:C.filter(f=>f.type==="custom"))||[]}),U={value:r=>r.name,text:r=>r.display_name?`${r.display_name} : ${r.name}`:r.name};re(()=>{var C,f;const r=(f=(C=i.conf)==null?void 0:C.app_fe_setting)==null?void 0:f.auto_tag_rules;r&&(o.value=r)});const _=()=>{o.value.push({tag:"",filters:[]})},v=r=>{o.value.splice(r,1)},b=r=>{r.filters.push({field:"pos_prompt",operator:"contains",value:""})},m=(r,C)=>{r.filters.splice(C,1)},F=async()=>{try{await ce("auto_tag_rules",o.value),z.success(l("autoTag.saveSuccess")),i.conf&&i.conf.app_fe_setting&&(i.conf.app_fe_setting.auto_tag_rules=o.value)}catch(r){z.error(l("autoTag.saveFail")+": "+r)}},L=P(()=>[{label:l("autoTag.fields.posPrompt"),value:"pos_prompt"},{label:l("autoTag.fields.negPrompt"),value:"neg_prompt"},{label:l("autoTag.fields.model"),value:"Model"},{label:l("autoTag.fields.sampler"),value:"Sampler"},{label:l("autoTag.fields.size"),value:"Size"},{label:l("autoTag.fields.cfgScale"),value:"CFG scale"},{label:l("autoTag.fields.steps"),value:"Steps"},{label:l("autoTag.fields.seed"),value:"Seed"}]),V=P(()=>[{label:l("autoTag.operators.contains"),value:"contains"},{label:l("autoTag.operators.equals"),value:"equals"},{label:l("autoTag.operators.regex"),value:"regex"}]);return(r,C)=>{const f=B,n=pe,t=Q;return h(),y("div",Fe,[g("div",Ve,[g("div",We,p(e(l)("autoTag.description")),1),g("div",Ae,[a(f,{type:"primary",onClick:_},{icon:s(()=>[a(e(H))]),default:s(()=>[k(" "+p(e(l)("autoTag.addRule")),1)]),_:1}),a(f,{type:"primary",onClick:F,style:{"margin-left":"16px"}},{default:s(()=>[k(p(e(l)("autoTag.saveConfig")),1)]),_:1})])]),g("div",Ne,[(h(!0),y(M,null,O(o.value,(c,S)=>(h(),y("div",{key:S,class:"rule-card"},[g("div",Oe,[a(e(A),{conv:U,style:{width:"240px"},options:T.value,value:c.tag,"onUpdate:value":d=>c.tag=d,disabled:!T.value.length,placeholder:e(l)("autoTag.inputTagName")},null,8,["options","value","onUpdate:value","disabled","placeholder"]),a(f,{type:"text",danger:"",onClick:d=>v(S)},{icon:s(()=>[a(e(X))]),_:2},1032,["onClick"])]),g("div",Le,[(h(!0),y(M,null,O(c.filters,(d,w)=>(h(),y("div",{key:w,class:"filter-row"},[a(n,{value:d.field,"onUpdate:value":$=>d.field=$,style:{width:"240px"},options:L.value},null,8,["value","onUpdate:value","options"]),a(n,{value:d.operator,"onUpdate:value":$=>d.operator=$,style:{width:"160px"},options:V.value},null,8,["value","onUpdate:value","options"]),a(t,{value:d.value,"onUpdate:value":$=>d.value=$,placeholder:e(l)("autoTag.value"),style:{flex:"1"}},null,8,["value","onUpdate:value","placeholder"]),a(f,{type:"text",danger:"",onClick:$=>m(c,w)},{icon:s(()=>[a(e(X))]),_:2},1032,["onClick"])]))),128)),a(f,{type:"dashed",block:"",onClick:d=>b(c),style:{"margin-top":"8px"}},{icon:s(()=>[a(e(H))]),default:s(()=>[k(" "+p(e(l)("autoTag.addFilter")),1)]),_:2},1032,["onClick"])])]))),128))]),o.value.length===0?(h(),y("div",ze,p(e(l)("autoTag.noRules")),1)):x("",!0)])}}});const Ee=ee(Be,[["__scopeId","data-v-5bd94ce6"]]),Ge={class:"panel"},De={class:"lang-select-wrap"},Ke={style:{"margin-top":"64px"}},qe={style:{"margin-top":"64px"}},He={style:{"margin-left":"8px",color:"#666"}},Xe={style:{"margin-top":"0"}},Ye={style:{"padding-left":"8px",color:"#666"}},Ze={class:"col"},je=E({__name:"globalSetting",setup(K){const o=G(),i=me(),T=D(!1),U=async()=>{window.location.reload()},_=[{value:"en",text:"English"},{value:"zhHans",text:"简体中文"},{value:"zhHant",text:"繁體中文"},{value:"de",text:"Deutsch"}],v=J(n=>{const t=o.shortcut[n];["ctrl","shift"].includes(t.toLowerCase())&&(o.shortcut[n]="")},700),b=ge(()=>{z.warn(l("notAllowSingleCtrlOrShiftAsShortcut"))},3e3),m=(n,t)=>{const c=Ue(n);["ctrl","shift"].includes(c.toLowerCase())&&(b(),v(t)),c&&(o.shortcut[t]=c)},F=async()=>{await we("shutdown_api_server_command"),await Se.removeFile(Te),await $e()},L=P(()=>[{value:"empty",text:l("emptyStartPage")},{value:"last-workspace-state",text:l("restoreLastWorkspaceState")},...i.snapshots.map(t=>({value:`workspace_snapshot_${t.id}`,text:l("restoreWorkspaceSnapshot",[t.name])}))]),V=P(()=>{const n=o.shortcut,t={};return Object.values(n).forEach(c=>{var S;t[S=c+""]??(t[S]=0),t[c+""]++}),t}),r=P(()=>{var t;const n=[{key:"download",label:l("download")},{key:"delete",label:l("deleteSelected")}];return(t=o.conf)==null||t.all_custom_tags.forEach(c=>{n.push({key:`toggle_tag_${c.name}`,label:l("toggleTagSelection",{tag:c.name})})}),o.quickMovePaths.forEach(c=>{n.push({key:`copy_to_${c.dir}`,label:l("copyTo")+" "+c.zh})}),o.quickMovePaths.forEach(c=>{n.push({key:`move_to_${c.dir}`,label:l("moveTo")+" "+c.zh})}),n}),C=n=>n&&n in V.value&&V.value[n]>1,f=_e(he+"disable_maximize",!1);return(n,t)=>{var q;const c=Ie,S=B,d=ae,w=te,$=B,le=N,W=Z,oe=Re,ne=Z,se=Q,ue=xe;return h(),y("div",Ge,[(q=e(o).conf)!=null&&q.is_readonly?(h(),R(c,{key:0,message:n.$t("readonlyModeSettingPageDesc"),type:"warning"},null,8,["message"])):x("",!0),x("",!0),a(ue,null,{default:s(()=>[a(d,{label:n.$t("lang")},{default:s(()=>[g("div",De,[a(e(A),{options:_,value:e(o).lang,"onUpdate:value":t[0]||(t[0]=u=>e(o).lang=u),onChange:t[1]||(t[1]=u=>T.value=!0)},null,8,["value"])]),T.value?(h(),R(S,{key:0,type:"primary",onClick:U,ghost:""},{default:s(()=>[k(p(e(l)("langChangeReload")),1)]),_:1})):x("",!0)]),_:1},8,["label"]),g("h2",Ke,p(e(l)("ImageBrowsingSettings")),1),a(Pe),g("h2",qe,p(e(l)("autoTag.name")),1),a(Ee),g("h2",null,"TikTok "+p(e(l)("view")),1),a(d,{label:n.$t("showTiktokNavigator")},{default:s(()=>[a(w,{checked:e(o).showTiktokNavigator,"onUpdate:checked":t[2]||(t[2]=u=>e(o).showTiktokNavigator=u)},null,8,["checked"]),g("span",He,p(e(l)("showTiktokNavigatorDesc")),1)]),_:1},8,["label"]),g("h2",null,p(e(l)("imgSearch")),1),a(d,{label:n.$t("rebuildImageIndex")},{default:s(()=>[a($,{onClick:e(fe)},{default:s(()=>[k(p(n.$t("start")),1)]),_:1},8,["onClick"])]),_:1},8,["label"]),g("h2",null,p(e(l)("autoRefresh")),1),a(d,{label:n.$t("autoRefreshWalkMode")},{default:s(()=>[a(w,{checked:e(o).autoRefreshWalkMode,"onUpdate:checked":t[3]||(t[3]=u=>e(o).autoRefreshWalkMode=u)},null,8,["checked"])]),_:1},8,["label"]),a(d,{label:n.$t("autoRefreshNormalFixedMode")},{default:s(()=>[a(w,{checked:e(o).autoRefreshNormalFixedMode,"onUpdate:checked":t[4]||(t[4]=u=>e(o).autoRefreshNormalFixedMode=u)},null,8,["checked"])]),_:1},8,["label"]),a(d,{label:e(l)("autoRefreshWalkModePosLimit")},{default:s(()=>[a(le,{min:0,max:1024,step:16,modelValue:e(o).autoRefreshWalkModePosLimit,"onUpdate:modelValue":t[5]||(t[5]=u=>e(o).autoRefreshWalkModePosLimit=u)},null,8,["modelValue"])]),_:1},8,["label"]),g("h2",Xe,p(e(l)("other")),1),a(d,{label:n.$t("fileTypeFilter")},{default:s(()=>[a(oe,{value:e(o).fileTypeFilter,"onUpdate:value":t[6]||(t[6]=u=>e(o).fileTypeFilter=u)},{default:s(()=>[a(W,{value:"all"},{default:s(()=>[k(p(n.$t("allFiles")),1)]),_:1}),a(W,{value:"image"},{default:s(()=>[k(p(n.$t("image")),1)]),_:1}),a(W,{value:"video"},{default:s(()=>[k(p(n.$t("video")),1)]),_:1}),a(W,{value:"audio"},{default:s(()=>[k(p(n.$t("audio")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),a(d,{label:n.$t("showCommaInGenInfoPanel")},{default:s(()=>[a(w,{checked:e(o).showCommaInInfoPanel,"onUpdate:checked":t[7]||(t[7]=u=>e(o).showCommaInInfoPanel=u)},null,8,["checked"])]),_:1},8,["label"]),a(d,{label:n.$t("showRandomImageInStartup")},{default:s(()=>[a(w,{checked:e(o).showRandomImageInStartup,"onUpdate:checked":t[8]||(t[8]=u=>e(o).showRandomImageInStartup=u)},null,8,["checked"])]),_:1},8,["label"]),a(d,{label:n.$t("defaultSortingMethod")},{default:s(()=>[a(e(A),{value:e(o).defaultSortingMethod,"onUpdate:value":t[9]||(t[9]=u=>e(o).defaultSortingMethod=u),conv:e(ve),options:e(be)},null,8,["value","conv","options"])]),_:1},8,["label"]),a(d,{label:n.$t("longPressOpenContextMenu")},{default:s(()=>[a(w,{checked:e(o).longPressOpenContextMenu,"onUpdate:checked":t[10]||(t[10]=u=>e(o).longPressOpenContextMenu=u)},null,8,["checked"])]),_:1},8,["label"]),a(d,{label:n.$t("openOnAppStart")},{default:s(()=>[a(e(A),{value:e(o).defaultInitinalPage,"onUpdate:value":t[11]||(t[11]=u=>e(o).defaultInitinalPage=u),options:L.value},null,8,["value","options"])]),_:1},8,["label"]),(h(!0),y(M,null,O(e(o).ignoredConfirmActions,(u,I)=>(h(),R(d,{label:n.$t(I+"SkipConfirm"),key:I},{default:s(()=>[a(ne,{checked:e(o).ignoredConfirmActions[I],"onUpdate:checked":ie=>e(o).ignoredConfirmActions[I]=ie},null,8,["checked","onUpdate:checked"])]),_:2},1032,["label"]))),128)),a(d,{label:n.$t("disableMaximize")},{default:s(()=>[a(w,{checked:e(f),"onUpdate:checked":t[12]||(t[12]=u=>ke(f)?f.value=u:null)},null,8,["checked"]),g("sub",Ye,p(n.$t("takeEffectAfterReloadPage")),1)]),_:1},8,["label"]),g("h2",null,p(e(l)("shortcutKey")),1),(h(!0),y(M,null,O(r.value,u=>(h(),R(d,{label:u.label,key:u.key},{default:s(()=>[g("div",{class:ye(["col",{conflict:C(e(o).shortcut[u.key]+"")}]),onKeydown:t[13]||(t[13]=Y(()=>{},["stop","prevent"]))},[a(se,{value:e(o).shortcut[u.key],onKeydown:Y(I=>m(I,u.key),["stop","prevent"]),placeholder:n.$t("shortcutKeyDescription")},null,8,["value","onKeydown","placeholder"]),a(S,{onClick:I=>e(o).shortcut[u.key]="",class:"clear-btn"},{default:s(()=>[k(p(n.$t("clear")),1)]),_:2},1032,["onClick"])],34)]),_:2},1032,["label"]))),128)),e(Ce)?(h(),y(M,{key:0},[g("h2",null,p(e(l)("clientSpecificSettings")),1),a(d,null,{default:s(()=>[g("div",Ze,[a(S,{onClick:F,class:"clear-btn"},{default:s(()=>[k(p(n.$t("initiateSoftwareStartupConfig")),1)]),_:1})])]),_:1})],64)):x("",!0)]),_:1})])}}});const ra=ee(je,[["__scopeId","data-v-2522743a"]]);export{ra as default};
