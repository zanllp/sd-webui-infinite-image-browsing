import{d as re,l as F,aw as ce,Y as pe,Q as p,R as I,c as s,a0 as e,$ as n,a2 as R,S as d,H as me,U as o,T as u,Z as V,ab as ue,W as k,ac as G,ae as ge,O as fe,ag as z,aM as ve,aN as he,aT as Ie,X as ke}from"./index-ac57907e.js";import{S as _e}from"./index-ffe7b967.js";import{L as we,R as Ce,f as Se,M as be}from"./MultiSelectKeep-5d38d223.js";import{c as xe,d as Me,F as ye}from"./FileItem-e3b6a812.js";import{c as Ae,u as Te}from"./hook-bebd7723.js";import{a as $e}from"./functionalCallableComp-bacd8211.js";import"./shortcut-5c99090c.js";import"./Checkbox-a696edf2.js";import"./index-9d56980e.js";/* empty css              */import"./index-e1e78154.js";import"./_isIterateeCall-a8bdd540.js";import"./isArrayLikeObject-96b1e103.js";const De=r=>(ve("data-v-b42a9a06"),r=r(),he(),r),Fe={class:"hint"},Re={class:"action-bar"},Ve=De(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Ge={key:1},ze={class:"no-res-hint"},Be={class:"hint"},Ne={key:2,class:"preview-switch"},Ue=re({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},selectedTagIds:{},id:{}},setup(r){const g=r,f=Ae(t=>Ie(g.selectedTagIds,t)),{queue:B,images:i,onContextMenuClickU:_,stackViewEl:N,previewIdx:c,previewing:w,onPreviewVisibleChange:U,previewImgMove:C,canPreview:S,itemSize:b,gridItems:E,showGenInfo:m,imageGenInfo:x,q:J,multiSelectedIdxs:v,onFileItemClick:L,scroller:M,showMenuIdx:h,onFileDragStart:O,onFileDragEnd:P,cellWidth:K,onScroll:y,saveAllFileAsJson:W,props:q,saveLoadedFileAsJson:Q,changeIndchecked:H,seedChangeChecked:X,getGenDiff:Y,getGenDiffWatchDep:Z}=Te(f);F(()=>g.selectedTagIds,async()=>{var t;await f.reset(),await ce(),(t=M.value)==null||t.scrollToItem(0),y()},{immediate:!0}),F(()=>g,async t=>{q.value=t},{deep:!0,immediate:!0});const j=pe(),{onClearAllSelected:ee,onSelectAll:te,onReverseSelect:le}=xe();return(t,l)=>{const se=be,ne=ge,ae=fe,A=z,ie=z,oe=_e;return p(),I("div",{class:"container",ref_key:"stackViewEl",ref:N},[s(se,{show:!!e(v).length||e(j).keepMultiSelect,onClearAllSelected:e(ee),onSelectAll:e(te),onReverseSelect:e(le)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),s(oe,{size:"large",spinning:!e(B).isIdle},{default:n(()=>{var T,$;return[s(ae,{visible:e(m),"onUpdate:visible":l[1]||(l[1]=a=>R(m)?m.value=a:null),width:"70vw","mask-closable":"",onOk:l[2]||(l[2]=a=>m.value=!1)},{cancelText:n(()=>[]),default:n(()=>[s(ne,{active:"",loading:!e(J).isIdle},{default:n(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:l[0]||(l[0]=a=>e(me)(e(x)))},[d("div",Fe,o(t.$t("doubleClickToCopy")),1),u(" "+o(e(x)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Re,[s(A,{onClick:e(Q)},{default:n(()=>[u(o(t.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick"]),s(A,{onClick:e(W)},{default:n(()=>[u(o(t.$t("saveAllAsJson")),1)]),_:1},8,["onClick"])]),(T=e(i))!=null&&T.length?(p(),V(e(Me),{key:0,ref_key:"scroller",ref:M,class:"file-list",items:e(i),"item-size":e(b).first,"key-field":"fullpath","item-secondary-size":e(b).second,gridItems:e(E),onScroll:e(y)},{after:n(()=>[Ve]),default:n(({item:a,index:D})=>[s(ye,{idx:D,file:a,"cell-width":e(K),"show-menu-idx":e(h),"onUpdate:showMenuIdx":l[3]||(l[3]=de=>R(h)?h.value=de:null),onDragstart:e(O),onDragend:e(P),onFileItemClick:e(L),"full-screen-preview-image-url":e(i)[e(c)]?e(ue)(e(i)[e(c)]):"",selected:e(v).includes(D),onContextMenuClick:e(_),onPreviewVisibleChange:e(U),"is-selected-mutil-files":e(v).length>1,"enable-change-indicator":e(H),"seed-change-checked":e(X),"get-gen-diff":e(Y),"get-gen-diff-watch-dep":e(Z)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):e(f).load&&t.selectedTagIds.and_tags.length===1&&!(($=t.selectedTagIds.folder_paths_str)!=null&&$.trim())?(p(),I("div",Ge,[d("div",ze,[d("p",Be,o(t.$t("tagSearchNoResultsMessage")),1),s(ie,{onClick:l[4]||(l[4]=a=>e($e)()),type:"primary"},{default:n(()=>[u(o(t.$t("rebuildImageIndex")),1)]),_:1})])])):k("",!0),e(w)?(p(),I("div",Ne,[s(e(we),{onClick:l[5]||(l[5]=a=>e(C)("prev")),class:G({disable:!e(S)("prev")})},null,8,["class"]),s(e(Ce),{onClick:l[6]||(l[6]=a=>e(C)("next")),class:G({disable:!e(S)("next")})},null,8,["class"])])):k("",!0)]}),_:1},8,["spinning"]),e(w)&&e(i)&&e(i)[e(c)]?(p(),V(Se,{key:0,file:e(i)[e(c)],idx:e(c),onContextMenuClick:e(_)},null,8,["file","idx","onContextMenuClick"])):k("",!0)],512)}}});const je=ke(Ue,[["__scopeId","data-v-b42a9a06"]]);export{je as default};
