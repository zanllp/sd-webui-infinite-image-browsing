import{d as he,r as ke,m as C,aA as B,a1 as ve,U as u,V as S,c as n,a5 as e,a4 as o,a7 as z,W as d,L as we,Y as a,X as p,a3 as U,ag as Ie,aV as _e,$ as b,ah as L,aj as Ce,T as Se,al as N,aQ as be,aR as ye,bG as xe,a0 as Me}from"./index-214c37f1.js";import{S as Ae}from"./index-a8e9eaff.js";import{_ as Te}from"./index-fbb9b9b7.js";import{o as E,L as Ve,R as $e,f as De,M as Fe}from"./MultiSelectKeep-7de19d67.js";import{c as Re,d as Ge,F as Be}from"./FileItem-ce402db7.js";import{c as ze,u as Ue}from"./hook-2f409e5f.js";import"./shortcut-c70bb424.js";import"./Checkbox-f143d30a.js";/* empty css              */import"./index-3237a2fe.js";import"./index-e9d0b4c7.js";import"./numInput.vue_vue_type_style_index_0_scoped_bd954eda_lang-3d61c006.js";import"./_isIterateeCall-00caa5e4.js";import"./index-6edd4c1a.js";import"./useGenInfoDiff-ad344c7f.js";const Le=r=>(be("data-v-6e837a6f"),r=r(),ye(),r),Ne={class:"hint"},Ee={class:"action-bar"},Je=Le(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Pe={key:1},We={class:"no-res-hint"},Ke={class:"hint"},Oe={key:2,class:"preview-switch"},qe=he({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},selectedTagIds:{},id:{}},setup(r){const h=r,m=ke(!1),g=ze(t=>xe({...h.selectedTagIds,random_sort:m.value},t)),{queue:J,images:s,onContextMenuClickU:y,stackViewEl:P,previewIdx:c,previewing:x,onPreviewVisibleChange:W,previewImgMove:M,canPreview:A,itemSize:T,gridItems:K,showGenInfo:f,imageGenInfo:V,q:O,multiSelectedIdxs:k,onFileItemClick:q,scroller:v,showMenuIdx:w,onFileDragStart:Q,onFileDragEnd:j,cellWidth:X,onScroll:I,saveAllFileAsJson:Y,props:H,saveLoadedFileAsJson:Z,changeIndchecked:ee,seedChangeChecked:te,getGenDiff:le,getGenDiffWatchDep:ne}=Ue(g);C(()=>h.selectedTagIds,async()=>{var t;await g.reset(),await B(),(t=v.value)==null||t.scrollToItem(0),I()},{immediate:!0}),C(m,async()=>{var t;await g.reset(),await B(),(t=v.value)==null||t.scrollToItem(0),I()}),C(()=>h,async t=>{H.value=t},{deep:!0,immediate:!0});const se=ve(),{onClearAllSelected:ie,onSelectAll:oe,onReverseSelect:ae}=Re(),de=()=>{s.value.length!==0&&E(s.value,0)};return(t,l)=>{const re=Fe,ce=Ce,ue=Se,pe=Te,_=N,me=N,ge=Ae;return u(),S("div",{class:"container",ref_key:"stackViewEl",ref:P},[n(re,{show:!!e(k).length||e(se).keepMultiSelect,onClearAllSelected:e(ie),onSelectAll:e(oe),onReverseSelect:e(ae)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),n(ge,{size:"large",spinning:!e(J).isIdle},{default:o(()=>{var $,D,F;return[n(ue,{visible:e(f),"onUpdate:visible":l[1]||(l[1]=i=>z(f)?f.value=i:null),width:"70vw","mask-closable":"",onOk:l[2]||(l[2]=i=>f.value=!1)},{cancelText:o(()=>[]),default:o(()=>[n(ce,{active:"",loading:!e(O).isIdle},{default:o(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:l[0]||(l[0]=i=>e(we)(e(V)))},[d("div",Ne,a(t.$t("doubleClickToCopy")),1),p(" "+a(e(V)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Ee,[n(pe,{checked:m.value,"onUpdate:checked":l[3]||(l[3]=i=>m.value=i),"checked-children":t.$t("randomSort"),"un-checked-children":t.$t("sortByDate")},null,8,["checked","checked-children","un-checked-children"]),n(_,{onClick:de,disabled:!(($=e(s))!=null&&$.length)},{default:o(()=>[p(a(t.$t("tiktokView")),1)]),_:1},8,["disabled"]),n(_,{onClick:e(Z)},{default:o(()=>[p(a(t.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick"]),n(_,{onClick:e(Y)},{default:o(()=>[p(a(t.$t("saveAllAsJson")),1)]),_:1},8,["onClick"])]),(D=e(s))!=null&&D.length?(u(),U(e(Ge),{key:0,ref_key:"scroller",ref:v,class:"file-list",items:e(s),"item-size":e(T).first,"key-field":"fullpath","item-secondary-size":e(T).second,gridItems:e(K),onScroll:e(I)},{after:o(()=>[Je]),default:o(({item:i,index:R})=>[n(Be,{idx:R,file:i,"cell-width":e(X),"show-menu-idx":e(w),"onUpdate:showMenuIdx":l[4]||(l[4]=G=>z(w)?w.value=G:null),onDragstart:e(Q),onDragend:e(j),onFileItemClick:e(q),onTiktokView:(G,fe)=>e(E)(e(s),fe),"full-screen-preview-image-url":e(s)[e(c)]?e(Ie)(e(s)[e(c)]):"",selected:e(k).includes(R),onContextMenuClick:e(y),onPreviewVisibleChange:e(W),"is-selected-mutil-files":e(k).length>1,"enable-change-indicator":e(ee),"seed-change-checked":e(te),"get-gen-diff":e(le),"get-gen-diff-watch-dep":e(ne)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):e(g).load&&t.selectedTagIds.and_tags.length===1&&!((F=t.selectedTagIds.folder_paths_str)!=null&&F.trim())?(u(),S("div",Pe,[d("div",We,[d("p",Ke,a(t.$t("tagSearchNoResultsMessage")),1),n(me,{onClick:l[5]||(l[5]=i=>e(_e)()),type:"primary"},{default:o(()=>[p(a(t.$t("rebuildImageIndex")),1)]),_:1})])])):b("",!0),e(x)?(u(),S("div",Oe,[n(e(Ve),{onClick:l[6]||(l[6]=i=>e(M)("prev")),class:L({disable:!e(A)("prev")})},null,8,["class"]),n(e($e),{onClick:l[7]||(l[7]=i=>e(M)("next")),class:L({disable:!e(A)("next")})},null,8,["class"])])):b("",!0)]}),_:1},8,["spinning"]),e(x)&&e(s)&&e(s)[e(c)]?(u(),U(De,{key:0,file:e(s)[e(c)],idx:e(c),onContextMenuClick:e(y)},null,8,["file","idx","onContextMenuClick"])):b("",!0)],512)}}});const rt=Me(qe,[["__scopeId","data-v-6e837a6f"]]);export{rt as default};
