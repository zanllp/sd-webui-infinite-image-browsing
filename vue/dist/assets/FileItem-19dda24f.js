var pt=Object.defineProperty;var vt=(i,n,e)=>n in i?pt(i,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[n]=e;var ee=(i,n,e)=>(vt(i,typeof n!="symbol"?n+"":n,e),e);import{d as Z,u as Ke,G as x,an as Ge,h as K,c as k,aq as mt,dl as yt,r as V,bh as bt,Z as j,dj as At,P as $e,ca as kt,A as X,dm as de,O as he,am as Se,bk as St,d7 as _t,b$ as It,dn as Ct,cH as wt,dp as Me,dq as Tt,p as Et,dr as Ye,bB as Pt,ds as _e,dt as Ot,aH as Dt,du as Nt,C as zt,dv as $t,n as ge,m as oe,aU as Mt,t as qe,a1 as Ie,c8 as Ze,aJ as Qt,dw as Xe,dx as Bt,Q as Ft,x as Rt,cs as pe,cS as et,cT as tt,aP as Ce,aQ as we,az as nt,U as l,a2 as R,dy as Lt,dz as Vt,dA as jt,c4 as xt,dB as Ht,at as Ut,V as f,aG as te,$ as A,a3 as _,a8 as H,c5 as Qe,c6 as Jt,dC as Wt,a7 as it,ag as W,X as I,Y as g,a4 as F,al as st,de as Kt,dd as Gt,M as rt,W as u,a0 as ot,d8 as Yt,dD as Be,af as qt,dE as Zt,db as Xt,dF as en,dG as tn,dH as ce,cM as nn,dI as sn,dJ as rn,dK as on}from"./index-3d3aa3ce.js";import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-6330384b.js";import{i as ln}from"./_isIterateeCall-295c4a47.js";import{D as Y,a as ve}from"./index-f644ead6.js";/* empty css              */var an=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},un=Z({compatConfig:{MODE:3},name:"ACheckableTag",props:an(),setup:function(n,e){var t=e.slots,s=e.emit,o=Ke("tag",n),p=o.prefixCls,c=function(O){var w=n.checked;s("update:checked",!w),s("change",!w),s("click",O)},h=x(function(){var y;return Ge(p.value,(y={},K(y,"".concat(p.value,"-checkable"),!0),K(y,"".concat(p.value,"-checkable-checked"),n.checked),y))});return function(){var y;return k("span",{class:h.value,onClick:c},[(y=t.default)===null||y===void 0?void 0:y.call(t)])}}});const me=un;var dn=new RegExp("^(".concat(mt.join("|"),")(-inverse)?$")),cn=new RegExp("^(".concat(yt.join("|"),")$")),fn=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:$e.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:$e.any}},q=Z({compatConfig:{MODE:3},name:"ATag",props:fn(),slots:["closeIcon","icon"],setup:function(n,e){var t=e.slots,s=e.emit,o=e.attrs,p=Ke("tag",n),c=p.prefixCls,h=p.direction,y=V(!0);bt(function(){n.visible!==void 0&&(y.value=n.visible)});var O=function(a){a.stopPropagation(),s("update:visible",!1),s("close",a),!a.defaultPrevented&&n.visible===void 0&&(y.value=!1)},w=x(function(){var Q=n.color;return Q?dn.test(Q)||cn.test(Q):!1}),D=x(function(){var Q;return Ge(c.value,(Q={},K(Q,"".concat(c.value,"-").concat(n.color),w.value),K(Q,"".concat(c.value,"-has-color"),n.color&&!w.value),K(Q,"".concat(c.value,"-hidden"),!y.value),K(Q,"".concat(c.value,"-rtl"),h.value==="rtl"),Q))});return function(){var Q,a,d,r=n.icon,b=r===void 0?(Q=t.icon)===null||Q===void 0?void 0:Q.call(t):r,C=n.color,M=n.closeIcon,v=M===void 0?(a=t.closeIcon)===null||a===void 0?void 0:a.call(t):M,T=n.closable,E=T===void 0?!1:T,$=function(){return E?v?k("span",{class:"".concat(c.value,"-close-icon"),onClick:O},[v]):k(kt,{class:"".concat(c.value,"-close-icon"),onClick:O},null):null},m={backgroundColor:C&&!w.value?C:void 0},P=b||null,S=(d=t.default)===null||d===void 0?void 0:d.call(t),L=P?k(j,null,[P,k("span",null,[S])]):S,N="onClick"in o,B=k("span",{class:D.value,style:m},[L,$()]);return N?k(At,null,{default:function(){return[B]}}):B}}});q.CheckableTag=me;q.install=function(i){return i.component(q.name,q),i.component(me.name,me),i};const hn=q;Y.Button=ve;Y.install=function(i){return i.component(Y.name,Y),i.component(ve.name,ve),i};var gn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const pn=gn;function Fe(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){vn(i,s,e[s])})}return i}function vn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Te=function(n,e){var t=Fe({},n,e.attrs);return k(X,Fe({},t,{icon:pn}),null)};Te.displayName="StarFilled";Te.inheritAttrs=!1;const lt=Te;var mn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const yn=mn;function Re(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){bn(i,s,e[s])})}return i}function bn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Ee=function(n,e){var t=Re({},n,e.attrs);return k(X,Re({},t,{icon:yn}),null)};Ee.displayName="FileOutlined";Ee.inheritAttrs=!1;const An=Ee;var kn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const Sn=kn;function Le(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){_n(i,s,e[s])})}return i}function _n(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Pe=function(n,e){var t=Le({},n,e.attrs);return k(X,Le({},t,{icon:Sn}),null)};Pe.displayName="FolderOpenOutlined";Pe.inheritAttrs=!1;const In=Pe;function Cn(i){return i&&i.length?i[0]:void 0}var wn=Math.ceil,Tn=Math.max;function En(i,n,e,t){for(var s=-1,o=Tn(wn((n-i)/(e||1)),0),p=Array(o);o--;)p[t?o:++s]=i,i+=e;return p}function Pn(i){return function(n,e,t){return t&&typeof t!="number"&&ln(n,e,t)&&(e=t=void 0),n=de(n),e===void 0?(e=n,n=0):e=de(e),t=t===void 0?n<e?1:-1:de(t),En(n,e,t,i)}}var On=Pn();const Dn=On,Nn="data:image/png;base64,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",ne=new WeakMap;function zn(i,n){return{useHookShareState:t=>{const s=It();he(s),ne.has(s)||(ne.set(s,Se(i(s,t??(n==null?void 0:n())))),St(()=>{ne.delete(s)}));const o=ne.get(s);return he(o),{state:o,toRefs(){return _t(o)}}}}}var $n={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const Mn=$n;function Ve(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){Qn(i,s,e[s])})}return i}function Qn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Oe=function(n,e){var t=Ve({},n,e.attrs);return k(X,Ve({},t,{icon:Mn}),null)};Oe.displayName="CaretRightOutlined";Oe.inheritAttrs=!1;const je=Oe;var Bn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const Fn=Bn;function xe(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){Rn(i,s,e[s])})}return i}function Rn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var De=function(n,e){var t=xe({},n,e.attrs);return k(X,xe({},t,{icon:Fn}),null)};De.displayName="StarOutlined";De.inheritAttrs=!1;const at=De,Ln="/infinite_image_browsing/fe-static/assets/play-68f5544d.svg",Vn=Ct("useBatchDownloadStore",()=>{const i=V([]);return{selectdFiles:i,addFiles:e=>{i.value=wt([...i.value,...e])}}});class le{constructor(n,e=Tt.CREATED_TIME_DESC){ee(this,"root");ee(this,"execQueue",[]);ee(this,"walkerInitPromsie");this.entryPath=n,this.sortMethod=e,this.root={children:[],info:{name:this.entryPath,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:this.entryPath}},this.walkerInitPromsie=new Promise(t=>{Me([this.entryPath]).then(async s=>{this.root.info=s[this.entryPath],await this.fetchChildren(this.root),t()})})}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const n=e=>e.children.map(t=>{if(t.info.type==="dir")return n(t);if(_e(t.info.name))return t.info}).filter(t=>t).flat(1);return n(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(n){const{files:e}=await Et(n.info.fullpath);return n.children=Ye(e,this.sortMethod).map(t=>({info:t,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...n.children.filter(t=>t.info.type==="dir").map(t=>({fn:()=>this.fetchChildren(t),...t}))),n}async next(){await this.walkerInitPromsie;const n=Cn(this.execQueue);if(!n)return null;const e=await n.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},e}async isExpired(){const n=[this.root.info],e=s=>{for(const o of s.children)o.info.type==="dir"&&(n.push(o.info),e(o))};e(this.root);const t=await Me(n.map(s=>s.fullpath));for(const s of n)if(!Pt(s,t[s.fullpath]))return!0;return!1}async seamlessRefresh(n,e=V(!1)){const t=performance.now(),s=new le(this.entryPath,this.sortMethod);for(await s.walkerInitPromsie;!s.isCompleted&&s.images.length<n;){if(e.value)throw new Error("canceled");await s.next()}const o=performance.now();return console.log("seamlessRefresh currPos:",n,"Time taken:",(o-t).toFixed(0),"ms"),s}}var ut={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(i,n){(function(e,t){i.exports=t})(Ot,function(){var e={};e.version="0.3.5";var t=e.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};e.configure=function(a){var d,r;for(d in a)r=a[d],r!==void 0&&a.hasOwnProperty(d)&&(t[d]=r);return this},e.status=null,e.set=function(a){var d=e.isStarted();a=s(a,t.minimum,1),e.status=a===1?null:a;var r=e.render(!d),b=r.querySelector(t.barSelector),C=t.speed,M=t.easing;return r.offsetWidth,c(function(v){t.positionUsing===""&&(t.positionUsing=e.getPositioningCSS()),h(b,p(a,C,M)),a===1?(h(r,{transition:"none",opacity:1}),r.offsetWidth,setTimeout(function(){h(r,{transition:"all "+C+"ms linear",opacity:0}),setTimeout(function(){e.remove(),v()},C)},C)):setTimeout(v,C)}),this},e.isStarted=function(){return typeof e.status=="number"},e.start=function(){e.status||e.set(0);var a=function(){setTimeout(function(){e.status&&(e.trickle(),a())},t.trickleSpeed)};return t.trickle&&a(),this},e.done=function(a){return!a&&!e.status?this:e.inc(.3+.5*Math.random()).set(1)},e.inc=function(a){var d=e.status;return d?d>1?void 0:(typeof a!="number"&&(d>=0&&d<.2?a=.1:d>=.2&&d<.5?a=.04:d>=.5&&d<.8?a=.02:d>=.8&&d<.99?a=.005:a=0),d=s(d+a,0,.994),e.set(d)):e.start()},e.trickle=function(){return e.inc()},function(){var a=0,d=0;e.promise=function(r){return!r||r.state()==="resolved"?this:(d===0&&e.start(),a++,d++,r.always(function(){d--,d===0?(a=0,e.done()):e.set((a-d)/a)}),this)}}(),e.getElement=function(){var a=e.getParent();if(a){var d=Array.prototype.slice.call(a.querySelectorAll(".nprogress")).filter(function(r){return r.parentElement===a});if(d.length>0)return d[0]}return null},e.getParent=function(){if(t.parent instanceof HTMLElement)return t.parent;if(typeof t.parent=="string")return document.querySelector(t.parent)},e.render=function(a){if(e.isRendered())return e.getElement();O(document.documentElement,"nprogress-busy");var d=document.createElement("div");d.id="nprogress",d.className="nprogress",d.innerHTML=t.template;var r=d.querySelector(t.barSelector),b=a?"-100":o(e.status||0),C=e.getParent(),M;return h(r,{transition:"all 0 linear",transform:"translate3d("+b+"%,0,0)"}),t.showSpinner||(M=d.querySelector(t.spinnerSelector),M&&Q(M)),C!=document.body&&O(C,"nprogress-custom-parent"),C.appendChild(d),d},e.remove=function(){e.status=null,w(document.documentElement,"nprogress-busy"),w(e.getParent(),"nprogress-custom-parent");var a=e.getElement();a&&Q(a)},e.isRendered=function(){return!!e.getElement()},e.getPositioningCSS=function(){var a=document.body.style,d="WebkitTransform"in a?"Webkit":"MozTransform"in a?"Moz":"msTransform"in a?"ms":"OTransform"in a?"O":"";return d+"Perspective"in a?"translate3d":d+"Transform"in a?"translate":"margin"};function s(a,d,r){return a<d?d:a>r?r:a}function o(a){return(-1+a)*100}function p(a,d,r){var b;return t.positionUsing==="translate3d"?b={transform:"translate3d("+o(a)+"%,0,0)"}:t.positionUsing==="translate"?b={transform:"translate("+o(a)+"%,0)"}:b={"margin-left":o(a)+"%"},b.transition="all "+d+"ms "+r,b}var c=function(){var a=[];function d(){var r=a.shift();r&&r(d)}return function(r){a.push(r),a.length==1&&d()}}(),h=function(){var a=["Webkit","O","Moz","ms"],d={};function r(v){return v.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(T,E){return E.toUpperCase()})}function b(v){var T=document.body.style;if(v in T)return v;for(var E=a.length,$=v.charAt(0).toUpperCase()+v.slice(1),m;E--;)if(m=a[E]+$,m in T)return m;return v}function C(v){return v=r(v),d[v]||(d[v]=b(v))}function M(v,T,E){T=C(T),v.style[T]=E}return function(v,T){var E=arguments,$,m;if(E.length==2)for($ in T)m=T[$],m!==void 0&&T.hasOwnProperty($)&&M(v,$,m);else M(v,E[1],E[2])}}();function y(a,d){var r=typeof a=="string"?a:D(a);return r.indexOf(" "+d+" ")>=0}function O(a,d){var r=D(a),b=r+d;y(r,d)||(a.className=b.substring(1))}function w(a,d){var r=D(a),b;y(a,d)&&(b=r.replace(" "+d+" "," "),a.className=b.substring(1,b.length-1))}function D(a){return(" "+(a&&a.className||"")+" ").replace(/\s+/gi," ")}function Q(a){a&&a.parentNode&&a.parentNode.removeChild(a)}return e})})(ut);var jn=ut.exports;const dr=Dt(jn);function cr({fetchNext:i}={}){const{scroller:n,sortedFiles:e,sortMethod:t,currLocation:s,stackViewEl:o,canLoadNext:p,previewIdx:c,props:h,walker:y,getViewableAreaFiles:O}=ae().toRefs(),{state:w}=ae(),D=V(!1),Q=V(G.defaultGridCellWidth),a=x(()=>Q.value+16),d=44,{width:r}=Nt(o),b=x(()=>~~(r.value/a.value)),C=Se(new Map),M=x(()=>{const P=a.value;return{first:P+(Q.value<=160?0:d),second:P}}),v=V(!1),T=async()=>{var P;if(!(v.value||h.value.mode!=="walk"||!p.value))try{v.value=!0,await((P=y.value)==null?void 0:P.next())}finally{v.value=!1}},E=async(P=!1)=>{const S=n.value,L=()=>P?c.value:(S==null?void 0:S.$_endIndex)??0,N=()=>{const B=e.value.length,U=50;return B?i?L()>B-U:L()>B-U&&p.value:!0};for(;N();){await qe(30);const B=await(i??T)();if(typeof B=="boolean"&&!B)return}};w.useEventListen("loadNextDir",zt(async(P=!1)=>{await E(P),h.value.mode==="walk"&&$()})),w.useEventListen("viewableAreaFilesChange",()=>{const P=O.value(),S=P.filter(N=>N.is_under_scanned_path&&_e(N.name)).map(N=>N.fullpath);xn.fetchImageTags(S);const L=P.filter(N=>N.is_under_scanned_path&&N.type==="dir"&&!C.has(N.fullpath)).map(N=>N.fullpath);L.length&&$t(L).then(N=>{for(const B in N)if(Object.prototype.hasOwnProperty.call(N,B)){const U=N[B];C.set(B,U)}})}),w.useEventListen("refresh",async()=>{w.eventEmitter.emit("viewableAreaFilesChange")});const $=ge(()=>w.eventEmitter.emit("viewableAreaFilesChange"),300);oe(s,$);const m=ge(async()=>{await E(),$()},150);return{gridItems:b,sortedFiles:e,sortMethodConv:Mt,moreActionsDropdownShow:D,gridSize:a,sortMethod:t,onScroll:m,loadNextDir:T,loadNextDirLoading:v,canLoadNext:p,itemSize:M,cellWidth:Q,dirCoverCache:C}}const fr=new Map,G=Ie(),hr=Vn(),xn=Ze(),gr=Qt(),pr=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:vr,useEventListen:mr}=Xe(),{useHookShareState:ae}=zn((i,{images:n})=>{const e=V({tabIdx:-1,paneIdx:-1}),t=x(()=>Ft(s.value)),s=V([]),o=x(()=>{var T;return s.value.map(E=>E.curr).slice((T=G.conf)!=null&&T.is_win&&e.value.mode!=="scanned-fixed"?1:0)}),p=x(()=>Rt(...o.value)),c=x(()=>{var T,E;return e.value.mode==="scanned-fixed"?((E=(T=s.value)==null?void 0:T[0])==null?void 0:E.curr)??"":e.value.mode==="walk"?e.value.path??"":s.value.length===1?"/":p.value}),h=V(G.defaultSortingMethod),y=V(e.value.mode=="walk"?new le(e.value.path,h.value):void 0);oe([()=>e.value.mode,()=>e.value.path,h],async([T,E,$])=>{var m;T==="walk"?(y.value=new le(E,$),s.value=[{files:[],curr:E}],await qe(),await((m=y.value)==null?void 0:m.reset()),M.eventEmitter.emit("loadNextDir")):y.value=void 0});const O=Se(new Set);oe(t,()=>O.clear());const w=x(()=>{var m;if(n.value)return n.value;if(y.value)return y.value.images.filter(P=>!O.has(P.fullpath));if(!t.value)return[];const T=((m=t.value)==null?void 0:m.files)??[],E=h.value;return Ye((P=>{const S=G.fileTypeFilter;return S.includes("all")||S.length===0?P:P.filter(L=>!!(L.type==="dir"||S.includes("image")&&pe(L.name)||S.includes("video")&&et(L.name)||S.includes("audio")&&tt(L.name)))})(T),E).filter(P=>!O.has(P.fullpath))}),D=V([]),Q=V(-1),a=x(()=>y.value?!y.value.isCompleted:!1),d=V(!1),r=V(!1),b=V(),C=()=>{var T,E,$;return($=(E=(T=G.tabList)==null?void 0:T[e.value.tabIdx])==null?void 0:E.panes)==null?void 0:$[e.value.paneIdx]},M=Xe();M.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${w.value.length}`),D.value=Dn(0,w.value.length)});const v=()=>{const T=b.value;if(T){const E=Math.max(T.$_startIndex-10,0);return w.value.slice(E,T.$_endIndex+10)}return[]};return{previewing:r,spinning:d,canLoadNext:a,multiSelectedIdxs:D,previewIdx:Q,basePath:o,currLocation:c,currPage:t,stack:s,sortMethod:h,sortedFiles:w,scroller:b,stackViewEl:V(),props:e,getPane:C,walker:y,deletedFiles:O,getViewableAreaFiles:v,...M}},()=>({images:V()}));function yr(){const{eventEmitter:i,multiSelectedIdxs:n,sortedFiles:e}=ae().toRefs();return{onSelectAll:()=>i.value.emit("selectAll"),onReverseSelect:()=>{n.value=e.value.map((p,c)=>c).filter(p=>!n.value.includes(p))},onClearAllSelected:()=>{n.value=[]}}}const br=()=>{const{stackViewEl:i}=ae().toRefs(),n=V(-1);return Bt(i,e=>{var s;let t=e.target;for(;t.parentElement;)if(t=t.parentElement,t.tagName.toLowerCase()==="li"&&t.classList.contains("file-item-trigger")){const o=(s=t.dataset)==null?void 0:s.idx;o&&Number.isSafeInteger(+o)&&(n.value=+o);return}}),{showMenuIdx:n}};function Hn(){var i=window.navigator.userAgent,n=i.indexOf("MSIE ");if(n>0)return parseInt(i.substring(n+5,i.indexOf(".",n)),10);var e=i.indexOf("Trident/");if(e>0){var t=i.indexOf("rv:");return parseInt(i.substring(t+3,i.indexOf(".",t)),10)}var s=i.indexOf("Edge/");return s>0?parseInt(i.substring(s+5,i.indexOf(".",s)),10):-1}let se;function ye(){ye.init||(ye.init=!0,se=Hn()!==-1)}var ue={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){ye(),nt(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const i=document.createElement("object");this._resizeObject=i,i.setAttribute("aria-hidden","true"),i.setAttribute("tabindex",-1),i.onload=this.addResizeHandlers,i.type="text/html",se&&this.$el.appendChild(i),i.data="about:blank",se||this.$el.appendChild(i)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!se&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Un=Lt();Ce("data-v-b329ee4c");const Jn={class:"resize-observer",tabindex:"-1"};we();const Wn=Un((i,n,e,t,s,o)=>(l(),R("div",Jn)));ue.render=Wn;ue.__scopeId="data-v-b329ee4c";ue.__file="src/components/ResizeObserver.vue";function re(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?re=function(n){return typeof n}:re=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},re(i)}function Kn(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function He(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}function Gn(i,n,e){return n&&He(i.prototype,n),e&&He(i,e),i}function Ue(i){return Yn(i)||qn(i)||Zn(i)||Xn()}function Yn(i){if(Array.isArray(i))return be(i)}function qn(i){if(typeof Symbol<"u"&&Symbol.iterator in Object(i))return Array.from(i)}function Zn(i,n){if(i){if(typeof i=="string")return be(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return be(i,n)}}function be(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function Xn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ei(i){var n;return typeof i=="function"?n={callback:i}:n=i,n}function ti(i,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t,s,o,p=function(h){for(var y=arguments.length,O=new Array(y>1?y-1:0),w=1;w<y;w++)O[w-1]=arguments[w];if(o=O,!(t&&h===s)){var D=e.leading;typeof D=="function"&&(D=D(h,s)),(!t||h!==s)&&D&&i.apply(void 0,[h].concat(Ue(o))),s=h,clearTimeout(t),t=setTimeout(function(){i.apply(void 0,[h].concat(Ue(o))),t=0},n)}};return p._clear=function(){clearTimeout(t),t=null},p}function dt(i,n){if(i===n)return!0;if(re(i)==="object"){for(var e in i)if(!dt(i[e],n[e]))return!1;return!0}return!1}var ni=function(){function i(n,e,t){Kn(this,i),this.el=n,this.observer=null,this.frozen=!1,this.createObserver(e,t)}return Gn(i,[{key:"createObserver",value:function(e,t){var s=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=ei(e),this.callback=function(c,h){s.options.callback(c,h),c&&s.options.once&&(s.frozen=!0,s.destroyObserver())},this.callback&&this.options.throttle){var o=this.options.throttleOptions||{},p=o.leading;this.callback=ti(this.callback,this.options.throttle,{leading:function(h){return p==="both"||p==="visible"&&h||p==="hidden"&&!h}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(c){var h=c[0];if(c.length>1){var y=c.find(function(w){return w.isIntersecting});y&&(h=y)}if(s.callback){var O=h.isIntersecting&&h.intersectionRatio>=s.threshold;if(O===s.oldResult)return;s.oldResult=O,s.callback(O,h)}},this.options.intersection),nt(function(){s.observer&&s.observer.observe(s.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),i}();function ct(i,n,e){var t=n.value;if(t)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var s=new ni(i,t,e);i._vue_visibilityState=s}}function ii(i,n,e){var t=n.value,s=n.oldValue;if(!dt(t,s)){var o=i._vue_visibilityState;if(!t){ft(i);return}o?o.createObserver(t,e):ct(i,{value:t},e)}}function ft(i){var n=i._vue_visibilityState;n&&(n.destroyObserver(),delete i._vue_visibilityState)}var si={beforeMount:ct,updated:ii,unmounted:ft},ri={itemsLimit:1e3},oi=/(auto|scroll)/;function ht(i,n){return i.parentNode===null?n:ht(i.parentNode,n.concat([i]))}var fe=function(n,e){return getComputedStyle(n,null).getPropertyValue(e)},li=function(n){return fe(n,"overflow")+fe(n,"overflow-y")+fe(n,"overflow-x")},ai=function(n){return oi.test(li(n))};function Je(i){if(i instanceof HTMLElement||i instanceof SVGElement){for(var n=ht(i.parentNode,[]),e=0;e<n.length;e+=1)if(ai(n[e]))return n[e];return document.scrollingElement||document.documentElement}}function Ae(i){"@babel/helpers - typeof";return Ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ae(i)}var ui={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(n){return["vertical","horizontal"].includes(n)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function di(){return this.items.length&&Ae(this.items[0])!=="object"}var ke=!1;if(typeof window<"u"){ke=!1;try{var ci=Object.defineProperty({},"passive",{get:function(){ke=!0}});window.addEventListener("test",null,ci)}catch{}}let fi=0;var gt={name:"RecycleScroller",components:{ResizeObserver:ue},directives:{ObserveVisibility:si},props:{...ui,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const i={"-1":{accumulator:0}},n=this.items,e=this.sizeField,t=this.minItemSize;let s=1e4,o=0,p;for(let c=0,h=n.length;c<h;c++)p=n[c][e]||t,p<s&&(s=p),o+=p,i[c]={accumulator:o,size:p};return this.$_computedMinItemSize=s,i}return[]},simpleArray:di,itemIndexByKey(){const{keyField:i,items:n}=this,e={};for(let t=0,s=n.length;t<s;t++)e[n[t][i]]=t;return e}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const i=this.$_lastUpdateScrollPosition;typeof i=="number"&&this.$nextTick(()=>{this.scrollToPosition(i)})},beforeUnmount(){this.removeListeners()},methods:{addView(i,n,e,t,s){const o=Vt({id:fi++,index:n,used:!0,key:t,type:s}),p=jt({item:e,position:0,nr:o});return i.push(p),p},unuseView(i,n=!1){const e=this.$_unusedViews,t=i.nr.type;let s=e.get(t);s||(s=[],e.set(t,s)),s.push(i),n||(i.nr.used=!1,i.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(i){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const n=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:e}=this.updateVisibleItems(!1,!0);e||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});n(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&n()},this.updateInterval))}},handleVisibilityChange(i,n){this.ready&&(i||n.boundingClientRect.width!==0||n.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(i,n=!1){const e=this.itemSize,t=this.gridItems||1,s=this.itemSecondarySize||e,o=this.$_computedMinItemSize,p=this.typeField,c=this.simpleArray?null:this.keyField,h=this.items,y=h.length,O=this.sizes,w=this.$_views,D=this.$_unusedViews,Q=this.pool,a=this.itemIndexByKey;let d,r,b,C,M;if(!y)d=r=C=M=b=0;else if(this.$_prerender)d=C=0,r=M=Math.min(this.prerender,h.length),b=null;else{const S=this.getScroll();if(n){let B=S.start-this.$_lastUpdateScrollPosition;if(B<0&&(B=-B),e===null&&B<o||B<e)return{continuous:!0}}this.$_lastUpdateScrollPosition=S.start;const L=this.buffer;S.start-=L,S.end+=L;let N=0;if(this.$refs.before&&(N=this.$refs.before.scrollHeight,S.start-=N),this.$refs.after){const B=this.$refs.after.scrollHeight;S.end+=B}if(e===null){let B,U=0,Ne=y-1,J=~~(y/2),ze;do ze=J,B=O[J].accumulator,B<S.start?U=J:J<y-1&&O[J+1].accumulator>S.start&&(Ne=J),J=~~((U+Ne)/2);while(J!==ze);for(J<0&&(J=0),d=J,b=O[y-1].accumulator,r=J;r<y&&O[r].accumulator<S.end;r++);for(r===-1?r=h.length-1:(r++,r>y&&(r=y)),C=d;C<y&&N+O[C].accumulator<S.start;C++);for(M=C;M<y&&N+O[M].accumulator<S.end;M++);}else{d=~~(S.start/e*t);const B=d%t;d-=B,r=Math.ceil(S.end/e*t),C=Math.max(0,Math.floor((S.start-N)/e*t)),M=Math.floor((S.end-N)/e*t),d<0&&(d=0),r>y&&(r=y),C<0&&(C=0),M>y&&(M=y),b=Math.ceil(y/t)*e}}r-d>ri.itemsLimit&&this.itemsLimitError(),this.totalSize=b;let v;const T=d<=this.$_endIndex&&r>=this.$_startIndex;if(T)for(let S=0,L=Q.length;S<L;S++)v=Q[S],v.nr.used&&(i&&(v.nr.index=a[v.item[c]]),(v.nr.index==null||v.nr.index<d||v.nr.index>=r)&&this.unuseView(v));const E=T?null:new Map;let $,m,P;for(let S=d;S<r;S++){$=h[S];const L=c?$[c]:$;if(L==null)throw new Error(`Key is ${L} on item (keyField is '${c}')`);if(v=w.get(L),!e&&!O[S].size){v&&this.unuseView(v);continue}m=$[p];let N=D.get(m),B=!1;if(!v)T?N&&N.length?v=N.pop():v=this.addView(Q,S,$,L,m):(P=E.get(m)||0,(!N||P>=N.length)&&(v=this.addView(Q,S,$,L,m),this.unuseView(v,!0),N=D.get(m)),v=N[P],E.set(m,P+1)),w.delete(v.nr.key),v.nr.used=!0,v.nr.index=S,v.nr.key=L,v.nr.type=m,w.set(L,v),B=!0;else if(!v.nr.used&&(v.nr.used=!0,v.nr.index=S,B=!0,N)){const U=N.indexOf(v);U!==-1&&N.splice(U,1)}v.item=$,B&&(S===h.length-1&&this.$emit("scroll-end"),S===0&&this.$emit("scroll-start")),e===null?(v.position=O[S-1].accumulator,v.offset=0):(v.position=Math.floor(S/t)*e,v.offset=S%t*s)}return this.$_startIndex=d,this.$_endIndex=r,this.emitUpdate&&this.$emit("update",d,r,C,M),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:T}},getListenerTarget(){let i=Je(this.$el);return window.document&&(i===window.document.documentElement||i===window.document.body)&&(i=window),i},getScroll(){const{$el:i,direction:n}=this,e=n==="vertical";let t;if(this.pageMode){const s=i.getBoundingClientRect(),o=e?s.height:s.width;let p=-(e?s.top:s.left),c=e?window.innerHeight:window.innerWidth;p<0&&(c+=p,p=0),p+c>o&&(c=o-p),t={start:p,end:p+c}}else e?t={start:i.scrollTop,end:i.scrollTop+i.clientHeight}:t={start:i.scrollLeft,end:i.scrollLeft+i.clientWidth};return t},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,ke?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(i){let n;const e=this.gridItems||1;this.itemSize===null?n=i>0?this.sizes[i-1].accumulator:0:n=Math.floor(i/e)*this.itemSize,this.scrollToPosition(n)},scrollToPosition(i){const n=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let e,t,s;if(this.pageMode){const o=Je(this.$el),p=o.tagName==="HTML"?0:o[n.scroll],c=o.getBoundingClientRect(),y=this.$el.getBoundingClientRect()[n.start]-c[n.start];e=o,t=n.scroll,s=i+p+y}else e=this.$el,t=n.scroll,s=i;e[t]=s},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((i,n)=>i.nr.index-n.nr.index)}}};const hi={key:0,ref:"before",class:"vue-recycle-scroller__slot"},gi={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function pi(i,n,e,t,s,o){const p=xt("ResizeObserver"),c=Ht("observe-visibility");return Ut((l(),f("div",{class:W(["vue-recycle-scroller",{ready:s.ready,"page-mode":e.pageMode,[`direction-${i.direction}`]:!0}]),onScrollPassive:n[0]||(n[0]=(...h)=>o.handleScroll&&o.handleScroll(...h))},[i.$slots.before?(l(),f("div",hi,[te(i.$slots,"before")],512)):A("v-if",!0),(l(),R(Qe(e.listTag),{ref:"wrapper",style:it({[i.direction==="vertical"?"minHeight":"minWidth"]:s.totalSize+"px"}),class:W(["vue-recycle-scroller__item-wrapper",e.listClass])},{default:_(()=>[(l(!0),f(j,null,H(s.pool,h=>(l(),R(Qe(e.itemTag),Jt({key:h.nr.id,style:s.ready?{transform:`translate${i.direction==="vertical"?"Y":"X"}(${h.position}px) translate${i.direction==="vertical"?"X":"Y"}(${h.offset}px)`,width:e.gridItems?`${i.direction==="vertical"&&e.itemSecondarySize||e.itemSize}px`:void 0,height:e.gridItems?`${i.direction==="horizontal"&&e.itemSecondarySize||e.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[e.itemClass,{hover:!e.skipHover&&s.hoverKey===h.nr.key}]]},Wt(e.skipHover?{}:{mouseenter:()=>{s.hoverKey=h.nr.key},mouseleave:()=>{s.hoverKey=null}})),{default:_(()=>[te(i.$slots,"default",{item:h.item,index:h.nr.index,active:h.nr.used})]),_:2},1040,["style","class"]))),128)),te(i.$slots,"empty")]),_:3},8,["style","class"])),i.$slots.after?(l(),f("div",gi,[te(i.$slots,"after")],512)):A("v-if",!0),k(p,{onNotify:o.handleResize},null,8,["onNotify"])],34)),[[c,o.handleVisibilityChange]])}gt.render=pi;gt.__file="src/components/RecycleScroller.vue";const We=Z({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},isSelectedMutilFiles:{type:Boolean}},emits:["contextMenuClick"],setup(i,{emit:n}){const e=i,t=Ie(),s=x(()=>{var o;return(((o=t.conf)==null?void 0:o.all_custom_tags)??[]).reduce((p,c)=>[...p,{...c,selected:!!e.selectedTag.find(h=>h.id===c.id)}],[])});return(o,p)=>{const c=st,h=Kt,y=Gt,O=rt;return l(),R(O,{onClick:p[0]||(p[0]=w=>n("contextMenuClick",w,o.file,o.idx))},{default:_(()=>{var w;return[k(c,{key:"deleteFiles"},{default:_(()=>[I(g(o.$t("deleteSelected")),1)]),_:1}),k(c,{key:"openWithDefaultApp"},{default:_(()=>[I(g(o.$t("openWithDefaultApp")),1)]),_:1}),k(c,{key:"saveSelectedAsJson"},{default:_(()=>[I(g(o.$t("saveSelectedAsJson")),1)]),_:1}),o.file.type==="dir"?(l(),f(j,{key:0},[k(c,{key:"openInNewTab"},{default:_(()=>[I(g(o.$t("openInNewTab")),1)]),_:1}),k(c,{key:"openOnTheRight"},{default:_(()=>[I(g(o.$t("openOnTheRight")),1)]),_:1}),k(c,{key:"openWithWalkMode"},{default:_(()=>[I(g(o.$t("openWithWalkMode")),1)]),_:1})],64)):A("",!0),o.file.type==="file"?(l(),f(j,{key:1},[F(_e)(o.file.name)?(l(),f(j,{key:0},[k(c,{key:"viewGenInfo"},{default:_(()=>[I(g(o.$t("viewGenerationInfo")),1)]),_:1}),k(c,{key:"tiktokView"},{default:_(()=>[I(g(o.$t("tiktokView")),1)]),_:1}),k(h),((w=F(t).conf)==null?void 0:w.launch_mode)!=="server"?(l(),f(j,{key:0},[k(c,{key:"send2txt2img"},{default:_(()=>[I(g(o.$t("sendToTxt2img")),1)]),_:1}),k(c,{key:"send2img2img"},{default:_(()=>[I(g(o.$t("sendToImg2img")),1)]),_:1}),k(c,{key:"send2inpaint"},{default:_(()=>[I(g(o.$t("sendToInpaint")),1)]),_:1}),k(c,{key:"send2extras"},{default:_(()=>[I(g(o.$t("sendToExtraFeatures")),1)]),_:1}),k(y,{key:"sendToThirdPartyExtension",title:o.$t("sendToThirdPartyExtension")},{default:_(()=>[k(c,{key:"send2controlnet-txt2img"},{default:_(()=>[I("ControlNet - "+g(o.$t("t2i")),1)]),_:1}),k(c,{key:"send2controlnet-img2img"},{default:_(()=>[I("ControlNet - "+g(o.$t("i2i")),1)]),_:1}),k(c,{key:"send2outpaint"},{default:_(()=>[I("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):A("",!0),k(c,{key:"send2BatchDownload"},{default:_(()=>[I(g(o.$t("sendToBatchDownload")),1)]),_:1}),k(y,{key:"copy2target",title:o.$t("copyTo")},{default:_(()=>[(l(!0),f(j,null,H(F(t).quickMovePaths,D=>(l(),R(c,{key:`copy-to-${D.dir}`},{default:_(()=>[I(g(D.zh),1)]),_:2},1024))),128))]),_:1},8,["title"]),k(y,{key:"move2target",title:o.$t("moveTo")},{default:_(()=>[(l(!0),f(j,null,H(F(t).quickMovePaths,D=>(l(),R(c,{key:`move-to-${D.dir}`},{default:_(()=>[I(g(D.zh),1)]),_:2},1024))),128))]),_:1},8,["title"]),k(h),o.isSelectedMutilFiles?(l(),f(j,{key:1},[k(y,{key:"batch-add-tag",title:o.$t("batchAddTag")},{default:_(()=>[k(c,{key:"add-custom-tag"},{default:_(()=>[I("+ "+g(o.$t("addNewCustomTag")),1)]),_:1}),(l(!0),f(j,null,H(s.value,D=>(l(),R(c,{key:`batch-add-tag-${D.id}`},{default:_(()=>[I(g(D.name),1)]),_:2},1024))),128))]),_:1},8,["title"]),k(y,{key:"batch-remove-tag",title:o.$t("batchRemoveTag")},{default:_(()=>[(l(!0),f(j,null,H(s.value,D=>(l(),R(c,{key:`batch-remove-tag-${D.id}`},{default:_(()=>[I(g(D.name),1)]),_:2},1024))),128))]),_:1},8,["title"])],64)):(l(),R(y,{key:"toggle-tag",title:o.$t("toggleTag")},{default:_(()=>[k(c,{key:"add-custom-tag"},{default:_(()=>[I("+ "+g(o.$t("addNewCustomTag")),1)]),_:1}),(l(!0),f(j,null,H(s.value,D=>(l(),R(c,{key:`toggle-tag-${D.id}`},{default:_(()=>[I(g(D.name)+" ",1),D.selected?(l(),R(F(lt),{key:0})):(l(),R(F(at),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"])),k(h),k(c,{key:"openFileLocationInNewTab"},{default:_(()=>[I(g(o.$t("openFileLocationInNewTab")),1)]),_:1}),k(c,{key:"openWithLocalFileBrowser"},{default:_(()=>[I(g(o.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):A("",!0),k(h),k(c,{key:"rename"},{default:_(()=>[I(g(o.$t("rename")),1)]),_:1}),k(c,{key:"previewInNewWindow"},{default:_(()=>[I(g(o.$t("previewInNewWindow")),1)]),_:1}),k(c,{key:"download"},{default:_(()=>[I(g(o.$t("download")),1)]),_:1}),k(c,{key:"copyPreviewUrl"},{default:_(()=>[I(g(o.$t("copySourceFilePreviewLink")),1)]),_:1}),k(c,{key:"copyFilePath"},{default:_(()=>[I(g(o.$t("copyFilePath")),1)]),_:1})],64)):A("",!0)]}),_:1})}}}),z=i=>(Ce("data-v-78cd67a3"),i=i(),we(),i),vi={class:"changeIndicatorWrapper"},mi={key:0,class:"changeIndicatorsLeft changeIndicators"},yi={key:0,class:"promptChangeIndicator changeIndicator"},bi={key:1,class:"negpromptChangeIndicator changeIndicator"},Ai={key:2,class:"seedChangeIndicator changeIndicator"},ki={key:3,class:"stepsChangeIndicator changeIndicator"},Si={key:4,class:"cfgChangeIndicator changeIndicator"},_i={key:5,class:"sizeChangeIndicator changeIndicator"},Ii={key:6,class:"modelChangeIndicator changeIndicator"},Ci={key:7,class:"samplerChangeIndicator changeIndicator"},wi={key:8,class:"otherChangeIndicator changeIndicator"},Ti={class:"hoverOverlay"},Ei=z(()=>u("strong",null,"This file",-1)),Pi=z(()=>u("br",null,null,-1)),Oi=z(()=>u("br",null,null,-1)),Di={key:0},Ni=z(()=>u("td",null,[u("span",{class:"promptChangeIndicator"},"+ Prompt")],-1)),zi={key:1},$i=z(()=>u("td",null,[u("span",{class:"negpromptChangeIndicator"},"- Prompt")],-1)),Mi={key:2},Qi=z(()=>u("td",null,[u("span",{class:"seedChangeIndicator"},"Seed")],-1)),Bi={key:3},Fi=z(()=>u("td",null,[u("span",{class:"stepsChangeIndicator"},"Steps")],-1)),Ri={key:4},Li=z(()=>u("td",null,[u("span",{class:"cfgChangeIndicator"},"Cfg Scale")],-1)),Vi={key:5},ji=z(()=>u("td",null,[u("span",{class:"sizeChangeIndicator"},"Size")],-1)),xi={key:6},Hi=z(()=>u("td",null,[u("span",{class:"modelChangeIndicator"},"Model")],-1)),Ui=z(()=>u("br",null,null,-1)),Ji={key:7},Wi=z(()=>u("td",null,[u("span",{class:"samplerChangeIndicator"},"Sampler")],-1)),Ki=z(()=>u("br",null,null,-1)),Gi=z(()=>u("br",null,null,-1)),Yi={key:0},qi=z(()=>u("span",{class:"otherChangeIndicator"},"Other",-1)),Zi=z(()=>u("br",null,null,-1)),Xi=z(()=>u("br",null,null,-1)),es={key:1,class:"changeIndicatorsRight changeIndicators"},ts={key:0,class:"promptChangeIndicator changeIndicator"},ns={key:1,class:"negpromptChangeIndicator changeIndicator"},is={key:2,class:"seedChangeIndicator changeIndicator"},ss={key:3,class:"stepsChangeIndicator changeIndicator"},rs={key:4,class:"cfgChangeIndicator changeIndicator"},os={key:5,class:"sizeChangeIndicator changeIndicator"},ls={key:6,class:"modelChangeIndicator changeIndicator"},as={key:7,class:"samplerChangeIndicator changeIndicator"},us={key:8,class:"otherChangeIndicator changeIndicator"},ds={class:"hoverOverlay"},cs=z(()=>u("strong",null,"This file",-1)),fs=z(()=>u("br",null,null,-1)),hs=z(()=>u("br",null,null,-1)),gs={key:0},ps=z(()=>u("td",null,[u("span",{class:"promptChangeIndicator"},"+ Prompt")],-1)),vs={key:1},ms=z(()=>u("td",null,[u("span",{class:"negpromptChangeIndicator"},"- Prompt")],-1)),ys={key:2},bs=z(()=>u("td",null,[u("span",{class:"seedChangeIndicator"},"Seed")],-1)),As={key:3},ks=z(()=>u("td",null,[u("span",{class:"stepsChangeIndicator"},"Steps")],-1)),Ss={key:4},_s=z(()=>u("td",null,[u("span",{class:"cfgChangeIndicator"},"Cfg Scale")],-1)),Is={key:5},Cs=z(()=>u("td",null,[u("span",{class:"sizeChangeIndicator"},"Size")],-1)),ws={key:6},Ts=z(()=>u("td",null,[u("span",{class:"modelChangeIndicator"},"Model")],-1)),Es=z(()=>u("br",null,null,-1)),Ps={key:7},Os=z(()=>u("td",null,[u("span",{class:"samplerChangeIndicator"},"Sampler")],-1)),Ds=z(()=>u("br",null,null,-1)),Ns=z(()=>u("br",null,null,-1)),zs={key:0},$s=z(()=>u("span",{class:"otherChangeIndicator"},"Other",-1)),Ms=z(()=>u("br",null,null,-1)),Qs=z(()=>u("br",null,null,-1)),Bs=Z({__name:"ChangeIndicator",props:{genDiffToPrevious:{},genDiffToNext:{},genInfo:{}},setup(i){function n(t){const s=["prompt","negativePrompt","seed","steps","cfgScale","size","Model","others"],o=Object.keys(t).filter(p=>!s.includes(p));return Object.fromEntries(o.map(p=>[p,t[p]]))}function e(t){return Object.keys(n(t)).length>0}return(t,s)=>(l(),f("div",vi,[t.genDiffToPrevious.empty?A("",!0):(l(),f("div",mi,["prompt"in t.genDiffToPrevious.diff?(l(),f("div",yi,"P+")):A("",!0),"negativePrompt"in t.genDiffToPrevious.diff?(l(),f("div",bi,"P-")):A("",!0),"seed"in t.genDiffToPrevious.diff?(l(),f("div",Ai,"Se")):A("",!0),"steps"in t.genDiffToPrevious.diff?(l(),f("div",ki,"St")):A("",!0),"cfgScale"in t.genDiffToPrevious.diff?(l(),f("div",Si,"Cf")):A("",!0),"size"in t.genDiffToPrevious.diff?(l(),f("div",_i,"Si")):A("",!0),"Model"in t.genDiffToPrevious.diff?(l(),f("div",Ii,"Mo")):A("",!0),"Sampler"in t.genDiffToPrevious.diff?(l(),f("div",Ci,"Sa")):A("",!0),e(t.genDiffToPrevious.diff)?(l(),f("div",wi,"Ot")):A("",!0)])),u("div",Ti,[u("small",null,[k(F(je)),Ei,I(" vs "+g(t.genDiffToPrevious.otherFile)+" ",1),Pi,Oi,u("table",null,["prompt"in t.genDiffToPrevious.diff?(l(),f("tr",Di,[Ni,u("td",null,g(t.genDiffToPrevious.diff.prompt)+" tokens changed",1)])):A("",!0),"negativePrompt"in t.genDiffToPrevious.diff?(l(),f("tr",zi,[$i,u("td",null,g(t.genDiffToPrevious.diff.negativePrompt)+" tokens changed",1)])):A("",!0),"seed"in t.genDiffToPrevious.diff?(l(),f("tr",Mi,[Qi,u("td",null,[u("strong",null,g(t.genDiffToPrevious.diff.seed[0]),1),I(" vs "+g(t.genDiffToPrevious.diff.seed[1]),1)])])):A("",!0),"steps"in t.genDiffToPrevious.diff?(l(),f("tr",Bi,[Fi,u("td",null,[u("strong",null,g(t.genDiffToPrevious.diff.steps[0]),1),I(" vs "+g(t.genDiffToPrevious.diff.steps[1]),1)])])):A("",!0),"cfgScale"in t.genDiffToPrevious.diff?(l(),f("tr",Ri,[Li,u("td",null,[u("strong",null,g(t.genDiffToPrevious.diff.cfgScale[0]),1),I(" vs "+g(t.genDiffToPrevious.diff.cfgScale[1]),1)])])):A("",!0),"size"in t.genDiffToPrevious.diff?(l(),f("tr",Vi,[ji,u("td",null,[u("strong",null,g(t.genDiffToPrevious.diff.size[0]),1),I(" vs "+g(t.genDiffToPrevious.diff.size[1]),1)])])):A("",!0),"Model"in t.genDiffToPrevious.diff?(l(),f("tr",xi,[Hi,u("td",null,[u("strong",null,g(t.genDiffToPrevious.diff.Model[0]),1),Ui,I(" vs "+g(t.genDiffToPrevious.diff.Model[1]),1)])])):A("",!0),"Sampler"in t.genDiffToPrevious.diff?(l(),f("tr",Ji,[Wi,u("td",null,[u("strong",null,g(t.genDiffToPrevious.diff.Sampler[0]),1),Ki,I(" vs "+g(t.genDiffToPrevious.diff.Sampler[1]),1)])])):A("",!0)]),Gi,e(t.genDiffToPrevious.diff)?(l(),f("div",Yi,[qi,I(" props that changed:"),Zi,Xi,u("ul",null,[(l(!0),f(j,null,H(n(t.genDiffToPrevious.diff),(o,p)=>(l(),f("li",null,g(p),1))),256))])])):A("",!0)])]),t.genDiffToNext.empty?A("",!0):(l(),f("div",es,["prompt"in t.genDiffToNext.diff?(l(),f("div",ts,"P+")):A("",!0),"negativePrompt"in t.genDiffToNext.diff?(l(),f("div",ns,"P-")):A("",!0),"seed"in t.genDiffToNext.diff?(l(),f("div",is,"Se")):A("",!0),"steps"in t.genDiffToNext.diff?(l(),f("div",ss,"St")):A("",!0),"cfgScale"in t.genDiffToNext.diff?(l(),f("div",rs,"Cf")):A("",!0),"size"in t.genDiffToNext.diff?(l(),f("div",os,"Si")):A("",!0),"Model"in t.genDiffToNext.diff?(l(),f("div",ls,"Mo")):A("",!0),"Sampler"in t.genDiffToNext.diff?(l(),f("div",as,"Sa")):A("",!0),e(t.genDiffToNext.diff)?(l(),f("div",us,"Ot")):A("",!0)])),u("div",ds,[u("small",null,[k(F(je)),cs,I(" vs "+g(t.genDiffToNext.otherFile)+" ",1),fs,hs,u("table",null,["prompt"in t.genDiffToNext.diff?(l(),f("tr",gs,[ps,u("td",null,g(t.genDiffToNext.diff.prompt)+" tokens changed",1)])):A("",!0),"negativePrompt"in t.genDiffToNext.diff?(l(),f("tr",vs,[ms,u("td",null,g(t.genDiffToNext.diff.negativePrompt)+" tokens changed",1)])):A("",!0),"seed"in t.genDiffToNext.diff?(l(),f("tr",ys,[bs,u("td",null,[u("strong",null,g(t.genDiffToNext.diff.seed[0]),1),I(" vs "+g(t.genDiffToNext.diff.seed[1]),1)])])):A("",!0),"steps"in t.genDiffToNext.diff?(l(),f("tr",As,[ks,u("td",null,[u("strong",null,g(t.genDiffToNext.diff.steps[0]),1),I(" vs "+g(t.genDiffToNext.diff.steps[1]),1)])])):A("",!0),"cfgScale"in t.genDiffToNext.diff?(l(),f("tr",Ss,[_s,u("td",null,[u("strong",null,g(t.genDiffToNext.diff.cfgScale[0]),1),I(" vs "+g(t.genDiffToNext.diff.cfgScale[1]),1)])])):A("",!0),"size"in t.genDiffToNext.diff?(l(),f("tr",Is,[Cs,u("td",null,[u("strong",null,g(t.genDiffToNext.diff.size[0]),1),I(" vs "+g(t.genDiffToNext.diff.size[1]),1)])])):A("",!0),"Model"in t.genDiffToNext.diff?(l(),f("tr",ws,[Ts,u("td",null,[u("strong",null,g(t.genDiffToNext.diff.Model[0]),1),Es,I(" vs "+g(t.genDiffToNext.diff.Model[1]),1)])])):A("",!0),"Sampler"in t.genDiffToNext.diff?(l(),f("tr",Ps,[Os,u("td",null,[u("strong",null,g(t.genDiffToNext.diff.Sampler[0]),1),Ds,I(" vs "+g(t.genDiffToNext.diff.Sampler[1]),1)])])):A("",!0)]),Ns,e(t.genDiffToNext.diff)?(l(),f("div",zs,[$s,I(" props that changed:"),Ms,Qs,u("ul",null,[(l(!0),f(j,null,H(n(t.genDiffToNext.diff),(o,p)=>(l(),f("li",null,g(p),1))),256))])])):A("",!0)])])]))}});const Fs=ot(Bs,[["__scopeId","data-v-78cd67a3"]]),Rs=i=>(Ce("data-v-0f74bba6"),i=i(),we(),i),Ls=["data-idx"],Vs={key:1,class:"more"},js={class:"float-btn-wrap"},xs={key:1,class:"tags-container"},Hs=["url"],Us={class:"play-icon"},Js=["src"],Ws={key:0,class:"tags-container"},Ks=Rs(()=>u("div",{class:"audio-icon"},"",-1)),Gs={key:0,class:"tags-container"},Ys={key:5,class:"preview-icon-wrap"},qs={key:1,class:"dir-cover-container"},Zs=["src"],Xs={key:6,class:"profile"},er=["title"],tr={class:"basic-info"},nr={style:{"margin-right":"4px"}},ie=160,ir=Z({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1},isSelectedMutilFiles:{type:Boolean},genInfo:{},enableChangeIndicator:{type:Boolean},extraTags:{},coverFiles:{},getGenDiff:{},getGenDiffWatchDep:{}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click","tiktokView"],setup(i,{emit:n}){const e=i;Yt(r=>({"5a16e08d":r.$props.cellWidth+"px"}));const t=Ie(),s=Ze(),o=V(),p=V(),c=ge(()=>{const{getGenDiff:r,file:b,idx:C}=e;r&&(p.value=r(b.gen_info_obj,C,1,b),o.value=r(b.gen_info_obj,C,-1,b))},200+100*Math.random());oe(()=>{var r;return(r=e.getGenDiffWatchDep)==null?void 0:r.call(e,e.idx)},()=>{c()},{immediate:!0,deep:!0});const h=x(()=>s.tagMap.get(e.file.fullpath)??[]),y=x(()=>{const r=t.gridThumbnailResolution;return t.enableThumbnail?Be(e.file,[r,r].join("x")):qt(e.file)}),O=x(()=>{var r;return(((r=t.conf)==null?void 0:r.all_custom_tags)??[]).reduce((b,C)=>[...b,{...C,selected:!!h.value.find(M=>M.id===C.id)}],[])}),w=x(()=>O.value.find(r=>r.type==="custom"&&r.name==="like")),D=()=>{he(w.value),n("contextMenuClick",{key:`toggle-tag-${w.value.id}`},e.file,e.idx)},Q=r=>{t.magicSwitchTiktokView&&e.file.type==="file"&&pe(e.file.name)?(r.stopPropagation(),r.preventDefault(),n("tiktokView",e.file,e.idx),setTimeout(()=>{nn()},500)):n("fileItemClick",r,e.file,e.idx)},a=()=>{t.magicSwitchTiktokView?n("tiktokView",e.file,e.idx):sn(e.file,r=>n("contextMenuClick",{key:`toggle-tag-${r}`},e.file,e.idx),()=>n("tiktokView",e.file,e.idx))},d=()=>{t.magicSwitchTiktokView?n("tiktokView",e.file,e.idx):rn(e.file,r=>n("contextMenuClick",{key:`toggle-tag-${r}`},e.file,e.idx),()=>n("tiktokView",e.file,e.idx))};return(r,b)=>{const C=Y,M=st,v=rt,T=on,E=hn;return l(),R(C,{trigger:["contextmenu"],visible:F(t).longPressOpenContextMenu?typeof r.idx=="number"&&r.showMenuIdx===r.idx:void 0,"onUpdate:visible":b[7]||(b[7]=$=>typeof r.idx=="number"&&n("update:showMenuIdx",$?r.idx:-1))},{overlay:_(()=>[r.enableRightClickMenu?(l(),R(We,{key:0,file:r.file,idx:r.idx,"selected-tag":h.value,onContextMenuClick:b[6]||(b[6]=($,m,P)=>n("contextMenuClick",$,m,P)),"is-selected-mutil-files":r.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])):A("",!0)]),default:_(()=>{var $;return[(l(),f("li",{class:W(["file file-item-trigger grid",{clickable:r.file.type==="dir",selected:r.selected}]),"data-idx":r.idx,key:r.file.name,draggable:"true",onDragstart:b[3]||(b[3]=m=>n("dragstart",m,r.idx)),onDragend:b[4]||(b[4]=m=>n("dragend",m,r.idx)),onClickCapture:b[5]||(b[5]=m=>Q(m))},[u("div",null,[r.enableCloseIcon?(l(),f("div",{key:0,class:"close-icon",onClick:b[0]||(b[0]=m=>n("close-icon-click"))},[k(F(Zt))])):A("",!0),r.enableRightClickMenu?(l(),f("div",Vs,[k(C,null,{overlay:_(()=>[k(We,{file:r.file,idx:r.idx,"selected-tag":h.value,onContextMenuClick:b[1]||(b[1]=(m,P,S)=>n("contextMenuClick",m,P,S)),"is-selected-mutil-files":r.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])]),default:_(()=>[u("div",js,[k(F(Xt))])]),_:1}),r.file.type==="file"?(l(),R(C,{key:0},{overlay:_(()=>[O.value.length>1?(l(),R(v,{key:0,onClick:b[2]||(b[2]=m=>n("contextMenuClick",m,r.file,r.idx))},{default:_(()=>[(l(!0),f(j,null,H(O.value,m=>(l(),R(M,{key:`toggle-tag-${m.id}`},{default:_(()=>[I(g(m.name)+" ",1),m.selected?(l(),R(F(lt),{key:0})):(l(),R(F(at),{key:1}))]),_:2},1024))),128))]),_:1})):A("",!0)]),default:_(()=>{var m,P;return[u("div",{class:W(["float-btn-wrap",{"like-selected":(m=w.value)==null?void 0:m.selected}]),onClick:D},[(P=w.value)!=null&&P.selected?(l(),R(F(en),{key:0})):(l(),R(F(tn),{key:1}))],2)]}),_:1})):A("",!0)])):A("",!0),F(pe)(r.file.name)?(l(),f("div",{key:r.file.fullpath,class:W(`idx-${r.idx} item-content`)},[r.enableChangeIndicator&&p.value&&o.value?(l(),R(Fs,{key:0,"gen-diff-to-next":p.value,"gen-diff-to-previous":o.value},null,8,["gen-diff-to-next","gen-diff-to-previous"])):A("",!0),k(T,{src:y.value,fallback:F(Nn),preview:{src:r.fullScreenPreviewImageUrl,onVisibleChange:(m,P)=>n("previewVisibleChange",m,P)}},null,8,["src","fallback","preview"]),h.value&&r.cellWidth>ie?(l(),f("div",xs,[(l(!0),f(j,null,H(r.extraTags??h.value,m=>(l(),R(E,{key:m.id,color:F(s).getColor(m)},{default:_(()=>[I(g(m.name),1)]),_:2},1032,["color"]))),128))])):A("",!0)],2)):F(et)(r.file.name)?(l(),f("div",{key:3,class:W(`idx-${r.idx} item-content video`),url:F(ce)(r.file),style:it({"background-image":`url('${r.file.cover_url??F(ce)(r.file)}')`}),onClick:a},[u("div",Us,[u("img",{src:F(Ln),style:{width:"40px",height:"40px"}},null,8,Js)]),h.value&&r.cellWidth>ie?(l(),f("div",Ws,[(l(!0),f(j,null,H(h.value,m=>(l(),R(E,{key:m.id,color:F(s).getColor(m)},{default:_(()=>[I(g(m.name),1)]),_:2},1032,["color"]))),128))])):A("",!0)],14,Hs)):F(tt)(r.file.name)?(l(),f("div",{key:4,class:W(`idx-${r.idx} item-content audio`),onClick:d},[Ks,h.value&&r.cellWidth>ie?(l(),f("div",Gs,[(l(!0),f(j,null,H(h.value,m=>(l(),R(E,{key:m.id,color:F(s).getColor(m)},{default:_(()=>[I(g(m.name),1)]),_:2},1032,["color"]))),128))])):A("",!0)],2)):(l(),f("div",Ys,[r.file.type==="file"?(l(),R(F(An),{key:0,class:"icon center"})):($=r.coverFiles)!=null&&$.length&&r.cellWidth>160?(l(),f("div",qs,[(l(!0),f(j,null,H(r.coverFiles,m=>(l(),f("img",{class:"dir-cover-item",src:m.media_type==="image"?F(Be)(m):F(ce)(m),key:m.fullpath},null,8,Zs))),128))])):(l(),R(F(In),{key:2,class:"icon center"}))])),r.cellWidth>ie?(l(),f("div",Xs,[u("div",{class:"name line-clamp-1",title:r.file.name},g(r.file.name),9,er),u("div",tr,[u("div",nr,g(r.file.type)+" "+g(r.file.size),1),u("div",null,g(r.file.date),1)])])):A("",!0)])],42,Ls))]}),_:1},8,["visible"])}}});const Ar=ot(ir,[["__scopeId","data-v-0f74bba6"]]);export{Ar as F,dr as N,We as _,cr as a,br as b,yr as c,gt as d,mr as e,Vn as f,G as g,gr as h,vr as i,hr as j,pr as k,Dn as r,fr as s,xn as t,ae as u};
