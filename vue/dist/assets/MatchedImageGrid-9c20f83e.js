import{d as pe,an as ue,bH as fe,m as ge,aA as me,a1 as he,U as m,V as I,c as s,a5 as e,a4 as o,a7 as U,W as d,L as ke,Y as c,X as v,a3 as E,ag as ve,ah as J,$ as N,aj as we,T as _e,al as Ce,aQ as Se,aR as Ie,a0 as xe}from"./index-214c37f1.js";import{S as be}from"./index-a8e9eaff.js";import{o as P,L as ye,R as Me,f as Ae,M as Ve}from"./MultiSelectKeep-7de19d67.js";import{c as Fe,d as De,F as ze}from"./FileItem-ce402db7.js";import{u as Te}from"./hook-2f409e5f.js";import"./shortcut-c70bb424.js";import"./Checkbox-f143d30a.js";/* empty css              */import"./index-3237a2fe.js";import"./index-fbb9b9b7.js";import"./index-e9d0b4c7.js";import"./numInput.vue_vue_type_style_index_0_scoped_bd954eda_lang-3d61c006.js";import"./_isIterateeCall-00caa5e4.js";import"./index-6edd4c1a.js";import"./useGenInfoDiff-ad344c7f.js";const x=r=>(Se("data-v-795e5ef4"),r=r(),Ie(),r),$e={class:"hint"},Ge={class:"action-bar"},Re={class:"title line-clamp-1"},Be=x(()=>d("div",{"flex-placeholder":""},null,-1)),Le=x(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Ue={key:1,class:"no-res-hint"},Ee=x(()=>d("p",{class:"hint"},"æš‚æ— ç»“æžœ",-1)),Je=[Ee],Ne={key:2,class:"preview-switch"},Pe=pe({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},id:{},title:{},paths:{}},setup(r){const h=r,t=ue({res:[],load:!1,loading:!1,async next(){var n;if(!(t.loading||t.load)){t.loading=!0;try{const u=t.res.length,f=(h.paths??[]).slice(u,u+200);if(!f.length){t.load=!0;return}const C=await fe(f),g=f.map(S=>C[S]).filter(Boolean);t.res.push(...g),u+200>=(((n=h.paths)==null?void 0:n.length)??0)&&(t.load=!0)}finally{t.loading=!1}}},async reset(){t.res=[],t.load=!1,await t.next()}}),{queue:W,images:l,onContextMenuClickU:b,stackViewEl:K,previewIdx:p,previewing:y,onPreviewVisibleChange:O,previewImgMove:M,canPreview:A,itemSize:V,gridItems:q,showGenInfo:k,imageGenInfo:F,q:Q,multiSelectedIdxs:w,onFileItemClick:j,scroller:D,showMenuIdx:_,onFileDragStart:H,onFileDragEnd:X,cellWidth:Y,onScroll:z,saveAllFileAsJson:Z,saveLoadedFileAsJson:ee,changeIndchecked:te,seedChangeChecked:le,getGenDiff:ie,getGenDiffWatchDep:ne}=Te(t);ge(()=>h.paths,async()=>{var n;await t.reset({refetch:!0}),await me(),(n=D.value)==null||n.scrollToItem(0),z()},{immediate:!0});const se=he(),{onClearAllSelected:oe,onSelectAll:ae,onReverseSelect:de}=Fe(),ce=()=>{l.value.length!==0&&P(l.value,0)};return(n,i)=>{const u=Ve,f=we,C=_e,g=Ce,S=be;return m(),I("div",{class:"container",ref_key:"stackViewEl",ref:K},[s(u,{show:!!e(w).length||e(se).keepMultiSelect,onClearAllSelected:e(oe),onSelectAll:e(ae),onReverseSelect:e(de)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),s(S,{size:"large",spinning:!e(W).isIdle||t.loading},{default:o(()=>{var T,$,G,R;return[s(C,{visible:e(k),"onUpdate:visible":i[1]||(i[1]=a=>U(k)?k.value=a:null),width:"70vw","mask-closable":"",onOk:i[2]||(i[2]=a=>k.value=!1)},{cancelText:o(()=>[]),default:o(()=>[s(f,{active:"",loading:!e(Q).isIdle},{default:o(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:i[0]||(i[0]=a=>e(ke)(e(F)))},[d("div",$e,c(n.$t("doubleClickToCopy")),1),v(" "+c(e(F)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Ge,[d("div",Re,"ðŸ§© "+c(h.title),1),Be,s(g,{onClick:ce,disabled:!((T=e(l))!=null&&T.length)},{default:o(()=>[v(c(n.$t("tiktokView")),1)]),_:1},8,["disabled"]),s(g,{onClick:e(ee),disabled:!(($=e(l))!=null&&$.length)},{default:o(()=>[v(c(n.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick","disabled"]),s(g,{onClick:e(Z),disabled:!((G=e(l))!=null&&G.length)},{default:o(()=>[v(c(n.$t("saveAllAsJson")),1)]),_:1},8,["onClick","disabled"])]),(R=e(l))!=null&&R.length?(m(),E(e(De),{key:0,ref_key:"scroller",ref:D,class:"file-list",items:e(l),"item-size":e(V).first,"key-field":"fullpath","item-secondary-size":e(V).second,gridItems:e(q),onScroll:e(z)},{after:o(()=>[Le]),default:o(({item:a,index:B})=>[s(ze,{idx:B,file:a,"cell-width":e(Y),"show-menu-idx":e(_),"onUpdate:showMenuIdx":i[3]||(i[3]=L=>U(_)?_.value=L:null),onDragstart:e(H),onDragend:e(X),onFileItemClick:e(j),onTiktokView:(L,re)=>e(P)(e(l),re),"full-screen-preview-image-url":e(l)[e(p)]?e(ve)(e(l)[e(p)]):"",selected:e(w).includes(B),onContextMenuClick:e(b),onPreviewVisibleChange:e(O),"is-selected-mutil-files":e(w).length>1,"enable-change-indicator":e(te),"seed-change-checked":e(le),"get-gen-diff":e(ie),"get-gen-diff-watch-dep":e(ne)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):(m(),I("div",Ue,Je)),e(y)?(m(),I("div",Ne,[s(e(ye),{onClick:i[4]||(i[4]=a=>e(M)("prev")),class:J({disable:!e(A)("prev")})},null,8,["class"]),s(e(Me),{onClick:i[5]||(i[5]=a=>e(M)("next")),class:J({disable:!e(A)("next")})},null,8,["class"])])):N("",!0)]}),_:1},8,["spinning"]),e(y)&&e(l)&&e(l)[e(p)]?(m(),E(Ae,{key:0,file:e(l)[e(p)],idx:e(p),onContextMenuClick:e(b)},null,8,["file","idx","onContextMenuClick"])):N("",!0)],512)}}});const st=xe(Pe,[["__scopeId","data-v-795e5ef4"]]);export{st as default};
